

<!DOCTYPE html>
<html>
  <head>
    <title>
	Pandas :: Data Warehouse
</title>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="revised" content="2020-09-26T02:54:27 &#43;07">
<meta name="description" content="">



<title>Pandas :: Data Warehouse</title>

<link rel="shortcut icon" href='/KM/tutorials/images/favicon.png' type="image/x-icon" />


<link rel="preload" as="style" href='/KM/tutorials/fonts/Montserrat/Montserrat.css'>
<link rel="stylesheet" href='https://knowledge-dragons.github.io/KM/tutorials/sass/layout.css'>
<link rel="stylesheet" href='https://knowledge-dragons.github.io/KM/tutorials/css/style.main.css'>
<link rel="stylesheet" href='https://knowledge-dragons.github.io/KM/tutorials/css/style.menu.css'>
<link href='/KM/tutorials/vendor/FontAwesome/fontawesome-free-5.14.0-web/css/all.min.css' rel="stylesheet"> 

<link href='/KM/tutorials/vendor/bootstrap/bootstrap-4.5.2-dist/css/bootstrap.min.css' rel="stylesheet"> 



<link rel="stylesheet" type="text/css" href='https://knowledge-dragons.github.io/KM/tutorials/sass/shortcodes/notice.css'>
<link rel="stylesheet" type="text/css" href='https://knowledge-dragons.github.io/KM/tutorials/sass/shortcodes/tabs.css'>
<link rel="stylesheet" type="text/css" href='https://knowledge-dragons.github.io/KM/tutorials/sass/shortcodes/panel.css'>
<link rel="stylesheet" type="text/css" href='https://knowledge-dragons.github.io/KM/tutorials/sass/shortcodes/columns.css'>
<link rel="stylesheet" type="text/css" href='https://knowledge-dragons.github.io/KM/tutorials/sass/shortcodes/children.css'>
<link rel="stylesheet" type="text/css" href='https://knowledge-dragons.github.io/KM/tutorials/sass/shortcodes/attachments.css'>
<link rel="stylesheet" type="text/css" href='https://knowledge-dragons.github.io/KM/tutorials/sass/shortcodes/alert.css'>


<link rel="stylesheet" href='/KM/tutorials/css/docport.css'>



<script src='/KM/tutorials/vendor/jquery/jquery-3.5.1.min.js'></script>
<script src='/KM/tutorials/vendor/bootstrap/bootstrap-4.5.2-dist/js/bootstrap.min.js' crossorigin="anonymous"></script>

<script src='/KM/tutorials/js/docport.js'></script>
<script type="text/javascript">
      var baseurl = "https:\/\/knowledge-dragons.github.io\/KM\/tutorials\/";
</script>





    
  </head>

  <body data-url="/KM/tutorials/pandas/"

  class="">

<style type="text/css">
  #debug{
    display: -webkit-box;
    display: -ms-flexbox;
    display: flex;
    line-height: 3.5rem;
    margin-bottom: .35rem;
    padding: 0 2rem;
    position: fixed;
    left: 0;      right: 0;     top: 0;
   
    top:0px;
    
    min-height: 150px;

    background-color: white;
    border: 3px solid red;
    z-index: 10000 ;
    word-wrap: all;
    overflow: auto;
  }
</style>
 


    
    
    <header style="">
        <div>
    
    <div class="burger ">
        <a href="javascript:void(0);" style="font-size:15px;" onclick="$('article > aside').toggleClass('responsive')">&#9776;</a>
    </div>
    

    <div>

		
	
			
		
	    	<a class='baselink' href='https://knowledge-dragons.github.io/KM/tutorials/'>Data Warehouse</a>
	  	
	</div>
    <nav class="shortcuts">
            <li class="" role="">
                <a href="https://github.com/vjeantet/hugo-theme-docport"  rel="noopener">
                  Github
                </a>
            </li>
            <li class="" role="">
                <a href="https://github.com/vjeantet/hugo-theme-docport/archive/master.zip"  rel="noopener">
                  Download
                </a>
            </li>
            <li class="" role="">
                <a href="https://gohugo.io/"  rel="noopener">
                  Hugo Documentation
                </a>
            </li>
            <li class="" role="">
                <a href="/KM/tutorials/docport-theme/credits/"  rel="noopener">
                  Credits
                </a>
            </li>
    </nav>

</div>
    </header>
    

    <article>
      
      <aside class="">
        
<div class="search">
	<div class="searchbox">
	  <input data-search-input id="search-by" type="text" placeholder="Type to search...">
	</div>
	<script type="text/javascript" src="/KM/tutorials/vendor/lunr/lunr.min.js"></script>
	<script type="text/javascript" src="/KM/tutorials/vendor/auto-complete/auto-complete.js"></script>
	<link href="/KM/tutorials/vendor/auto-complete/auto-complete.css" rel="stylesheet">
	<script type="text/javascript">
	  
	      var baseurl = "https:\/\/knowledge-dragons.github.io\/KM\/tutorials\/";
	  
	</script>
	<script type="text/javascript" src="/KM/tutorials/js/search.js"></script>
</div>

		
	
			
		
	    	
	    
	<div id="close_menu">
  <a href="javascript:void(0);" style="font-size:15px;" onclick="$('article > aside').toggleClass('responsive')">
      <i class="fa fa-lg fa-times"></i>
  </a>
</div>

<ul class="menu">

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/" class="dd-item haschildren
        item_level_$level
        ">

      
      
      
      <i class="fas fa-chevron-right ddexp"></i>
        
      
          <a href="/KM/tutorials/python/">Python</a>
      
        <ul>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/learn_python/" class="dd-item haschildren
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/learn_python/">Learn Python</a>
      <i class="fas fa-chevron-right ddexp"></i>
        
      
        <ul>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/learn_python/function/" class="dd-item haschildren
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/learn_python/function/">Function</a>
      <i class="fas fa-chevron-right ddexp"></i>
        
      
        <ul>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/learn_python/function/function_arguments/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/learn_python/function/function_arguments/">Function Arguments</a>
      
        
      
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/learn_python/function/lambda_functions/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/learn_python/function/lambda_functions/">Anonymous/Lambda Function</a>
      
        
      
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/learn_python/function/global_variables/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/learn_python/function/global_variables/">Global, Local and variables</a>
      
        
      
    </li>
        </ul>
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/learn_python/data_type/" class="dd-item haschildren
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/learn_python/data_type/">Data Type</a>
      <i class="fas fa-chevron-right ddexp"></i>
        
      
        <ul>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/learn_python/data_type/list/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/learn_python/data_type/list/">Python: List</a>
      
        
      
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/learn_python/data_type/tuble/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/learn_python/data_type/tuble/">Python: Tuble</a>
      
        
      
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/learn_python/data_type/string/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/learn_python/data_type/string/">Python: String</a>
      
        
      
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/learn_python/data_type/set/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/learn_python/data_type/set/">Python: Set</a>
      
        
      
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/learn_python/data_type/dictionary/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/learn_python/data_type/dictionary/">Python: Dictionary</a>
      
        
      
    </li>
        </ul>
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/learn_python/files/" class="dd-item haschildren
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/learn_python/files/">Files</a>
      <i class="fas fa-chevron-right ddexp"></i>
        
      
        <ul>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/learn_python/files/intro/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/learn_python/files/intro/">Page Index</a>
      
        
      
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/learn_python/files/file_operations/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/learn_python/files/file_operations/">Python File I/O</a>
      
        
      
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/learn_python/files/directory/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/learn_python/files/directory/">Python: Directory</a>
      
        
      
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/learn_python/files/exceptions/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/learn_python/files/exceptions/">Python Exceptions</a>
      
        
      
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/learn_python/files/exception-handling/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/learn_python/files/exception-handling/">Exception Handling</a>
      
        
      
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/learn_python/files/user-defined-exception/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/learn_python/files/user-defined-exception/">Custom Exceptions</a>
      
        
      
    </li>
        </ul>
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/learn_python/objects_class/" class="dd-item haschildren
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/learn_python/objects_class/">Object &amp; Class</a>
      <i class="fas fa-chevron-right ddexp"></i>
        
      
        <ul>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/learn_python/objects_class/oop/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/learn_python/objects_class/oop/">Object Oriented Programming (OOP)</a>
      
        
      
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/learn_python/objects_class/class/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/learn_python/objects_class/class/">Objects and Classes</a>
      
        
      
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/learn_python/objects_class/inheritance/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/learn_python/objects_class/inheritance/">Python Inheritance</a>
      
        
      
    </li>
        </ul>
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/learn_python/advance_topic/" class="dd-item haschildren
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/learn_python/advance_topic/">Advance Topics</a>
      <i class="fas fa-chevron-right ddexp"></i>
        
      
        <ul>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/learn_python/advance_topic/iterators/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/learn_python/advance_topic/iterators/">Iterators</a>
      
        
      
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/learn_python/advance_topic/generators/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/learn_python/advance_topic/generators/">Generators</a>
      
        
      
    </li>
        </ul>
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/learn_python/datetime/" class="dd-item haschildren
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/learn_python/datetime/">Date and Time</a>
      <i class="fas fa-chevron-right ddexp"></i>
        
      
        <ul>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/learn_python/datetime/datetime_module/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/learn_python/datetime/datetime_module/">datetime() Module</a>
      
        
      
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/learn_python/datetime/strftime/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/learn_python/datetime/strftime/">strftime()</a>
      
        
      
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/learn_python/datetime/strptime/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/learn_python/datetime/strptime/">strptime()</a>
      
        
      
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/learn_python/datetime/current-datetime/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/learn_python/datetime/current-datetime/">Get Current Date and Time</a>
      
        
      
    </li>
        </ul>
    </li>
        </ul>
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/phyblas/" class="dd-item haschildren
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/phyblas/">phyblas</a>
      <i class="fas fa-chevron-right ddexp"></i>
        
      
        <ul>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/phyblas/beginer/" class="dd-item haschildren
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/phyblas/beginer/">ผู้เริ่มต้น (Beginer)</a>
      <i class="fas fa-chevron-right ddexp"></i>
        
      
        <ul>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/phyblas/beginer/basic_functin/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/phyblas/beginer/basic_functin/">ฟังก์ชันพื้นฐาน</a>
      
        
      
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/phyblas/beginer/string_output/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/phyblas/beginer/string_output/">การแสดงผลตัวอักษร</a>
      
        
      
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/phyblas/beginer/string_format/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/phyblas/beginer/string_format/">การจัดการกับสายอักขระ</a>
      
        
      
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/phyblas/beginer/list/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/phyblas/beginer/list/">การจัดการกับลิสต์ (List)</a>
      
        
      
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/phyblas/beginer/dictionary/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/phyblas/beginer/dictionary/">ดิกชันนารี (Dictionary)</a>
      
        
      
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/phyblas/beginer/module/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/phyblas/beginer/module/">การเรียกใช้มอดูล (Module)</a>
      
        
      
    </li>
        </ul>
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/phyblas/intermediate/" class="dd-item haschildren
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/phyblas/intermediate/">ระดับกลาง(Intermediate)</a>
      <i class="fas fa-chevron-right ddexp"></i>
        
      
        <ul>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/phyblas/intermediate/read_files/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/phyblas/intermediate/read_files/">การอ่านข้อมูลจากไฟล์</a>
      
        
      
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/phyblas/intermediate/write_files/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/phyblas/intermediate/write_files/">การเขียนข้อมูลลงไฟล์</a>
      
        
      
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/phyblas/intermediate/create_function/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/phyblas/intermediate/create_function/">การสร้างฟังก์ชัน</a>
      
        
      
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/phyblas/intermediate/recursive_function/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/phyblas/intermediate/recursive_function/">ฟังก์ชันเวียนเกิด</a>
      
        
      
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/phyblas/intermediate/lambda/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/phyblas/intermediate/lambda/">คำสั่งพิเศษที่เกี่ยวข้องกับฟังก์ชัน</a>
      
        
      
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/phyblas/intermediate/inheritance/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/phyblas/intermediate/inheritance/">การรับทอด</a>
      
        
      
    </li>
        </ul>
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/phyblas/advance/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/phyblas/advance/">ระดับสูง(Advance)</a>
      
        
      
    </li>
        </ul>
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/resources/" class="dd-item haschildren
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/resources/">Resources</a>
      <i class="fas fa-chevron-right ddexp"></i>
        
      
        <ul>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/resources/quick_reference_cards/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/resources/quick_reference_cards/">Quick Reference Card</a>
      
        
      
    </li>
        </ul>
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/pythonstandardlibrary/" class="dd-item haschildren
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/pythonstandardlibrary/">Standard Library</a>
      <i class="fas fa-chevron-right ddexp"></i>
        
      
        <ul>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/pythonstandardlibrary/text/" class="dd-item haschildren
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/pythonstandardlibrary/text/">Text</a>
      <i class="fas fa-chevron-right ddexp"></i>
        
      
        <ul>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/pythonstandardlibrary/text/string/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/pythonstandardlibrary/text/string/">String</a>
      
        
      
    </li>
        </ul>
    </li>
        </ul>
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/tutorials/" class="dd-item haschildren
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/tutorials/">Tutorials</a>
      <i class="fas fa-chevron-right ddexp"></i>
        
      
        <ul>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/tutorials/basic_syntax/" class="dd-item alwaysopen
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/tutorials/basic_syntax/">Basic Syntax</a>
      
        
      
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/tutorials/date-time/" class="dd-item haschildren
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/tutorials/date-time/">Date &amp; Time</a>
      <i class="fas fa-chevron-right ddexp"></i>
        
      
        <ul>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/tutorials/date-time/pendulum/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/tutorials/date-time/pendulum/">pendulum</a>
      
        
      
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/tutorials/date-time/overview/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/tutorials/date-time/overview/">การจัดการวันเวลา</a>
      
        
      
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/tutorials/date-time/center/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/tutorials/date-time/center/">Date &amp; Time tutorial</a>
      
        
      
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/tutorials/date-time/time-delta-striftime/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/tutorials/date-time/time-delta-striftime/">TimeDelta, Strftime(Format)</a>
      
        
      
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/tutorials/date-time/time-module/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/tutorials/date-time/time-module/">Time Module</a>
      
        
      
    </li>
        </ul>
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/tutorials/list/" class="dd-item alwaysopen
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/tutorials/list/">List</a>
      
        
      
    </li>
              
<hr/>
    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/tutorials/dictionary/" class="dd-item alwaysopen haschildren
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/tutorials/dictionary/">Dictionary&nbsp;👋</a>
      
          <i class="fas fa-chevron-down ddexp"></i>
        
      
        <ul>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/tutorials/dictionary/dict_beginner/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/tutorials/dictionary/dict_beginner/">Beginners Tutorial</a>
      
        
      
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/tutorials/dictionary/merge-two-dictionaries/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/tutorials/dictionary/merge-two-dictionaries/">Merge two Dictionaries</a>
      
        
      
    </li>
        </ul>
    </li>
        </ul>
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/python/beginner/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/python/beginner/">Python for beginners</a>
      
        
      
    </li>
        </ul>
    </li>
    

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/pandas/" class="dd-item parent active haschildren
        item_level_$level
        ">

      
      
      
      
          <i class="fas fa-chevron-down ddexp"></i>
        
      
          <a href="/KM/tutorials/pandas/">Pandas</a>
      
        <ul>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/pandas/cookbook/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/pandas/cookbook/">Pandas Cookbook</a>
      
        
      
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/pandas/short_introduction/" class="dd-item haschildren
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/pandas/short_introduction/">Short Introduction</a>
      <i class="fas fa-chevron-right ddexp"></i>
        
      
        <ul>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/pandas/short_introduction/10-minutes/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/pandas/short_introduction/10-minutes/">10 minutes to pandas</a>
      
        
      
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/pandas/short_introduction/essential_snippets/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/pandas/short_introduction/essential_snippets/">19 Essential Snippets in Pandas</a>
      
        
      
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/pandas/short_introduction/basic-to-beyond/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/pandas/short_introduction/basic-to-beyond/">Basics to Beyond</a>
      
        
      
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/pandas/short_introduction/cheatsheet-pandas/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/pandas/short_introduction/cheatsheet-pandas/">Cheatsheet Pandas</a>
      
        
      
    </li>
        </ul>
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/pandas/tutorial-geeksforgeeks/" class="dd-item haschildren
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/pandas/tutorial-geeksforgeeks/">Tutorial (GeeksforGeeks)</a>
      <i class="fas fa-chevron-right ddexp"></i>
        
      
        <ul>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/pandas/tutorial-geeksforgeeks/selection/" class="dd-item haschildren
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/pandas/tutorial-geeksforgeeks/selection/">Selection</a>
      <i class="fas fa-chevron-right ddexp"></i>
        
      
        <ul>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/pandas/tutorial-geeksforgeeks/selection/dealing-with-rows-and-columns/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/pandas/tutorial-geeksforgeeks/selection/dealing-with-rows-and-columns/">Dealing with Rows and Columns</a>
      
        
      
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/pandas/tutorial-geeksforgeeks/selection/extracting-rows-using-loc/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/pandas/tutorial-geeksforgeeks/selection/extracting-rows-using-loc/">Extracting rows using .loc[]</a>
      
        
      
    </li>
              

    <li data-nav-id="https://knowledge-dragons.github.io/KM/tutorials/pandas/tutorial-geeksforgeeks/selection/extracting-rows-using-pandas-iloc/" class="dd-item
        item_level_$level
        ">

      
      
      
      
          <a href="/KM/tutorials/pandas/tutorial-geeksforgeeks/selection/extracting-rows-using-pandas-iloc/">Extracting rows using .iloc[]</a>
      
        
      
    </li>
        </ul>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    



</ul>

		
	
			
		
	    	<center>
<!-- Place this tag where you want the button to render. -->
<a class="github-button" href="https://github.com/vjeantet/hugo-theme-docport/archive/master.zip" data-icon="octicon-cloud-download" aria-label="Download vjeantet/hugo-theme-docport on GitHub">Download</a>
<!-- Place this tag where you want the button to render. -->
<a class="github-button" href="https://github.com/vjeantet/hugo-theme-docport" data-icon="octicon-star" data-show-count="false" aria-label="Star vjeantet/hugo-theme-docport on GitHub">Star</a>
<!-- Place this tag where you want the button to render. -->
<a class="github-button" href="https://github.com/vjeantet/hugo-theme-docport/fork" data-icon="octicon-repo-forked" data-show-count="true" aria-label="Fork vjeantet/hugo-theme-docport on GitHub">Fork</a>
</center>
<!-- Place this tag in your head or just before your close body tag. -->
<script async defer src="https://buttons.github.io/buttons.js"></script>
	    
	
      </aside>
      

      <section class="page ">
      
	
	 
	    
    
    
    <nav id="ariane" aria-label="breadcrumb">
      <ol class="ariane">
        
  
  	
		
  
  	
	<li >
      <a class="text-link" href="https://knowledge-dragons.github.io/KM/tutorials/">
        Home
      </a>
    </li>
	
  
    <li class="">
      <a class="text-link" href="/KM/tutorials/pandas/">
        Pandas
      </a>
    </li>
	
  	
  
    <li class="active">
      
        Pandas Cookbook
      
    </li>

      </ol>
    </nav>
    
    

    
		
        
		
		
		
		
		
		
		

		
			<h1>Pandas Cookbook</h1>
        

		
										
		

		
	

	
	
	<div class="jump-to-section">
		<span onclick="$h = $(this);$h.next('nav').slideToggle(100,function () {$h.children('i').attr('class',function () {return $h.next('nav').is(':visible') ? 'fas fa-chevron-down' : 'fas fa-chevron-right';});});">
  			<span class="fas fa-align-right"></span>
  			Jump to Section
  			<i style=";" class="fas fa-chevron-right"></i>
		</span>
		<nav id="TableOfContents">
  <ul>
    <li><a href="#idiomshttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlidioms-permalink-to-this-headline">Idioms<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#idioms" title="Permalink to this headline"></a></a>
      <ul>
        <li><a href="#if-thenhttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlif-then-permalink-to-this-headline">if-then…<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#if-then" title="Permalink to this headline"></a></a></li>
        <li><a href="#splittinghttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlsplitting-permalink-to-this-headline">Splitting<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#splitting" title="Permalink to this headline"></a></a></li>
        <li><a href="#building-criteriahttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlbuilding-criteria-permalink-to-this-headline">Building criteria<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#building-criteria" title="Permalink to this headline"></a></a></li>
      </ul>
    </li>
    <li><a href="#selectionhttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlselection-permalink-to-this-headline">Selection<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#selection" title="Permalink to this headline"></a></a>
      <ul>
        <li><a href="#dataframeshttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmldataframes-permalink-to-this-headline">Dataframes<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#dataframes" title="Permalink to this headline"></a></a></li>
        <li><a href="#new-columnshttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlnew-columns-permalink-to-this-headline">New columns<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#new-columns" title="Permalink to this headline"></a></a></li>
      </ul>
    </li>
    <li><a href="#multiindexinghttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlmultiindexing-permalink-to-this-headline">Multiindexing<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#multiindexing" title="Permalink to this headline"></a></a>
      <ul>
        <li><a href="#arithmetichttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlarithmetic-permalink-to-this-headline">Arithmetic<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#arithmetic" title="Permalink to this headline"></a></a></li>
        <li><a href="#slicinghttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlslicing-permalink-to-this-headline">Slicing<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#slicing" title="Permalink to this headline"></a></a></li>
        <li><a href="#sortinghttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlsorting-permalink-to-this-headline">Sorting<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#sorting" title="Permalink to this headline"></a></a></li>
        <li><a href="#levelshttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmllevels-permalink-to-this-headline">Levels<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#levels" title="Permalink to this headline"></a></a></li>
      </ul>
    </li>
    <li><a href="#missing-datahttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlmissing-data-permalink-to-this-headline">Missing data<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#missing-data" title="Permalink to this headline"></a></a>
      <ul>
        <li><a href="#replacehttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlreplace-permalink-to-this-headline">Replace<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#replace" title="Permalink to this headline"></a></a></li>
      </ul>
    </li>
    <li><a href="#groupinghttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlgrouping-permalink-to-this-headline">Grouping<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#grouping" title="Permalink to this headline"></a></a>
      <ul>
        <li><a href="#expanding-datahttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlexpanding-data-permalink-to-this-headline">Expanding data<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#expanding-data" title="Permalink to this headline"></a></a></li>
        <li><a href="#splittinghttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlid2-permalink-to-this-headline">Splitting<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#id2" title="Permalink to this headline"></a></a></li>
        <li><a href="#pivothttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlpivot-permalink-to-this-headline">Pivot<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#pivot" title="Permalink to this headline"></a></a></li>
        <li><a href="#applyhttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlapply-permalink-to-this-headline">Apply<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#apply" title="Permalink to this headline"></a></a></li>
      </ul>
    </li>
    <li><a href="#timeserieshttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmltimeseries-permalink-to-this-headline">Timeseries<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#timeseries" title="Permalink to this headline"></a></a>
      <ul>
        <li><a href="#resamplinghttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlresampling-permalink-to-this-headline">Resampling<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#resampling" title="Permalink to this headline"></a></a></li>
      </ul>
    </li>
    <li><a href="#mergehttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlmerge-permalink-to-this-headline">Merge<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#merge" title="Permalink to this headline"></a></a></li>
    <li><a href="#plottinghttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlplotting-permalink-to-this-headline">Plotting<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#plotting" title="Permalink to this headline"></a></a></li>
    <li><a href="#data-inouthttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmldata-in-out-permalink-to-this-headline">Data in/out<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#data-in-out" title="Permalink to this headline"></a></a>
      <ul>
        <li><a href="#csvhttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlcsv-permalink-to-this-headline">CSV<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#csv" title="Permalink to this headline"></a></a></li>
        <li><a href="#sqlhttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlsql-permalink-to-this-headline">SQL<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#sql" title="Permalink to this headline"></a></a></li>
        <li><a href="#excelhttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlexcel-permalink-to-this-headline">Excel<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#excel" title="Permalink to this headline"></a></a></li>
        <li><a href="#htmlhttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlhtml-permalink-to-this-headline">HTML<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#html" title="Permalink to this headline"></a></a></li>
        <li><a href="#hdfstorehttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlhdfstore-permalink-to-this-headline">HDFStore<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#hdfstore" title="Permalink to this headline"></a></a></li>
        <li><a href="#binary-fileshttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlbinary-files-permalink-to-this-headline">Binary files<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#binary-files" title="Permalink to this headline"></a></a></li>
      </ul>
    </li>
    <li><a href="#computationhttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlcomputation-permalink-to-this-headline">Computation<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#computation" title="Permalink to this headline"></a></a>
      <ul>
        <li><a href="#correlationhttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlcorrelation-permalink-to-this-headline">Correlation<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#correlation" title="Permalink to this headline"></a></a></li>
      </ul>
    </li>
    <li><a href="#timedeltashttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmltimedeltas-permalink-to-this-headline">Timedeltas<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#timedeltas" title="Permalink to this headline"></a></a></li>
    <li><a href="#creating-example-datahttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlcreating-example-data-permalink-to-this-headline">Creating example data<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#creating-example-data" title="Permalink to this headline"></a></a></li>
  </ul>
</nav>
	</div>
	
	






	<div class="content">
	    <blockquote>
<p>Reference : <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#data-in-out">https://pandas.pydata.org</a></p>
</blockquote>
<p><img src="https://www.anaconda.com/wp-content/uploads/2019/11/pandas-logo-2.png" alt="enter image description here"></p>
<p>This is a repository for  <em>short and sweet</em>  examples and links for useful pandas recipes. We encourage users to add to this documentation.</p>
<p>Adding interesting links and/or inline examples to this section is a great  <em>First Pull Request</em>.</p>
<p>Simplified, condensed, new-user friendly, in-line examples have been inserted where possible to augment the Stack-Overflow and GitHub links. Many of the links contain expanded information, above what the in-line examples offer.</p>
<p>Pandas (pd) and Numpy (np) are the only two abbreviated imported modules. The rest are kept explicitly imported for newer users.</p>
<p>These examples are written for Python 3. Minor tweaks might be necessary for earlier python versions.</p>
<h2 ref="idiomshttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlidioms-permalink-to-this-headline" >Idioms<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#idioms" title="Permalink to this headline"></a></h2><a class="anchor" id="idiomshttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlidioms-permalink-to-this-headline"></a>
<p>These are some neat pandas  <code>idioms</code></p>
<p><a href="https://stackoverflow.com/questions/17128302/python-pandas-idiom-for-if-then-else">if-then/if-then-else on one column, and assignment to another one or more columns:</a></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">1</span>]: df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame({<span style="color:#d14">&#39;AAA&#39;</span>: [<span style="color:#099">4</span>, <span style="color:#099">5</span>, <span style="color:#099">6</span>, <span style="color:#099">7</span>],
 <span style="color:#000;font-weight:bold">...</span>:                   <span style="color:#d14">&#39;BBB&#39;</span>: [<span style="color:#099">10</span>, <span style="color:#099">20</span>, <span style="color:#099">30</span>, <span style="color:#099">40</span>],
 <span style="color:#000;font-weight:bold">...</span>:                   <span style="color:#d14">&#39;CCC&#39;</span>: [<span style="color:#099">100</span>, <span style="color:#099">50</span>, <span style="color:#000;font-weight:bold">-</span><span style="color:#099">30</span>, <span style="color:#000;font-weight:bold">-</span><span style="color:#099">50</span>]})
 <span style="color:#000;font-weight:bold">...</span>: 

In [<span style="color:#099">2</span>]: df
Out[<span style="color:#099">2</span>]: 
 AAA  BBB  CCC
<span style="color:#099">0</span>    <span style="color:#099">4</span>   <span style="color:#099">10</span>  <span style="color:#099">100</span>
<span style="color:#099">1</span>    <span style="color:#099">5</span>   <span style="color:#099">20</span>   <span style="color:#099">50</span>
<span style="color:#099">2</span>    <span style="color:#099">6</span>   <span style="color:#099">30</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">30</span>
<span style="color:#099">3</span>    <span style="color:#099">7</span>   <span style="color:#099">40</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">50</span>
</code></pre></div><h3 ref="if-thenhttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlif-then-permalink-to-this-headline" >if-then…<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#if-then" title="Permalink to this headline"></a></h3><a class="anchor" id="if-thenhttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlif-then-permalink-to-this-headline"></a>
<p>An if-then on one column
Customarily, we import as follows:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">3</span>]: df<span style="color:#000;font-weight:bold">.</span>loc[df<span style="color:#000;font-weight:bold">.</span>AAA <span style="color:#000;font-weight:bold">&gt;=</span> <span style="color:#099">5</span>, <span style="color:#d14">&#39;BBB&#39;</span>] <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>

In [<span style="color:#099">4</span>]: df
Out[<span style="color:#099">4</span>]: 
 AAA  BBB  CCC
<span style="color:#099">0</span>    <span style="color:#099">4</span>   <span style="color:#099">10</span>  <span style="color:#099">100</span>
<span style="color:#099">1</span>    <span style="color:#099">5</span>   <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>   <span style="color:#099">50</span>
<span style="color:#099">2</span>    <span style="color:#099">6</span>   <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">30</span>
<span style="color:#099">3</span>    <span style="color:#099">7</span>   <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">50</span>
</code></pre></div><p>An if-then with assignment to 2 columns:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">5</span>]: df<span style="color:#000;font-weight:bold">.</span>loc[df<span style="color:#000;font-weight:bold">.</span>AAA <span style="color:#000;font-weight:bold">&gt;=</span> <span style="color:#099">5</span>, [<span style="color:#d14">&#39;BBB&#39;</span>, <span style="color:#d14">&#39;CCC&#39;</span>]] <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">555</span>

In [<span style="color:#099">6</span>]: df
Out[<span style="color:#099">6</span>]: 
 AAA  BBB  CCC
<span style="color:#099">0</span>    <span style="color:#099">4</span>   <span style="color:#099">10</span>  <span style="color:#099">100</span>
<span style="color:#099">1</span>    <span style="color:#099">5</span>  <span style="color:#099">555</span>  <span style="color:#099">555</span>
<span style="color:#099">2</span>    <span style="color:#099">6</span>  <span style="color:#099">555</span>  <span style="color:#099">555</span>
<span style="color:#099">3</span>    <span style="color:#099">7</span>  <span style="color:#099">555</span>  <span style="color:#099">555</span>
</code></pre></div><p>Add another line with different logic, to do the -else</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">7</span>]: df<span style="color:#000;font-weight:bold">.</span>loc[df<span style="color:#000;font-weight:bold">.</span>AAA <span style="color:#000;font-weight:bold">&lt;</span> <span style="color:#099">5</span>, [<span style="color:#d14">&#39;BBB&#39;</span>, <span style="color:#d14">&#39;CCC&#39;</span>]] <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">2000</span>

In [<span style="color:#099">8</span>]: df
Out[<span style="color:#099">8</span>]: 
 AAA   BBB   CCC
<span style="color:#099">0</span>    <span style="color:#099">4</span>  <span style="color:#099">2000</span>  <span style="color:#099">2000</span>
<span style="color:#099">1</span>    <span style="color:#099">5</span>   <span style="color:#099">555</span>   <span style="color:#099">555</span>
<span style="color:#099">2</span>    <span style="color:#099">6</span>   <span style="color:#099">555</span>   <span style="color:#099">555</span>
<span style="color:#099">3</span>    <span style="color:#099">7</span>   <span style="color:#099">555</span>   <span style="color:#099">555</span>
</code></pre></div><p>Or use pandas where after you’ve set up a mask</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">9</span>]: df_mask <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame({<span style="color:#d14">&#39;AAA&#39;</span>: [<span style="color:#999">True</span>] <span style="color:#000;font-weight:bold">*</span> <span style="color:#099">4</span>,
 <span style="color:#000;font-weight:bold">...</span>:                        <span style="color:#d14">&#39;BBB&#39;</span>: [<span style="color:#999">False</span>] <span style="color:#000;font-weight:bold">*</span> <span style="color:#099">4</span>,
 <span style="color:#000;font-weight:bold">...</span>:                        <span style="color:#d14">&#39;CCC&#39;</span>: [<span style="color:#999">True</span>, <span style="color:#999">False</span>] <span style="color:#000;font-weight:bold">*</span> <span style="color:#099">2</span>})
 <span style="color:#000;font-weight:bold">...</span>: 

In [<span style="color:#099">10</span>]: df<span style="color:#000;font-weight:bold">.</span>where(df_mask, <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1000</span>)
Out[<span style="color:#099">10</span>]: 
 AAA   BBB   CCC
<span style="color:#099">0</span>    <span style="color:#099">4</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1000</span>  <span style="color:#099">2000</span>
<span style="color:#099">1</span>    <span style="color:#099">5</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1000</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1000</span>
<span style="color:#099">2</span>    <span style="color:#099">6</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1000</span>   <span style="color:#099">555</span>
<span style="color:#099">3</span>    <span style="color:#099">7</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1000</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1000</span>
</code></pre></div><p><a href="https://stackoverflow.com/questions/19913659/pandas-conditional-creation-of-a-series-dataframe-column">if-then-else using numpy’s where()</a></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">11</span>]: df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame({<span style="color:#d14">&#39;AAA&#39;</span>: [<span style="color:#099">4</span>, <span style="color:#099">5</span>, <span style="color:#099">6</span>, <span style="color:#099">7</span>],
 <span style="color:#000;font-weight:bold">....</span>:                   <span style="color:#d14">&#39;BBB&#39;</span>: [<span style="color:#099">10</span>, <span style="color:#099">20</span>, <span style="color:#099">30</span>, <span style="color:#099">40</span>],
 <span style="color:#000;font-weight:bold">....</span>:                   <span style="color:#d14">&#39;CCC&#39;</span>: [<span style="color:#099">100</span>, <span style="color:#099">50</span>, <span style="color:#000;font-weight:bold">-</span><span style="color:#099">30</span>, <span style="color:#000;font-weight:bold">-</span><span style="color:#099">50</span>]})
 <span style="color:#000;font-weight:bold">....</span>: 

In [<span style="color:#099">12</span>]: df
Out[<span style="color:#099">12</span>]: 
 AAA  BBB  CCC
<span style="color:#099">0</span>    <span style="color:#099">4</span>   <span style="color:#099">10</span>  <span style="color:#099">100</span>
<span style="color:#099">1</span>    <span style="color:#099">5</span>   <span style="color:#099">20</span>   <span style="color:#099">50</span>
<span style="color:#099">2</span>    <span style="color:#099">6</span>   <span style="color:#099">30</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">30</span>
<span style="color:#099">3</span>    <span style="color:#099">7</span>   <span style="color:#099">40</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">50</span>

In [<span style="color:#099">13</span>]: df[<span style="color:#d14">&#39;logic&#39;</span>] <span style="color:#000;font-weight:bold">=</span> np<span style="color:#000;font-weight:bold">.</span>where(df[<span style="color:#d14">&#39;AAA&#39;</span>] <span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#099">5</span>, <span style="color:#d14">&#39;high&#39;</span>, <span style="color:#d14">&#39;low&#39;</span>)

In [<span style="color:#099">14</span>]: df
Out[<span style="color:#099">14</span>]: 
 AAA  BBB  CCC logic
<span style="color:#099">0</span>    <span style="color:#099">4</span>   <span style="color:#099">10</span>  <span style="color:#099">100</span>   low
<span style="color:#099">1</span>    <span style="color:#099">5</span>   <span style="color:#099">20</span>   <span style="color:#099">50</span>   low
<span style="color:#099">2</span>    <span style="color:#099">6</span>   <span style="color:#099">30</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">30</span>  high
<span style="color:#099">3</span>    <span style="color:#099">7</span>   <span style="color:#099">40</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">50</span>  high
</code></pre></div><h3 ref="splittinghttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlsplitting-permalink-to-this-headline" >Splitting<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#splitting" title="Permalink to this headline"></a></h3><a class="anchor" id="splittinghttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlsplitting-permalink-to-this-headline"></a>
<p><a href="https://stackoverflow.com/questions/14957116/how-to-split-a-dataframe-according-to-a-boolean-criterion">Split a frame with a boolean criterion</a></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">15</span>]: df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame({<span style="color:#d14">&#39;AAA&#39;</span>: [<span style="color:#099">4</span>, <span style="color:#099">5</span>, <span style="color:#099">6</span>, <span style="color:#099">7</span>],
 <span style="color:#000;font-weight:bold">....</span>:                   <span style="color:#d14">&#39;BBB&#39;</span>: [<span style="color:#099">10</span>, <span style="color:#099">20</span>, <span style="color:#099">30</span>, <span style="color:#099">40</span>],
 <span style="color:#000;font-weight:bold">....</span>:                   <span style="color:#d14">&#39;CCC&#39;</span>: [<span style="color:#099">100</span>, <span style="color:#099">50</span>, <span style="color:#000;font-weight:bold">-</span><span style="color:#099">30</span>, <span style="color:#000;font-weight:bold">-</span><span style="color:#099">50</span>]})
 <span style="color:#000;font-weight:bold">....</span>: 

In [<span style="color:#099">16</span>]: df
Out[<span style="color:#099">16</span>]: 
 AAA  BBB  CCC
<span style="color:#099">0</span>    <span style="color:#099">4</span>   <span style="color:#099">10</span>  <span style="color:#099">100</span>
<span style="color:#099">1</span>    <span style="color:#099">5</span>   <span style="color:#099">20</span>   <span style="color:#099">50</span>
<span style="color:#099">2</span>    <span style="color:#099">6</span>   <span style="color:#099">30</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">30</span>
<span style="color:#099">3</span>    <span style="color:#099">7</span>   <span style="color:#099">40</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">50</span>

In [<span style="color:#099">17</span>]: df[df<span style="color:#000;font-weight:bold">.</span>AAA <span style="color:#000;font-weight:bold">&lt;=</span> <span style="color:#099">5</span>]
Out[<span style="color:#099">17</span>]: 
 AAA  BBB  CCC
<span style="color:#099">0</span>    <span style="color:#099">4</span>   <span style="color:#099">10</span>  <span style="color:#099">100</span>
<span style="color:#099">1</span>    <span style="color:#099">5</span>   <span style="color:#099">20</span>   <span style="color:#099">50</span>

In [<span style="color:#099">18</span>]: df[df<span style="color:#000;font-weight:bold">.</span>AAA <span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#099">5</span>]
Out[<span style="color:#099">18</span>]: 
 AAA  BBB  CCC
<span style="color:#099">2</span>    <span style="color:#099">6</span>   <span style="color:#099">30</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">30</span>
<span style="color:#099">3</span>    <span style="color:#099">7</span>   <span style="color:#099">40</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">50</span>
</code></pre></div><h3 ref="building-criteriahttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlbuilding-criteria-permalink-to-this-headline" >Building criteria<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#building-criteria" title="Permalink to this headline"></a></h3><a class="anchor" id="building-criteriahttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlbuilding-criteria-permalink-to-this-headline"></a>
<p><a href="https://stackoverflow.com/questions/15315452/selecting-with-complex-criteria-from-pandas-dataframe">Select with multi-column criteria</a></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">19</span>]: df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame({<span style="color:#d14">&#39;AAA&#39;</span>: [<span style="color:#099">4</span>, <span style="color:#099">5</span>, <span style="color:#099">6</span>, <span style="color:#099">7</span>],
 <span style="color:#000;font-weight:bold">....</span>:                   <span style="color:#d14">&#39;BBB&#39;</span>: [<span style="color:#099">10</span>, <span style="color:#099">20</span>, <span style="color:#099">30</span>, <span style="color:#099">40</span>],
 <span style="color:#000;font-weight:bold">....</span>:                   <span style="color:#d14">&#39;CCC&#39;</span>: [<span style="color:#099">100</span>, <span style="color:#099">50</span>, <span style="color:#000;font-weight:bold">-</span><span style="color:#099">30</span>, <span style="color:#000;font-weight:bold">-</span><span style="color:#099">50</span>]})
 <span style="color:#000;font-weight:bold">....</span>: 

In [<span style="color:#099">20</span>]: df
Out[<span style="color:#099">20</span>]: 
 AAA  BBB  CCC
<span style="color:#099">0</span>    <span style="color:#099">4</span>   <span style="color:#099">10</span>  <span style="color:#099">100</span>
<span style="color:#099">1</span>    <span style="color:#099">5</span>   <span style="color:#099">20</span>   <span style="color:#099">50</span>
<span style="color:#099">2</span>    <span style="color:#099">6</span>   <span style="color:#099">30</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">30</span>
<span style="color:#099">3</span>    <span style="color:#099">7</span>   <span style="color:#099">40</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">50</span>
</code></pre></div><p>…and (without assignment returns a Series)</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">21</span>]: df<span style="color:#000;font-weight:bold">.</span>loc[(df[<span style="color:#d14">&#39;BBB&#39;</span>] <span style="color:#000;font-weight:bold">&lt;</span> <span style="color:#099">25</span>) <span style="color:#000;font-weight:bold">&amp;</span> (df[<span style="color:#d14">&#39;CCC&#39;</span>] <span style="color:#000;font-weight:bold">&gt;=</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">40</span>), <span style="color:#d14">&#39;AAA&#39;</span>]
Out[<span style="color:#099">21</span>]: 
<span style="color:#099">0</span>    <span style="color:#099">4</span>
<span style="color:#099">1</span>    <span style="color:#099">5</span>
Name: AAA, dtype: int64
</code></pre></div><p>…or (without assignment returns a Series)</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">22</span>]: df<span style="color:#000;font-weight:bold">.</span>loc[(df[<span style="color:#d14">&#39;BBB&#39;</span>] <span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#099">25</span>) <span style="color:#000;font-weight:bold">|</span> (df[<span style="color:#d14">&#39;CCC&#39;</span>] <span style="color:#000;font-weight:bold">&gt;=</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">40</span>), <span style="color:#d14">&#39;AAA&#39;</span>]
Out[<span style="color:#099">22</span>]: 
<span style="color:#099">0</span>    <span style="color:#099">4</span>
<span style="color:#099">1</span>    <span style="color:#099">5</span>
<span style="color:#099">2</span>    <span style="color:#099">6</span>
<span style="color:#099">3</span>    <span style="color:#099">7</span>
Name: AAA, dtype: int64
</code></pre></div><p>…or (with assignment modifies the DataFrame.)</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">23</span>]: df<span style="color:#000;font-weight:bold">.</span>loc[(df[<span style="color:#d14">&#39;BBB&#39;</span>] <span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#099">25</span>) <span style="color:#000;font-weight:bold">|</span> (df[<span style="color:#d14">&#39;CCC&#39;</span>] <span style="color:#000;font-weight:bold">&gt;=</span> <span style="color:#099">75</span>), <span style="color:#d14">&#39;AAA&#39;</span>] <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0.1</span>

In [<span style="color:#099">24</span>]: df
Out[<span style="color:#099">24</span>]: 
 AAA  BBB  CCC
<span style="color:#099">0</span>  <span style="color:#099">0.1</span>   <span style="color:#099">10</span>  <span style="color:#099">100</span>
<span style="color:#099">1</span>  <span style="color:#099">5.0</span>   <span style="color:#099">20</span>   <span style="color:#099">50</span>
<span style="color:#099">2</span>  <span style="color:#099">0.1</span>   <span style="color:#099">30</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">30</span>
<span style="color:#099">3</span>  <span style="color:#099">0.1</span>   <span style="color:#099">40</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">50</span>
</code></pre></div><p><a href="https://stackoverflow.com/questions/17758023/return-rows-in-a-dataframe-closest-to-a-user-defined-number">Select rows with data closest to certain value using argsort</a></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">25</span>]: df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame({<span style="color:#d14">&#39;AAA&#39;</span>: [<span style="color:#099">4</span>, <span style="color:#099">5</span>, <span style="color:#099">6</span>, <span style="color:#099">7</span>],
 <span style="color:#000;font-weight:bold">....</span>:                   <span style="color:#d14">&#39;BBB&#39;</span>: [<span style="color:#099">10</span>, <span style="color:#099">20</span>, <span style="color:#099">30</span>, <span style="color:#099">40</span>],
 <span style="color:#000;font-weight:bold">....</span>:                   <span style="color:#d14">&#39;CCC&#39;</span>: [<span style="color:#099">100</span>, <span style="color:#099">50</span>, <span style="color:#000;font-weight:bold">-</span><span style="color:#099">30</span>, <span style="color:#000;font-weight:bold">-</span><span style="color:#099">50</span>]})
 <span style="color:#000;font-weight:bold">....</span>: 

In [<span style="color:#099">26</span>]: df
Out[<span style="color:#099">26</span>]: 
 AAA  BBB  CCC
<span style="color:#099">0</span>    <span style="color:#099">4</span>   <span style="color:#099">10</span>  <span style="color:#099">100</span>
<span style="color:#099">1</span>    <span style="color:#099">5</span>   <span style="color:#099">20</span>   <span style="color:#099">50</span>
<span style="color:#099">2</span>    <span style="color:#099">6</span>   <span style="color:#099">30</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">30</span>
<span style="color:#099">3</span>    <span style="color:#099">7</span>   <span style="color:#099">40</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">50</span>
</code></pre></div><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">27</span>]: aValue <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">43.0</span>

In [<span style="color:#099">28</span>]: df<span style="color:#000;font-weight:bold">.</span>loc[(df<span style="color:#000;font-weight:bold">.</span>CCC <span style="color:#000;font-weight:bold">-</span> aValue)<span style="color:#000;font-weight:bold">.</span>abs()<span style="color:#000;font-weight:bold">.</span>argsort()]
Out[<span style="color:#099">28</span>]: 
 AAA  BBB  CCC
<span style="color:#099">1</span>    <span style="color:#099">5</span>   <span style="color:#099">20</span>   <span style="color:#099">50</span>
<span style="color:#099">0</span>    <span style="color:#099">4</span>   <span style="color:#099">10</span>  <span style="color:#099">100</span>
<span style="color:#099">2</span>    <span style="color:#099">6</span>   <span style="color:#099">30</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">30</span>
<span style="color:#099">3</span>    <span style="color:#099">7</span>   <span style="color:#099">40</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">50</span>
</code></pre></div><p><a href="https://stackoverflow.com/questions/21058254/pandas-boolean-operation-in-a-python-list/21058331">Dynamically reduce a list of criteria using a binary operators</a></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">29</span>]: df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame({<span style="color:#d14">&#39;AAA&#39;</span>: [<span style="color:#099">4</span>, <span style="color:#099">5</span>, <span style="color:#099">6</span>, <span style="color:#099">7</span>],
 <span style="color:#000;font-weight:bold">....</span>:                   <span style="color:#d14">&#39;BBB&#39;</span>: [<span style="color:#099">10</span>, <span style="color:#099">20</span>, <span style="color:#099">30</span>, <span style="color:#099">40</span>],
 <span style="color:#000;font-weight:bold">....</span>:                   <span style="color:#d14">&#39;CCC&#39;</span>: [<span style="color:#099">100</span>, <span style="color:#099">50</span>, <span style="color:#000;font-weight:bold">-</span><span style="color:#099">30</span>, <span style="color:#000;font-weight:bold">-</span><span style="color:#099">50</span>]})
 <span style="color:#000;font-weight:bold">....</span>: 

In [<span style="color:#099">30</span>]: df
Out[<span style="color:#099">30</span>]: 
 AAA  BBB  CCC
<span style="color:#099">0</span>    <span style="color:#099">4</span>   <span style="color:#099">10</span>  <span style="color:#099">100</span>
<span style="color:#099">1</span>    <span style="color:#099">5</span>   <span style="color:#099">20</span>   <span style="color:#099">50</span>
<span style="color:#099">2</span>    <span style="color:#099">6</span>   <span style="color:#099">30</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">30</span>
<span style="color:#099">3</span>    <span style="color:#099">7</span>   <span style="color:#099">40</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">50</span>

In [<span style="color:#099">31</span>]: Crit1 <span style="color:#000;font-weight:bold">=</span> df<span style="color:#000;font-weight:bold">.</span>AAA <span style="color:#000;font-weight:bold">&lt;=</span> <span style="color:#099">5.5</span>

In [<span style="color:#099">32</span>]: Crit2 <span style="color:#000;font-weight:bold">=</span> df<span style="color:#000;font-weight:bold">.</span>BBB <span style="color:#000;font-weight:bold">==</span> <span style="color:#099">10.0</span>

In [<span style="color:#099">33</span>]: Crit3 <span style="color:#000;font-weight:bold">=</span> df<span style="color:#000;font-weight:bold">.</span>CCC <span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">40.0</span>
</code></pre></div><p>One could hard code:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">34</span>]: AllCrit <span style="color:#000;font-weight:bold">=</span> Crit1 <span style="color:#000;font-weight:bold">&amp;</span> Crit2 <span style="color:#000;font-weight:bold">&amp;</span> Crit3
</code></pre></div><p>…Or it can be done with a list of dynamically built criteria</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">35</span>]: <span style="color:#000;font-weight:bold">import</span> <span style="color:#555">functools</span>

In [<span style="color:#099">36</span>]: CritList <span style="color:#000;font-weight:bold">=</span> [Crit1, Crit2, Crit3]

In [<span style="color:#099">37</span>]: AllCrit <span style="color:#000;font-weight:bold">=</span> functools<span style="color:#000;font-weight:bold">.</span>reduce(<span style="color:#000;font-weight:bold">lambda</span> x, y: x <span style="color:#000;font-weight:bold">&amp;</span> y, CritList)

In [<span style="color:#099">38</span>]: df[AllCrit]
Out[<span style="color:#099">38</span>]: 
 AAA  BBB  CCC
<span style="color:#099">0</span>    <span style="color:#099">4</span>   <span style="color:#099">10</span>  <span style="color:#099">100</span>
</code></pre></div><h2 ref="selectionhttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlselection-permalink-to-this-headline" >Selection<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#selection" title="Permalink to this headline"></a></h2><a class="anchor" id="selectionhttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlselection-permalink-to-this-headline"></a>
<h3 ref="dataframeshttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmldataframes-permalink-to-this-headline" >Dataframes<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#dataframes" title="Permalink to this headline"></a></h3><a class="anchor" id="dataframeshttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmldataframes-permalink-to-this-headline"></a>
<p>The  <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#indexing">indexing</a>  docs.</p>
<p><a href="https://stackoverflow.com/questions/14725068/pandas-using-row-labels-in-boolean-indexing">Using both row labels and value conditionals</a></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">39</span>]: df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame({<span style="color:#d14">&#39;AAA&#39;</span>: [<span style="color:#099">4</span>, <span style="color:#099">5</span>, <span style="color:#099">6</span>, <span style="color:#099">7</span>],
 <span style="color:#000;font-weight:bold">....</span>:                   <span style="color:#d14">&#39;BBB&#39;</span>: [<span style="color:#099">10</span>, <span style="color:#099">20</span>, <span style="color:#099">30</span>, <span style="color:#099">40</span>],
 <span style="color:#000;font-weight:bold">....</span>:                   <span style="color:#d14">&#39;CCC&#39;</span>: [<span style="color:#099">100</span>, <span style="color:#099">50</span>, <span style="color:#000;font-weight:bold">-</span><span style="color:#099">30</span>, <span style="color:#000;font-weight:bold">-</span><span style="color:#099">50</span>]})
 <span style="color:#000;font-weight:bold">....</span>: 

In [<span style="color:#099">40</span>]: df
Out[<span style="color:#099">40</span>]: 
 AAA  BBB  CCC
<span style="color:#099">0</span>    <span style="color:#099">4</span>   <span style="color:#099">10</span>  <span style="color:#099">100</span>
<span style="color:#099">1</span>    <span style="color:#099">5</span>   <span style="color:#099">20</span>   <span style="color:#099">50</span>
<span style="color:#099">2</span>    <span style="color:#099">6</span>   <span style="color:#099">30</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">30</span>
<span style="color:#099">3</span>    <span style="color:#099">7</span>   <span style="color:#099">40</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">50</span>
</code></pre></div><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">41</span>]: df[(df<span style="color:#000;font-weight:bold">.</span>AAA <span style="color:#000;font-weight:bold">&lt;=</span> <span style="color:#099">6</span>) <span style="color:#000;font-weight:bold">&amp;</span> (df<span style="color:#000;font-weight:bold">.</span>index<span style="color:#000;font-weight:bold">.</span>isin([<span style="color:#099">0</span>, <span style="color:#099">2</span>, <span style="color:#099">4</span>]))]
Out[<span style="color:#099">41</span>]: 
 AAA  BBB  CCC
<span style="color:#099">0</span>    <span style="color:#099">4</span>   <span style="color:#099">10</span>  <span style="color:#099">100</span>
<span style="color:#099">2</span>    <span style="color:#099">6</span>   <span style="color:#099">30</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">30</span>
</code></pre></div><p><a href="https://github.com/pandas-dev/pandas/issues/2904">Use loc for label-oriented slicing and iloc positional slicing</a></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">42</span>]: df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame({<span style="color:#d14">&#39;AAA&#39;</span>: [<span style="color:#099">4</span>, <span style="color:#099">5</span>, <span style="color:#099">6</span>, <span style="color:#099">7</span>],
 <span style="color:#000;font-weight:bold">....</span>:                   <span style="color:#d14">&#39;BBB&#39;</span>: [<span style="color:#099">10</span>, <span style="color:#099">20</span>, <span style="color:#099">30</span>, <span style="color:#099">40</span>],
 <span style="color:#000;font-weight:bold">....</span>:                   <span style="color:#d14">&#39;CCC&#39;</span>: [<span style="color:#099">100</span>, <span style="color:#099">50</span>, <span style="color:#000;font-weight:bold">-</span><span style="color:#099">30</span>, <span style="color:#000;font-weight:bold">-</span><span style="color:#099">50</span>]},
 <span style="color:#000;font-weight:bold">....</span>:                  index<span style="color:#000;font-weight:bold">=</span>[<span style="color:#d14">&#39;foo&#39;</span>, <span style="color:#d14">&#39;bar&#39;</span>, <span style="color:#d14">&#39;boo&#39;</span>, <span style="color:#d14">&#39;kar&#39;</span>])
 <span style="color:#000;font-weight:bold">....</span>: 
</code></pre></div><p>There are 2 explicit slicing methods, with a third general case</p>
<ol>
<li>
<p>Positional-oriented (Python slicing style : exclusive of end)</p>
</li>
<li>
<p>Label-oriented (Non-Python slicing style : inclusive of end)</p>
</li>
<li>
<p>General (Either slicing style : depends on if the slice contains labels or positions)</p>
</li>
</ol>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">43</span>]: df<span style="color:#000;font-weight:bold">.</span>loc[<span style="color:#d14">&#39;bar&#39;</span>:<span style="color:#d14">&#39;kar&#39;</span>]  <span style="color:#998;font-style:italic"># Label</span>
Out[<span style="color:#099">43</span>]: 
 AAA  BBB  CCC
bar    <span style="color:#099">5</span>   <span style="color:#099">20</span>   <span style="color:#099">50</span>
boo    <span style="color:#099">6</span>   <span style="color:#099">30</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">30</span>
kar    <span style="color:#099">7</span>   <span style="color:#099">40</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">50</span>

<span style="color:#998;font-style:italic"># Generic</span>
In [<span style="color:#099">44</span>]: df[<span style="color:#099">0</span>:<span style="color:#099">3</span>]
Out[<span style="color:#099">44</span>]: 
 AAA  BBB  CCC
foo    <span style="color:#099">4</span>   <span style="color:#099">10</span>  <span style="color:#099">100</span>
bar    <span style="color:#099">5</span>   <span style="color:#099">20</span>   <span style="color:#099">50</span>
boo    <span style="color:#099">6</span>   <span style="color:#099">30</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">30</span>

In [<span style="color:#099">45</span>]: df[<span style="color:#d14">&#39;bar&#39;</span>:<span style="color:#d14">&#39;kar&#39;</span>]
Out[<span style="color:#099">45</span>]: 
 AAA  BBB  CCC
bar    <span style="color:#099">5</span>   <span style="color:#099">20</span>   <span style="color:#099">50</span>
boo    <span style="color:#099">6</span>   <span style="color:#099">30</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">30</span>
kar    <span style="color:#099">7</span>   <span style="color:#099">40</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">50</span>
</code></pre></div><p>Ambiguity arises when an index consists of integers with a non-zero start or non-unit increment.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">46</span>]: data <span style="color:#000;font-weight:bold">=</span> {<span style="color:#d14">&#39;AAA&#39;</span>: [<span style="color:#099">4</span>, <span style="color:#099">5</span>, <span style="color:#099">6</span>, <span style="color:#099">7</span>],
 <span style="color:#000;font-weight:bold">....</span>:        <span style="color:#d14">&#39;BBB&#39;</span>: [<span style="color:#099">10</span>, <span style="color:#099">20</span>, <span style="color:#099">30</span>, <span style="color:#099">40</span>],
 <span style="color:#000;font-weight:bold">....</span>:        <span style="color:#d14">&#39;CCC&#39;</span>: [<span style="color:#099">100</span>, <span style="color:#099">50</span>, <span style="color:#000;font-weight:bold">-</span><span style="color:#099">30</span>, <span style="color:#000;font-weight:bold">-</span><span style="color:#099">50</span>]}
 <span style="color:#000;font-weight:bold">....</span>: 

In [<span style="color:#099">47</span>]: df2 <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame(data<span style="color:#000;font-weight:bold">=</span>data, index<span style="color:#000;font-weight:bold">=</span>[<span style="color:#099">1</span>, <span style="color:#099">2</span>, <span style="color:#099">3</span>, <span style="color:#099">4</span>])  <span style="color:#998;font-style:italic"># Note index starts at 1.</span>

In [<span style="color:#099">48</span>]: df2<span style="color:#000;font-weight:bold">.</span>iloc[<span style="color:#099">1</span>:<span style="color:#099">3</span>]  <span style="color:#998;font-style:italic"># Position-oriented</span>
Out[<span style="color:#099">48</span>]: 
 AAA  BBB  CCC
<span style="color:#099">2</span>    <span style="color:#099">5</span>   <span style="color:#099">20</span>   <span style="color:#099">50</span>
<span style="color:#099">3</span>    <span style="color:#099">6</span>   <span style="color:#099">30</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">30</span>

In [<span style="color:#099">49</span>]: df2<span style="color:#000;font-weight:bold">.</span>loc[<span style="color:#099">1</span>:<span style="color:#099">3</span>]  <span style="color:#998;font-style:italic"># Label-oriented</span>
Out[<span style="color:#099">49</span>]: 
 AAA  BBB  CCC
<span style="color:#099">1</span>    <span style="color:#099">4</span>   <span style="color:#099">10</span>  <span style="color:#099">100</span>
<span style="color:#099">2</span>    <span style="color:#099">5</span>   <span style="color:#099">20</span>   <span style="color:#099">50</span>
<span style="color:#099">3</span>    <span style="color:#099">6</span>   <span style="color:#099">30</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">30</span>
</code></pre></div><p><a href="https://stackoverflow.com/questions/14986510/picking-out-elements-based-on-complement-of-indices-in-python-pandas">Using inverse operator (~) to take the complement of a mask</a></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">50</span>]: df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame({<span style="color:#d14">&#39;AAA&#39;</span>: [<span style="color:#099">4</span>, <span style="color:#099">5</span>, <span style="color:#099">6</span>, <span style="color:#099">7</span>],
 <span style="color:#000;font-weight:bold">....</span>:                   <span style="color:#d14">&#39;BBB&#39;</span>: [<span style="color:#099">10</span>, <span style="color:#099">20</span>, <span style="color:#099">30</span>, <span style="color:#099">40</span>],
 <span style="color:#000;font-weight:bold">....</span>:                   <span style="color:#d14">&#39;CCC&#39;</span>: [<span style="color:#099">100</span>, <span style="color:#099">50</span>, <span style="color:#000;font-weight:bold">-</span><span style="color:#099">30</span>, <span style="color:#000;font-weight:bold">-</span><span style="color:#099">50</span>]})
 <span style="color:#000;font-weight:bold">....</span>: 

In [<span style="color:#099">51</span>]: df
Out[<span style="color:#099">51</span>]: 
 AAA  BBB  CCC
<span style="color:#099">0</span>    <span style="color:#099">4</span>   <span style="color:#099">10</span>  <span style="color:#099">100</span>
<span style="color:#099">1</span>    <span style="color:#099">5</span>   <span style="color:#099">20</span>   <span style="color:#099">50</span>
<span style="color:#099">2</span>    <span style="color:#099">6</span>   <span style="color:#099">30</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">30</span>
<span style="color:#099">3</span>    <span style="color:#099">7</span>   <span style="color:#099">40</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">50</span>

In [<span style="color:#099">52</span>]: df[<span style="color:#000;font-weight:bold">~</span>((df<span style="color:#000;font-weight:bold">.</span>AAA <span style="color:#000;font-weight:bold">&lt;=</span> <span style="color:#099">6</span>) <span style="color:#000;font-weight:bold">&amp;</span> (df<span style="color:#000;font-weight:bold">.</span>index<span style="color:#000;font-weight:bold">.</span>isin([<span style="color:#099">0</span>, <span style="color:#099">2</span>, <span style="color:#099">4</span>])))]
Out[<span style="color:#099">52</span>]: 
 AAA  BBB  CCC
<span style="color:#099">1</span>    <span style="color:#099">5</span>   <span style="color:#099">20</span>   <span style="color:#099">50</span>
<span style="color:#099">3</span>    <span style="color:#099">7</span>   <span style="color:#099">40</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">50</span>
</code></pre></div><h3 ref="new-columnshttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlnew-columns-permalink-to-this-headline" >New columns<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#new-columns" title="Permalink to this headline"></a></h3><a class="anchor" id="new-columnshttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlnew-columns-permalink-to-this-headline"></a>
<p><a href="https://stackoverflow.com/questions/16575868/efficiently-creating-additional-columns-in-a-pandas-dataframe-using-map">Efficiently and dynamically creating new columns using applymap</a></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">53</span>]: df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame({<span style="color:#d14">&#39;AAA&#39;</span>: [<span style="color:#099">1</span>, <span style="color:#099">2</span>, <span style="color:#099">1</span>, <span style="color:#099">3</span>],
 <span style="color:#000;font-weight:bold">....</span>:                   <span style="color:#d14">&#39;BBB&#39;</span>: [<span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">2</span>, <span style="color:#099">2</span>],
 <span style="color:#000;font-weight:bold">....</span>:                   <span style="color:#d14">&#39;CCC&#39;</span>: [<span style="color:#099">2</span>, <span style="color:#099">1</span>, <span style="color:#099">3</span>, <span style="color:#099">1</span>]})
 <span style="color:#000;font-weight:bold">....</span>: 

In [<span style="color:#099">54</span>]: df
Out[<span style="color:#099">54</span>]: 
 AAA  BBB  CCC
<span style="color:#099">0</span>    <span style="color:#099">1</span>    <span style="color:#099">1</span>    <span style="color:#099">2</span>
<span style="color:#099">1</span>    <span style="color:#099">2</span>    <span style="color:#099">1</span>    <span style="color:#099">1</span>
<span style="color:#099">2</span>    <span style="color:#099">1</span>    <span style="color:#099">2</span>    <span style="color:#099">3</span>
<span style="color:#099">3</span>    <span style="color:#099">3</span>    <span style="color:#099">2</span>    <span style="color:#099">1</span>

In [<span style="color:#099">55</span>]: source_cols <span style="color:#000;font-weight:bold">=</span> df<span style="color:#000;font-weight:bold">.</span>columns   <span style="color:#998;font-style:italic"># Or some subset would work too</span>

In [<span style="color:#099">56</span>]: new_cols <span style="color:#000;font-weight:bold">=</span> [<span style="color:#0086b3">str</span>(x) <span style="color:#000;font-weight:bold">+</span> <span style="color:#d14">&#34;_cat&#34;</span> <span style="color:#000;font-weight:bold">for</span> x <span style="color:#000;font-weight:bold">in</span> source_cols]

In [<span style="color:#099">57</span>]: categories <span style="color:#000;font-weight:bold">=</span> {<span style="color:#099">1</span>: <span style="color:#d14">&#39;Alpha&#39;</span>, <span style="color:#099">2</span>: <span style="color:#d14">&#39;Beta&#39;</span>, <span style="color:#099">3</span>: <span style="color:#d14">&#39;Charlie&#39;</span>}

In [<span style="color:#099">58</span>]: df[new_cols] <span style="color:#000;font-weight:bold">=</span> df[source_cols]<span style="color:#000;font-weight:bold">.</span>applymap(categories<span style="color:#000;font-weight:bold">.</span>get)

In [<span style="color:#099">59</span>]: df
Out[<span style="color:#099">59</span>]: 
 AAA  BBB  CCC  AAA_cat BBB_cat  CCC_cat
<span style="color:#099">0</span>    <span style="color:#099">1</span>    <span style="color:#099">1</span>    <span style="color:#099">2</span>    Alpha   Alpha     Beta
<span style="color:#099">1</span>    <span style="color:#099">2</span>    <span style="color:#099">1</span>    <span style="color:#099">1</span>     Beta   Alpha    Alpha
<span style="color:#099">2</span>    <span style="color:#099">1</span>    <span style="color:#099">2</span>    <span style="color:#099">3</span>    Alpha    Beta  Charlie
<span style="color:#099">3</span>    <span style="color:#099">3</span>    <span style="color:#099">2</span>    <span style="color:#099">1</span>  Charlie    Beta    Alpha
</code></pre></div><p><a href="https://stackoverflow.com/questions/23394476/keep-other-columns-when-using-min-with-groupby">Keep other columns when using min() with groupby</a></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">60</span>]: df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame({<span style="color:#d14">&#39;AAA&#39;</span>: [<span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">2</span>, <span style="color:#099">2</span>, <span style="color:#099">2</span>, <span style="color:#099">3</span>, <span style="color:#099">3</span>],
 <span style="color:#000;font-weight:bold">....</span>:                   <span style="color:#d14">&#39;BBB&#39;</span>: [<span style="color:#099">2</span>, <span style="color:#099">1</span>, <span style="color:#099">3</span>, <span style="color:#099">4</span>, <span style="color:#099">5</span>, <span style="color:#099">1</span>, <span style="color:#099">2</span>, <span style="color:#099">3</span>]})
 <span style="color:#000;font-weight:bold">....</span>: 

In [<span style="color:#099">61</span>]: df
Out[<span style="color:#099">61</span>]: 
 AAA  BBB
<span style="color:#099">0</span>    <span style="color:#099">1</span>    <span style="color:#099">2</span>
<span style="color:#099">1</span>    <span style="color:#099">1</span>    <span style="color:#099">1</span>
<span style="color:#099">2</span>    <span style="color:#099">1</span>    <span style="color:#099">3</span>
<span style="color:#099">3</span>    <span style="color:#099">2</span>    <span style="color:#099">4</span>
<span style="color:#099">4</span>    <span style="color:#099">2</span>    <span style="color:#099">5</span>
<span style="color:#099">5</span>    <span style="color:#099">2</span>    <span style="color:#099">1</span>
<span style="color:#099">6</span>    <span style="color:#099">3</span>    <span style="color:#099">2</span>
<span style="color:#099">7</span>    <span style="color:#099">3</span>    <span style="color:#099">3</span>
</code></pre></div><p>Method 1 : idxmin() to get the index of the minimums</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">62</span>]: df<span style="color:#000;font-weight:bold">.</span>loc[df<span style="color:#000;font-weight:bold">.</span>groupby(<span style="color:#d14">&#34;AAA&#34;</span>)[<span style="color:#d14">&#34;BBB&#34;</span>]<span style="color:#000;font-weight:bold">.</span>idxmin()]
Out[<span style="color:#099">62</span>]: 
 AAA  BBB
<span style="color:#099">1</span>    <span style="color:#099">1</span>    <span style="color:#099">1</span>
<span style="color:#099">5</span>    <span style="color:#099">2</span>    <span style="color:#099">1</span>
<span style="color:#099">6</span>    <span style="color:#099">3</span>    <span style="color:#099">2</span>
</code></pre></div><p>Method 2 : sort then take first of each</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">63</span>]: df<span style="color:#000;font-weight:bold">.</span>sort_values(by<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;BBB&#34;</span>)<span style="color:#000;font-weight:bold">.</span>groupby(<span style="color:#d14">&#34;AAA&#34;</span>, as_index<span style="color:#000;font-weight:bold">=</span><span style="color:#999">False</span>)<span style="color:#000;font-weight:bold">.</span>first()
Out[<span style="color:#099">63</span>]: 
 AAA  BBB
<span style="color:#099">0</span>    <span style="color:#099">1</span>    <span style="color:#099">1</span>
<span style="color:#099">1</span>    <span style="color:#099">2</span>    <span style="color:#099">1</span>
<span style="color:#099">2</span>    <span style="color:#099">3</span>    <span style="color:#099">2</span>
</code></pre></div><p>Notice the same results, with the exception of the index.</p>
<h2 ref="multiindexinghttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlmultiindexing-permalink-to-this-headline" >Multiindexing<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#multiindexing" title="Permalink to this headline"></a></h2><a class="anchor" id="multiindexinghttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlmultiindexing-permalink-to-this-headline"></a>
<p>The  <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/advanced.html#advanced-hierarchical">multindexing</a>  docs.</p>
<p><a href="https://stackoverflow.com/questions/14916358/reshaping-dataframes-in-pandas-based-on-column-labels">Creating a MultiIndex from a labeled frame</a></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">64</span>]: df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame({<span style="color:#d14">&#39;row&#39;</span>: [<span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">2</span>],
 <span style="color:#000;font-weight:bold">....</span>:                   <span style="color:#d14">&#39;One_X&#39;</span>: [<span style="color:#099">1.1</span>, <span style="color:#099">1.1</span>, <span style="color:#099">1.1</span>],
 <span style="color:#000;font-weight:bold">....</span>:                   <span style="color:#d14">&#39;One_Y&#39;</span>: [<span style="color:#099">1.2</span>, <span style="color:#099">1.2</span>, <span style="color:#099">1.2</span>],
 <span style="color:#000;font-weight:bold">....</span>:                   <span style="color:#d14">&#39;Two_X&#39;</span>: [<span style="color:#099">1.11</span>, <span style="color:#099">1.11</span>, <span style="color:#099">1.11</span>],
 <span style="color:#000;font-weight:bold">....</span>:                   <span style="color:#d14">&#39;Two_Y&#39;</span>: [<span style="color:#099">1.22</span>, <span style="color:#099">1.22</span>, <span style="color:#099">1.22</span>]})
 <span style="color:#000;font-weight:bold">....</span>: 

In [<span style="color:#099">65</span>]: df
Out[<span style="color:#099">65</span>]: 
 row  One_X  One_Y  Two_X  Two_Y
<span style="color:#099">0</span>    <span style="color:#099">0</span>    <span style="color:#099">1.1</span>    <span style="color:#099">1.2</span>   <span style="color:#099">1.11</span>   <span style="color:#099">1.22</span>
<span style="color:#099">1</span>    <span style="color:#099">1</span>    <span style="color:#099">1.1</span>    <span style="color:#099">1.2</span>   <span style="color:#099">1.11</span>   <span style="color:#099">1.22</span>
<span style="color:#099">2</span>    <span style="color:#099">2</span>    <span style="color:#099">1.1</span>    <span style="color:#099">1.2</span>   <span style="color:#099">1.11</span>   <span style="color:#099">1.22</span>

<span style="color:#998;font-style:italic"># As Labelled Index</span>
In [<span style="color:#099">66</span>]: df <span style="color:#000;font-weight:bold">=</span> df<span style="color:#000;font-weight:bold">.</span>set_index(<span style="color:#d14">&#39;row&#39;</span>)

In [<span style="color:#099">67</span>]: df
Out[<span style="color:#099">67</span>]: 
 One_X  One_Y  Two_X  Two_Y
row 
<span style="color:#099">0</span>      <span style="color:#099">1.1</span>    <span style="color:#099">1.2</span>   <span style="color:#099">1.11</span>   <span style="color:#099">1.22</span>
<span style="color:#099">1</span>      <span style="color:#099">1.1</span>    <span style="color:#099">1.2</span>   <span style="color:#099">1.11</span>   <span style="color:#099">1.22</span>
<span style="color:#099">2</span>      <span style="color:#099">1.1</span>    <span style="color:#099">1.2</span>   <span style="color:#099">1.11</span>   <span style="color:#099">1.22</span>

<span style="color:#998;font-style:italic"># With Hierarchical Columns</span>
In [<span style="color:#099">68</span>]: df<span style="color:#000;font-weight:bold">.</span>columns <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>MultiIndex<span style="color:#000;font-weight:bold">.</span>from_tuples([<span style="color:#0086b3">tuple</span>(c<span style="color:#000;font-weight:bold">.</span>split(<span style="color:#d14">&#39;_&#39;</span>))
 <span style="color:#000;font-weight:bold">....</span>:                                        <span style="color:#000;font-weight:bold">for</span> c <span style="color:#000;font-weight:bold">in</span> df<span style="color:#000;font-weight:bold">.</span>columns])
 <span style="color:#000;font-weight:bold">....</span>: 

In [<span style="color:#099">69</span>]: df
Out[<span style="color:#099">69</span>]: 
 One        Two 
 X    Y     X     Y
row 
<span style="color:#099">0</span>    <span style="color:#099">1.1</span>  <span style="color:#099">1.2</span>  <span style="color:#099">1.11</span>  <span style="color:#099">1.22</span>
<span style="color:#099">1</span>    <span style="color:#099">1.1</span>  <span style="color:#099">1.2</span>  <span style="color:#099">1.11</span>  <span style="color:#099">1.22</span>
<span style="color:#099">2</span>    <span style="color:#099">1.1</span>  <span style="color:#099">1.2</span>  <span style="color:#099">1.11</span>  <span style="color:#099">1.22</span>

<span style="color:#998;font-style:italic"># Now stack &amp; Reset</span>
In [<span style="color:#099">70</span>]: df <span style="color:#000;font-weight:bold">=</span> df<span style="color:#000;font-weight:bold">.</span>stack(<span style="color:#099">0</span>)<span style="color:#000;font-weight:bold">.</span>reset_index(<span style="color:#099">1</span>)

In [<span style="color:#099">71</span>]: df
Out[<span style="color:#099">71</span>]: 
 level_1     X     Y
row 
<span style="color:#099">0</span>       One  <span style="color:#099">1.10</span>  <span style="color:#099">1.20</span>
<span style="color:#099">0</span>       Two  <span style="color:#099">1.11</span>  <span style="color:#099">1.22</span>
<span style="color:#099">1</span>       One  <span style="color:#099">1.10</span>  <span style="color:#099">1.20</span>
<span style="color:#099">1</span>       Two  <span style="color:#099">1.11</span>  <span style="color:#099">1.22</span>
<span style="color:#099">2</span>       One  <span style="color:#099">1.10</span>  <span style="color:#099">1.20</span>
<span style="color:#099">2</span>       Two  <span style="color:#099">1.11</span>  <span style="color:#099">1.22</span>

<span style="color:#998;font-style:italic"># And fix the labels (Notice the label &#39;level_1&#39; got added automatically)</span>
In [<span style="color:#099">72</span>]: df<span style="color:#000;font-weight:bold">.</span>columns <span style="color:#000;font-weight:bold">=</span> [<span style="color:#d14">&#39;Sample&#39;</span>, <span style="color:#d14">&#39;All_X&#39;</span>, <span style="color:#d14">&#39;All_Y&#39;</span>]

In [<span style="color:#099">73</span>]: df
Out[<span style="color:#099">73</span>]: 
 Sample  All_X  All_Y
row 
<span style="color:#099">0</span>      One   <span style="color:#099">1.10</span>   <span style="color:#099">1.20</span>
<span style="color:#099">0</span>      Two   <span style="color:#099">1.11</span>   <span style="color:#099">1.22</span>
<span style="color:#099">1</span>      One   <span style="color:#099">1.10</span>   <span style="color:#099">1.20</span>
<span style="color:#099">1</span>      Two   <span style="color:#099">1.11</span>   <span style="color:#099">1.22</span>
<span style="color:#099">2</span>      One   <span style="color:#099">1.10</span>   <span style="color:#099">1.20</span>
<span style="color:#099">2</span>      Two   <span style="color:#099">1.11</span>   <span style="color:#099">1.22</span>
</code></pre></div><h3 ref="arithmetichttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlarithmetic-permalink-to-this-headline" >Arithmetic<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#arithmetic" title="Permalink to this headline"></a></h3><a class="anchor" id="arithmetichttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlarithmetic-permalink-to-this-headline"></a>
<p><a href="https://stackoverflow.com/questions/19501510/divide-entire-pandas-multiindex-dataframe-by-dataframe-variable/19502176#19502176">Performing arithmetic with a MultiIndex that needs broadcasting</a></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">74</span>]: cols <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>MultiIndex<span style="color:#000;font-weight:bold">.</span>from_tuples([(x, y) <span style="color:#000;font-weight:bold">for</span> x <span style="color:#000;font-weight:bold">in</span> [<span style="color:#d14">&#39;A&#39;</span>, <span style="color:#d14">&#39;B&#39;</span>, <span style="color:#d14">&#39;C&#39;</span>]
 <span style="color:#000;font-weight:bold">....</span>:                                  <span style="color:#000;font-weight:bold">for</span> y <span style="color:#000;font-weight:bold">in</span> [<span style="color:#d14">&#39;O&#39;</span>, <span style="color:#d14">&#39;I&#39;</span>]])
 <span style="color:#000;font-weight:bold">....</span>: 

In [<span style="color:#099">75</span>]: df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame(np<span style="color:#000;font-weight:bold">.</span>random<span style="color:#000;font-weight:bold">.</span>randn(<span style="color:#099">2</span>, <span style="color:#099">6</span>), index<span style="color:#000;font-weight:bold">=</span>[<span style="color:#d14">&#39;n&#39;</span>, <span style="color:#d14">&#39;m&#39;</span>], columns<span style="color:#000;font-weight:bold">=</span>cols)

In [<span style="color:#099">76</span>]: df
Out[<span style="color:#099">76</span>]: 
 A                   B                   C 
 O         I         O         I         O         I
n  <span style="color:#099">0.469112</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.282863</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1.509059</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1.135632</span>  <span style="color:#099">1.212112</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.173215</span>
m  <span style="color:#099">0.119209</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1.044236</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.861849</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">2.104569</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.494929</span>  <span style="color:#099">1.071804</span>

In [<span style="color:#099">77</span>]: df <span style="color:#000;font-weight:bold">=</span> df<span style="color:#000;font-weight:bold">.</span>div(df[<span style="color:#d14">&#39;C&#39;</span>], level<span style="color:#000;font-weight:bold">=</span><span style="color:#099">1</span>)

In [<span style="color:#099">78</span>]: df
Out[<span style="color:#099">78</span>]: 
 A                   B              C 
 O         I         O         I    O    I
n  <span style="color:#099">0.387021</span>  <span style="color:#099">1.633022</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1.244983</span>  <span style="color:#099">6.556214</span>  <span style="color:#099">1.0</span>  <span style="color:#099">1.0</span>
m <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.240860</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.974279</span>  <span style="color:#099">1.741358</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1.963577</span>  <span style="color:#099">1.0</span>  <span style="color:#099">1.0</span>
</code></pre></div><h3 ref="slicinghttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlslicing-permalink-to-this-headline" >Slicing<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#slicing" title="Permalink to this headline"></a></h3><a class="anchor" id="slicinghttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlslicing-permalink-to-this-headline"></a>
<p><a href="https://stackoverflow.com/questions/12590131/how-to-slice-multindex-columns-in-pandas-dataframes">Slicing a MultiIndex with xs</a></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">79</span>]: coords <span style="color:#000;font-weight:bold">=</span> [(<span style="color:#d14">&#39;AA&#39;</span>, <span style="color:#d14">&#39;one&#39;</span>), (<span style="color:#d14">&#39;AA&#39;</span>, <span style="color:#d14">&#39;six&#39;</span>), (<span style="color:#d14">&#39;BB&#39;</span>, <span style="color:#d14">&#39;one&#39;</span>), (<span style="color:#d14">&#39;BB&#39;</span>, <span style="color:#d14">&#39;two&#39;</span>),
 <span style="color:#000;font-weight:bold">....</span>:          (<span style="color:#d14">&#39;BB&#39;</span>, <span style="color:#d14">&#39;six&#39;</span>)]
 <span style="color:#000;font-weight:bold">....</span>: 

In [<span style="color:#099">80</span>]: index <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>MultiIndex<span style="color:#000;font-weight:bold">.</span>from_tuples(coords)

In [<span style="color:#099">81</span>]: df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame([<span style="color:#099">11</span>, <span style="color:#099">22</span>, <span style="color:#099">33</span>, <span style="color:#099">44</span>, <span style="color:#099">55</span>], index, [<span style="color:#d14">&#39;MyData&#39;</span>])

In [<span style="color:#099">82</span>]: df
Out[<span style="color:#099">82</span>]: 
 MyData
AA one      <span style="color:#099">11</span>
 six      <span style="color:#099">22</span>
BB one      <span style="color:#099">33</span>
 two      <span style="color:#099">44</span>
 six      <span style="color:#099">55</span>
</code></pre></div><p>To take the cross section of the 1st level and 1st axis the index:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py"><span style="color:#998;font-style:italic"># Note : level and axis are optional, and default to zero</span>
In [<span style="color:#099">83</span>]: df<span style="color:#000;font-weight:bold">.</span>xs(<span style="color:#d14">&#39;BB&#39;</span>, level<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0</span>, axis<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0</span>)
Out[<span style="color:#099">83</span>]: 
 MyData
one      <span style="color:#099">33</span>
two      <span style="color:#099">44</span>
six      <span style="color:#099">55</span>
</code></pre></div><p>…and now the 2nd level of the 1st axis.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">84</span>]: df<span style="color:#000;font-weight:bold">.</span>xs(<span style="color:#d14">&#39;six&#39;</span>, level<span style="color:#000;font-weight:bold">=</span><span style="color:#099">1</span>, axis<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0</span>)
Out[<span style="color:#099">84</span>]: 
 MyData
AA      <span style="color:#099">22</span>
BB      <span style="color:#099">55</span>
</code></pre></div><p><a href="https://stackoverflow.com/questions/14964493/multiindex-based-indexing-in-pandas">Slicing a MultiIndex with xs, method #2</a></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">85</span>]: <span style="color:#000;font-weight:bold">import</span> <span style="color:#555">itertools</span>

In [<span style="color:#099">86</span>]: index <span style="color:#000;font-weight:bold">=</span> <span style="color:#0086b3">list</span>(itertools<span style="color:#000;font-weight:bold">.</span>product([<span style="color:#d14">&#39;Ada&#39;</span>, <span style="color:#d14">&#39;Quinn&#39;</span>, <span style="color:#d14">&#39;Violet&#39;</span>],
 <span style="color:#000;font-weight:bold">....</span>:                               [<span style="color:#d14">&#39;Comp&#39;</span>, <span style="color:#d14">&#39;Math&#39;</span>, <span style="color:#d14">&#39;Sci&#39;</span>]))
 <span style="color:#000;font-weight:bold">....</span>: 

In [<span style="color:#099">87</span>]: headr <span style="color:#000;font-weight:bold">=</span> <span style="color:#0086b3">list</span>(itertools<span style="color:#000;font-weight:bold">.</span>product([<span style="color:#d14">&#39;Exams&#39;</span>, <span style="color:#d14">&#39;Labs&#39;</span>], [<span style="color:#d14">&#39;I&#39;</span>, <span style="color:#d14">&#39;II&#39;</span>]))

In [<span style="color:#099">88</span>]: indx <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>MultiIndex<span style="color:#000;font-weight:bold">.</span>from_tuples(index, names<span style="color:#000;font-weight:bold">=</span>[<span style="color:#d14">&#39;Student&#39;</span>, <span style="color:#d14">&#39;Course&#39;</span>])

In [<span style="color:#099">89</span>]: cols <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>MultiIndex<span style="color:#000;font-weight:bold">.</span>from_tuples(headr)   <span style="color:#998;font-style:italic"># Notice these are un-named</span>

In [<span style="color:#099">90</span>]: data <span style="color:#000;font-weight:bold">=</span> [[<span style="color:#099">70</span> <span style="color:#000;font-weight:bold">+</span> x <span style="color:#000;font-weight:bold">+</span> y <span style="color:#000;font-weight:bold">+</span> (x <span style="color:#000;font-weight:bold">*</span> y) <span style="color:#000;font-weight:bold">%</span> <span style="color:#099">3</span> <span style="color:#000;font-weight:bold">for</span> x <span style="color:#000;font-weight:bold">in</span> <span style="color:#0086b3">range</span>(<span style="color:#099">4</span>)] <span style="color:#000;font-weight:bold">for</span> y <span style="color:#000;font-weight:bold">in</span> <span style="color:#0086b3">range</span>(<span style="color:#099">9</span>)]

In [<span style="color:#099">91</span>]: df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame(data, indx, cols)

In [<span style="color:#099">92</span>]: df
Out[<span style="color:#099">92</span>]: 
 Exams     Labs 
 I  II    I  II
Student Course 
Ada     Comp      <span style="color:#099">70</span>  <span style="color:#099">71</span>   <span style="color:#099">72</span>  <span style="color:#099">73</span>
 Math      <span style="color:#099">71</span>  <span style="color:#099">73</span>   <span style="color:#099">75</span>  <span style="color:#099">74</span>
 Sci       <span style="color:#099">72</span>  <span style="color:#099">75</span>   <span style="color:#099">75</span>  <span style="color:#099">75</span>
Quinn   Comp      <span style="color:#099">73</span>  <span style="color:#099">74</span>   <span style="color:#099">75</span>  <span style="color:#099">76</span>
 Math      <span style="color:#099">74</span>  <span style="color:#099">76</span>   <span style="color:#099">78</span>  <span style="color:#099">77</span>
 Sci       <span style="color:#099">75</span>  <span style="color:#099">78</span>   <span style="color:#099">78</span>  <span style="color:#099">78</span>
Violet  Comp      <span style="color:#099">76</span>  <span style="color:#099">77</span>   <span style="color:#099">78</span>  <span style="color:#099">79</span>
 Math      <span style="color:#099">77</span>  <span style="color:#099">79</span>   <span style="color:#099">81</span>  <span style="color:#099">80</span>
 Sci       <span style="color:#099">78</span>  <span style="color:#099">81</span>   <span style="color:#099">81</span>  <span style="color:#099">81</span>

In [<span style="color:#099">93</span>]: All <span style="color:#000;font-weight:bold">=</span> <span style="color:#0086b3">slice</span>(<span style="color:#999">None</span>)

In [<span style="color:#099">94</span>]: df<span style="color:#000;font-weight:bold">.</span>loc[<span style="color:#d14">&#39;Violet&#39;</span>]
Out[<span style="color:#099">94</span>]: 
 Exams     Labs 
 I  II    I  II
Course 
Comp      <span style="color:#099">76</span>  <span style="color:#099">77</span>   <span style="color:#099">78</span>  <span style="color:#099">79</span>
Math      <span style="color:#099">77</span>  <span style="color:#099">79</span>   <span style="color:#099">81</span>  <span style="color:#099">80</span>
Sci       <span style="color:#099">78</span>  <span style="color:#099">81</span>   <span style="color:#099">81</span>  <span style="color:#099">81</span>

In [<span style="color:#099">95</span>]: df<span style="color:#000;font-weight:bold">.</span>loc[(All, <span style="color:#d14">&#39;Math&#39;</span>), All]
Out[<span style="color:#099">95</span>]: 
 Exams     Labs 
 I  II    I  II
Student Course 
Ada     Math      <span style="color:#099">71</span>  <span style="color:#099">73</span>   <span style="color:#099">75</span>  <span style="color:#099">74</span>
Quinn   Math      <span style="color:#099">74</span>  <span style="color:#099">76</span>   <span style="color:#099">78</span>  <span style="color:#099">77</span>
Violet  Math      <span style="color:#099">77</span>  <span style="color:#099">79</span>   <span style="color:#099">81</span>  <span style="color:#099">80</span>

In [<span style="color:#099">96</span>]: df<span style="color:#000;font-weight:bold">.</span>loc[(<span style="color:#0086b3">slice</span>(<span style="color:#d14">&#39;Ada&#39;</span>, <span style="color:#d14">&#39;Quinn&#39;</span>), <span style="color:#d14">&#39;Math&#39;</span>), All]
Out[<span style="color:#099">96</span>]: 
 Exams     Labs 
 I  II    I  II
Student Course 
Ada     Math      <span style="color:#099">71</span>  <span style="color:#099">73</span>   <span style="color:#099">75</span>  <span style="color:#099">74</span>
Quinn   Math      <span style="color:#099">74</span>  <span style="color:#099">76</span>   <span style="color:#099">78</span>  <span style="color:#099">77</span>

In [<span style="color:#099">97</span>]: df<span style="color:#000;font-weight:bold">.</span>loc[(All, <span style="color:#d14">&#39;Math&#39;</span>), (<span style="color:#d14">&#39;Exams&#39;</span>)]
Out[<span style="color:#099">97</span>]: 
 I  II
Student Course 
Ada     Math    <span style="color:#099">71</span>  <span style="color:#099">73</span>
Quinn   Math    <span style="color:#099">74</span>  <span style="color:#099">76</span>
Violet  Math    <span style="color:#099">77</span>  <span style="color:#099">79</span>

In [<span style="color:#099">98</span>]: df<span style="color:#000;font-weight:bold">.</span>loc[(All, <span style="color:#d14">&#39;Math&#39;</span>), (All, <span style="color:#d14">&#39;II&#39;</span>)]
Out[<span style="color:#099">98</span>]: 
 Exams Labs
 II   II
Student Course 
Ada     Math      <span style="color:#099">73</span>   <span style="color:#099">74</span>
Quinn   Math      <span style="color:#099">76</span>   <span style="color:#099">77</span>
Violet  Math      <span style="color:#099">79</span>   <span style="color:#099">80</span>
</code></pre></div><p><a href="https://stackoverflow.com/questions/19319432/pandas-selecting-a-lower-level-in-a-dataframe-to-do-a-ffill">Setting portions of a MultiIndex with xs</a></p>
<h3 ref="sortinghttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlsorting-permalink-to-this-headline" >Sorting<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#sorting" title="Permalink to this headline"></a></h3><a class="anchor" id="sortinghttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlsorting-permalink-to-this-headline"></a>
<p><a href="https://stackoverflow.com/questions/14733871/mutli-index-sorting-in-pandas">Sort by specific column or an ordered list of columns, with a MultiIndex</a></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">99</span>]: df<span style="color:#000;font-weight:bold">.</span>sort_values(by<span style="color:#000;font-weight:bold">=</span>(<span style="color:#d14">&#39;Labs&#39;</span>, <span style="color:#d14">&#39;II&#39;</span>), ascending<span style="color:#000;font-weight:bold">=</span><span style="color:#999">False</span>)
Out[<span style="color:#099">99</span>]: 
 Exams     Labs 
 I  II    I  II
Student Course 
Violet  Sci       <span style="color:#099">78</span>  <span style="color:#099">81</span>   <span style="color:#099">81</span>  <span style="color:#099">81</span>
 Math      <span style="color:#099">77</span>  <span style="color:#099">79</span>   <span style="color:#099">81</span>  <span style="color:#099">80</span>
 Comp      <span style="color:#099">76</span>  <span style="color:#099">77</span>   <span style="color:#099">78</span>  <span style="color:#099">79</span>
Quinn   Sci       <span style="color:#099">75</span>  <span style="color:#099">78</span>   <span style="color:#099">78</span>  <span style="color:#099">78</span>
 Math      <span style="color:#099">74</span>  <span style="color:#099">76</span>   <span style="color:#099">78</span>  <span style="color:#099">77</span>
 Comp      <span style="color:#099">73</span>  <span style="color:#099">74</span>   <span style="color:#099">75</span>  <span style="color:#099">76</span>
Ada     Sci       <span style="color:#099">72</span>  <span style="color:#099">75</span>   <span style="color:#099">75</span>  <span style="color:#099">75</span>
 Math      <span style="color:#099">71</span>  <span style="color:#099">73</span>   <span style="color:#099">75</span>  <span style="color:#099">74</span>
 Comp      <span style="color:#099">70</span>  <span style="color:#099">71</span>   <span style="color:#099">72</span>  <span style="color:#099">73</span>
</code></pre></div><p><a href="https://github.com/pandas-dev/pandas/issues/2995">Partial selection, the need for sortedness;</a></p>
<h3 ref="levelshttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmllevels-permalink-to-this-headline" >Levels<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#levels" title="Permalink to this headline"></a></h3><a class="anchor" id="levelshttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmllevels-permalink-to-this-headline"></a>
<p><a href="https://stackoverflow.com/questions/14744068/prepend-a-level-to-a-pandas-multiindex">Prepending a level to a multiindex</a></p>
<p><a href="https://stackoverflow.com/questions/14507794/python-pandas-how-to-flatten-a-hierarchical-index-in-columns">Flatten Hierarchical columns</a></p>
<h2 ref="missing-datahttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlmissing-data-permalink-to-this-headline" >Missing data<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#missing-data" title="Permalink to this headline"></a></h2><a class="anchor" id="missing-datahttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlmissing-data-permalink-to-this-headline"></a>
<p>The  <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/missing_data.html#missing-data">missing data</a>  docs.</p>
<p>Fill forward a reversed timeseries</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">100</span>]: df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame(np<span style="color:#000;font-weight:bold">.</span>random<span style="color:#000;font-weight:bold">.</span>randn(<span style="color:#099">6</span>, <span style="color:#099">1</span>),
 <span style="color:#000;font-weight:bold">.....</span>:                  index<span style="color:#000;font-weight:bold">=</span>pd<span style="color:#000;font-weight:bold">.</span>date_range(<span style="color:#d14">&#39;2013-08-01&#39;</span>, periods<span style="color:#000;font-weight:bold">=</span><span style="color:#099">6</span>, freq<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;B&#39;</span>),
 <span style="color:#000;font-weight:bold">.....</span>:                  columns<span style="color:#000;font-weight:bold">=</span><span style="color:#0086b3">list</span>(<span style="color:#d14">&#39;A&#39;</span>))
 <span style="color:#000;font-weight:bold">.....</span>: 

In [<span style="color:#099">101</span>]: df<span style="color:#000;font-weight:bold">.</span>loc[df<span style="color:#000;font-weight:bold">.</span>index[<span style="color:#099">3</span>], <span style="color:#d14">&#39;A&#39;</span>] <span style="color:#000;font-weight:bold">=</span> np<span style="color:#000;font-weight:bold">.</span>nan

In [<span style="color:#099">102</span>]: df
Out[<span style="color:#099">102</span>]: 
 A
<span style="color:#099">2013</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">08</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span>  <span style="color:#099">0.721555</span>
<span style="color:#099">2013</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">08</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">02</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.706771</span>
<span style="color:#099">2013</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">08</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">05</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1.039575</span>
<span style="color:#099">2013</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">08</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">06</span>       NaN
<span style="color:#099">2013</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">08</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">07</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.424972</span>
<span style="color:#099">2013</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">08</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">08</span>  <span style="color:#099">0.567020</span>

In [<span style="color:#099">103</span>]: df<span style="color:#000;font-weight:bold">.</span>reindex(df<span style="color:#000;font-weight:bold">.</span>index[::<span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>])<span style="color:#000;font-weight:bold">.</span>ffill()
Out[<span style="color:#099">103</span>]: 
 A
<span style="color:#099">2013</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">08</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">08</span>  <span style="color:#099">0.567020</span>
<span style="color:#099">2013</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">08</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">07</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.424972</span>
<span style="color:#099">2013</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">08</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">06</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.424972</span>
<span style="color:#099">2013</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">08</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">05</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1.039575</span>
<span style="color:#099">2013</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">08</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">02</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.706771</span>
<span style="color:#099">2013</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">08</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span>  <span style="color:#099">0.721555</span>
</code></pre></div><p><a href="https://stackoverflow.com/questions/18196811/cumsum-reset-at-nan">cumsum reset at NaN values</a></p>
<h3 ref="replacehttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlreplace-permalink-to-this-headline" >Replace<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#replace" title="Permalink to this headline"></a></h3><a class="anchor" id="replacehttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlreplace-permalink-to-this-headline"></a>
<p><a href="https://stackoverflow.com/questions/16818871/extracting-value-and-creating-new-column-out-of-it">Using replace with backrefs</a></p>
<h2 ref="groupinghttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlgrouping-permalink-to-this-headline" >Grouping<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#grouping" title="Permalink to this headline"></a></h2><a class="anchor" id="groupinghttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlgrouping-permalink-to-this-headline"></a>
<p>The  <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/groupby.html#groupby">grouping</a>  docs.</p>
<p><a href="https://stackoverflow.com/questions/15322632/python-pandas-df-groupy-agg-column-reference-in-agg">Basic grouping with apply</a></p>
<p>Unlike agg, apply’s callable is passed a sub-DataFrame which gives you access to all the columns</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">104</span>]: df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame({<span style="color:#d14">&#39;animal&#39;</span>: <span style="color:#d14">&#39;cat dog cat fish dog cat cat&#39;</span><span style="color:#000;font-weight:bold">.</span>split(),
 <span style="color:#000;font-weight:bold">.....</span>:                   <span style="color:#d14">&#39;size&#39;</span>: <span style="color:#0086b3">list</span>(<span style="color:#d14">&#39;SSMMMLL&#39;</span>),
 <span style="color:#000;font-weight:bold">.....</span>:                   <span style="color:#d14">&#39;weight&#39;</span>: [<span style="color:#099">8</span>, <span style="color:#099">10</span>, <span style="color:#099">11</span>, <span style="color:#099">1</span>, <span style="color:#099">20</span>, <span style="color:#099">12</span>, <span style="color:#099">12</span>],
 <span style="color:#000;font-weight:bold">.....</span>:                   <span style="color:#d14">&#39;adult&#39;</span>: [<span style="color:#999">False</span>] <span style="color:#000;font-weight:bold">*</span> <span style="color:#099">5</span> <span style="color:#000;font-weight:bold">+</span> [<span style="color:#999">True</span>] <span style="color:#000;font-weight:bold">*</span> <span style="color:#099">2</span>})
 <span style="color:#000;font-weight:bold">.....</span>: 

In [<span style="color:#099">105</span>]: df
Out[<span style="color:#099">105</span>]: 
 animal size  weight  adult
<span style="color:#099">0</span>    cat    S       <span style="color:#099">8</span>  <span style="color:#999">False</span>
<span style="color:#099">1</span>    dog    S      <span style="color:#099">10</span>  <span style="color:#999">False</span>
<span style="color:#099">2</span>    cat    M      <span style="color:#099">11</span>  <span style="color:#999">False</span>
<span style="color:#099">3</span>   fish    M       <span style="color:#099">1</span>  <span style="color:#999">False</span>
<span style="color:#099">4</span>    dog    M      <span style="color:#099">20</span>  <span style="color:#999">False</span>
<span style="color:#099">5</span>    cat    L      <span style="color:#099">12</span>   <span style="color:#999">True</span>
<span style="color:#099">6</span>    cat    L      <span style="color:#099">12</span>   <span style="color:#999">True</span>

<span style="color:#998;font-style:italic"># List the size of the animals with the highest weight.</span>
In [<span style="color:#099">106</span>]: df<span style="color:#000;font-weight:bold">.</span>groupby(<span style="color:#d14">&#39;animal&#39;</span>)<span style="color:#000;font-weight:bold">.</span>apply(<span style="color:#000;font-weight:bold">lambda</span> subf: subf[<span style="color:#d14">&#39;size&#39;</span>][subf[<span style="color:#d14">&#39;weight&#39;</span>]<span style="color:#000;font-weight:bold">.</span>idxmax()])
Out[<span style="color:#099">106</span>]: 
animal
cat     L
dog     M
fish    M
dtype: <span style="color:#0086b3">object</span>
</code></pre></div><p><a href="https://stackoverflow.com/questions/14734533/how-to-access-pandas-groupby-dataframe-by-key">Using get_group</a></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">107</span>]: gb <span style="color:#000;font-weight:bold">=</span> df<span style="color:#000;font-weight:bold">.</span>groupby([<span style="color:#d14">&#39;animal&#39;</span>])

In [<span style="color:#099">108</span>]: gb<span style="color:#000;font-weight:bold">.</span>get_group(<span style="color:#d14">&#39;cat&#39;</span>)
Out[<span style="color:#099">108</span>]: 
 animal size  weight  adult
<span style="color:#099">0</span>    cat    S       <span style="color:#099">8</span>  <span style="color:#999">False</span>
<span style="color:#099">2</span>    cat    M      <span style="color:#099">11</span>  <span style="color:#999">False</span>
<span style="color:#099">5</span>    cat    L      <span style="color:#099">12</span>   <span style="color:#999">True</span>
<span style="color:#099">6</span>    cat    L      <span style="color:#099">12</span>   <span style="color:#999">True</span>
</code></pre></div><p><a href="https://stackoverflow.com/questions/15262134/apply-different-functions-to-different-items-in-group-object-python-pandas">Apply to different items in a group</a></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">109</span>]: <span style="color:#000;font-weight:bold">def</span> <span style="color:#900;font-weight:bold">GrowUp</span>(x):
 <span style="color:#000;font-weight:bold">.....</span>:    avg_weight <span style="color:#000;font-weight:bold">=</span> <span style="color:#0086b3">sum</span>(x[x[<span style="color:#d14">&#39;size&#39;</span>] <span style="color:#000;font-weight:bold">==</span> <span style="color:#d14">&#39;S&#39;</span>]<span style="color:#000;font-weight:bold">.</span>weight <span style="color:#000;font-weight:bold">*</span> <span style="color:#099">1.5</span>)
 <span style="color:#000;font-weight:bold">.....</span>:    avg_weight <span style="color:#000;font-weight:bold">+=</span> <span style="color:#0086b3">sum</span>(x[x[<span style="color:#d14">&#39;size&#39;</span>] <span style="color:#000;font-weight:bold">==</span> <span style="color:#d14">&#39;M&#39;</span>]<span style="color:#000;font-weight:bold">.</span>weight <span style="color:#000;font-weight:bold">*</span> <span style="color:#099">1.25</span>)
 <span style="color:#000;font-weight:bold">.....</span>:    avg_weight <span style="color:#000;font-weight:bold">+=</span> <span style="color:#0086b3">sum</span>(x[x[<span style="color:#d14">&#39;size&#39;</span>] <span style="color:#000;font-weight:bold">==</span> <span style="color:#d14">&#39;L&#39;</span>]<span style="color:#000;font-weight:bold">.</span>weight)
 <span style="color:#000;font-weight:bold">.....</span>:    avg_weight <span style="color:#000;font-weight:bold">/=</span> <span style="color:#0086b3">len</span>(x)
 <span style="color:#000;font-weight:bold">.....</span>:    <span style="color:#000;font-weight:bold">return</span> pd<span style="color:#000;font-weight:bold">.</span>Series([<span style="color:#d14">&#39;L&#39;</span>, avg_weight, <span style="color:#999">True</span>],
 <span style="color:#000;font-weight:bold">.....</span>:                     index<span style="color:#000;font-weight:bold">=</span>[<span style="color:#d14">&#39;size&#39;</span>, <span style="color:#d14">&#39;weight&#39;</span>, <span style="color:#d14">&#39;adult&#39;</span>])
 <span style="color:#000;font-weight:bold">.....</span>: 

In [<span style="color:#099">110</span>]: expected_df <span style="color:#000;font-weight:bold">=</span> gb<span style="color:#000;font-weight:bold">.</span>apply(GrowUp)

In [<span style="color:#099">111</span>]: expected_df
Out[<span style="color:#099">111</span>]: 
 size   weight  adult
animal 
cat       L  <span style="color:#099">12.4375</span>   <span style="color:#999">True</span>
dog       L  <span style="color:#099">20.0000</span>   <span style="color:#999">True</span>
fish      L   <span style="color:#099">1.2500</span>   <span style="color:#999">True</span>
</code></pre></div><p><a href="https://stackoverflow.com/questions/14542145/reductions-down-a-column-in-pandas">Expanding apply</a></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">112</span>]: S <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>Series([i <span style="color:#000;font-weight:bold">/</span> <span style="color:#099">100.0</span> <span style="color:#000;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#0086b3">range</span>(<span style="color:#099">1</span>, <span style="color:#099">11</span>)])

In [<span style="color:#099">113</span>]: <span style="color:#000;font-weight:bold">def</span> <span style="color:#900;font-weight:bold">cum_ret</span>(x, y):
 <span style="color:#000;font-weight:bold">.....</span>:    <span style="color:#000;font-weight:bold">return</span> x <span style="color:#000;font-weight:bold">*</span> (<span style="color:#099">1</span> <span style="color:#000;font-weight:bold">+</span> y)
 <span style="color:#000;font-weight:bold">.....</span>: 

In [<span style="color:#099">114</span>]: <span style="color:#000;font-weight:bold">def</span> <span style="color:#900;font-weight:bold">red</span>(x):
 <span style="color:#000;font-weight:bold">.....</span>:    <span style="color:#000;font-weight:bold">return</span> functools<span style="color:#000;font-weight:bold">.</span>reduce(cum_ret, x, <span style="color:#099">1.0</span>)
 <span style="color:#000;font-weight:bold">.....</span>: 

In [<span style="color:#099">115</span>]: S<span style="color:#000;font-weight:bold">.</span>expanding()<span style="color:#000;font-weight:bold">.</span>apply(red, raw<span style="color:#000;font-weight:bold">=</span><span style="color:#999">True</span>)
Out[<span style="color:#099">115</span>]: 
<span style="color:#099">0</span>    <span style="color:#099">1.010000</span>
<span style="color:#099">1</span>    <span style="color:#099">1.030200</span>
<span style="color:#099">2</span>    <span style="color:#099">1.061106</span>
<span style="color:#099">3</span>    <span style="color:#099">1.103550</span>
<span style="color:#099">4</span>    <span style="color:#099">1.158728</span>
<span style="color:#099">5</span>    <span style="color:#099">1.228251</span>
<span style="color:#099">6</span>    <span style="color:#099">1.314229</span>
<span style="color:#099">7</span>    <span style="color:#099">1.419367</span>
<span style="color:#099">8</span>    <span style="color:#099">1.547110</span>
<span style="color:#099">9</span>    <span style="color:#099">1.701821</span>
dtype: float64
</code></pre></div><p><a href="https://stackoverflow.com/questions/14760757/replacing-values-with-groupby-means">Replacing some values with mean of the rest of a group</a></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">116</span>]: df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame({<span style="color:#d14">&#39;A&#39;</span>: [<span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">2</span>, <span style="color:#099">2</span>], <span style="color:#d14">&#39;B&#39;</span>: [<span style="color:#099">1</span>, <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">2</span>]})

In [<span style="color:#099">117</span>]: gb <span style="color:#000;font-weight:bold">=</span> df<span style="color:#000;font-weight:bold">.</span>groupby(<span style="color:#d14">&#39;A&#39;</span>)

In [<span style="color:#099">118</span>]: <span style="color:#000;font-weight:bold">def</span> <span style="color:#900;font-weight:bold">replace</span>(g):
 <span style="color:#000;font-weight:bold">.....</span>:    mask <span style="color:#000;font-weight:bold">=</span> g <span style="color:#000;font-weight:bold">&lt;</span> <span style="color:#099">0</span>
 <span style="color:#000;font-weight:bold">.....</span>:    <span style="color:#000;font-weight:bold">return</span> g<span style="color:#000;font-weight:bold">.</span>where(mask, g[<span style="color:#000;font-weight:bold">~</span>mask]<span style="color:#000;font-weight:bold">.</span>mean())
 <span style="color:#000;font-weight:bold">.....</span>: 

In [<span style="color:#099">119</span>]: gb<span style="color:#000;font-weight:bold">.</span>transform(replace)
Out[<span style="color:#099">119</span>]: 
 B
<span style="color:#099">0</span>  <span style="color:#099">1.0</span>
<span style="color:#099">1</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1.0</span>
<span style="color:#099">2</span>  <span style="color:#099">1.5</span>
<span style="color:#099">3</span>  <span style="color:#099">1.5</span>
</code></pre></div><p><a href="https://stackoverflow.com/questions/14941366/pandas-sort-by-group-aggregate-and-column">Sort groups by aggregated data</a></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">120</span>]: df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame({<span style="color:#d14">&#39;code&#39;</span>: [<span style="color:#d14">&#39;foo&#39;</span>, <span style="color:#d14">&#39;bar&#39;</span>, <span style="color:#d14">&#39;baz&#39;</span>] <span style="color:#000;font-weight:bold">*</span> <span style="color:#099">2</span>,
 <span style="color:#000;font-weight:bold">.....</span>:                   <span style="color:#d14">&#39;data&#39;</span>: [<span style="color:#099">0.16</span>, <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.21</span>, <span style="color:#099">0.33</span>, <span style="color:#099">0.45</span>, <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.59</span>, <span style="color:#099">0.62</span>],
 <span style="color:#000;font-weight:bold">.....</span>:                   <span style="color:#d14">&#39;flag&#39;</span>: [<span style="color:#999">False</span>, <span style="color:#999">True</span>] <span style="color:#000;font-weight:bold">*</span> <span style="color:#099">3</span>})
 <span style="color:#000;font-weight:bold">.....</span>: 

In [<span style="color:#099">121</span>]: code_groups <span style="color:#000;font-weight:bold">=</span> df<span style="color:#000;font-weight:bold">.</span>groupby(<span style="color:#d14">&#39;code&#39;</span>)

In [<span style="color:#099">122</span>]: agg_n_sort_order <span style="color:#000;font-weight:bold">=</span> code_groups[[<span style="color:#d14">&#39;data&#39;</span>]]<span style="color:#000;font-weight:bold">.</span>transform(<span style="color:#0086b3">sum</span>)<span style="color:#000;font-weight:bold">.</span>sort_values(by<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;data&#39;</span>)

In [<span style="color:#099">123</span>]: sorted_df <span style="color:#000;font-weight:bold">=</span> df<span style="color:#000;font-weight:bold">.</span>loc[agg_n_sort_order<span style="color:#000;font-weight:bold">.</span>index]

In [<span style="color:#099">124</span>]: sorted_df
Out[<span style="color:#099">124</span>]: 
 code  data   flag
<span style="color:#099">1</span>  bar <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.21</span>   <span style="color:#999">True</span>
<span style="color:#099">4</span>  bar <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.59</span>  <span style="color:#999">False</span>
<span style="color:#099">0</span>  foo  <span style="color:#099">0.16</span>  <span style="color:#999">False</span>
<span style="color:#099">3</span>  foo  <span style="color:#099">0.45</span>   <span style="color:#999">True</span>
<span style="color:#099">2</span>  baz  <span style="color:#099">0.33</span>  <span style="color:#999">False</span>
<span style="color:#099">5</span>  baz  <span style="color:#099">0.62</span>   <span style="color:#999">True</span>
</code></pre></div><p><a href="https://stackoverflow.com/questions/14897100/create-multiple-columns-in-pandas-aggregation-function">Create multiple aggregated columns</a></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">125</span>]: rng <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>date_range(start<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;2014-10-07&#34;</span>, periods<span style="color:#000;font-weight:bold">=</span><span style="color:#099">10</span>, freq<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;2min&#39;</span>)

In [<span style="color:#099">126</span>]: ts <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>Series(data<span style="color:#000;font-weight:bold">=</span><span style="color:#0086b3">list</span>(<span style="color:#0086b3">range</span>(<span style="color:#099">10</span>)), index<span style="color:#000;font-weight:bold">=</span>rng)

In [<span style="color:#099">127</span>]: <span style="color:#000;font-weight:bold">def</span> <span style="color:#900;font-weight:bold">MyCust</span>(x):
 <span style="color:#000;font-weight:bold">.....</span>:    <span style="color:#000;font-weight:bold">if</span> <span style="color:#0086b3">len</span>(x) <span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#099">2</span>:
 <span style="color:#000;font-weight:bold">.....</span>:        <span style="color:#000;font-weight:bold">return</span> x[<span style="color:#099">1</span>] <span style="color:#000;font-weight:bold">*</span> <span style="color:#099">1.234</span>
 <span style="color:#000;font-weight:bold">.....</span>:    <span style="color:#000;font-weight:bold">return</span> pd<span style="color:#000;font-weight:bold">.</span>NaT
 <span style="color:#000;font-weight:bold">.....</span>: 

In [<span style="color:#099">128</span>]: mhc <span style="color:#000;font-weight:bold">=</span> {<span style="color:#d14">&#39;Mean&#39;</span>: np<span style="color:#000;font-weight:bold">.</span>mean, <span style="color:#d14">&#39;Max&#39;</span>: np<span style="color:#000;font-weight:bold">.</span>max, <span style="color:#d14">&#39;Custom&#39;</span>: MyCust}

In [<span style="color:#099">129</span>]: ts<span style="color:#000;font-weight:bold">.</span>resample(<span style="color:#d14">&#34;5min&#34;</span>)<span style="color:#000;font-weight:bold">.</span>apply(mhc)
Out[<span style="color:#099">129</span>]: 
Mean    <span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">10</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">07</span> <span style="color:#099">00</span>:<span style="color:#099">00</span>:<span style="color:#099">00</span>        <span style="color:#099">1</span>
 <span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">10</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">07</span> <span style="color:#099">00</span>:<span style="color:#099">05</span>:<span style="color:#099">00</span>      <span style="color:#099">3.5</span>
 <span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">10</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">07</span> <span style="color:#099">00</span>:<span style="color:#099">10</span>:<span style="color:#099">00</span>        <span style="color:#099">6</span>
 <span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">10</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">07</span> <span style="color:#099">00</span>:<span style="color:#099">15</span>:<span style="color:#099">00</span>      <span style="color:#099">8.5</span>
Max     <span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">10</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">07</span> <span style="color:#099">00</span>:<span style="color:#099">00</span>:<span style="color:#099">00</span>        <span style="color:#099">2</span>
 <span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">10</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">07</span> <span style="color:#099">00</span>:<span style="color:#099">05</span>:<span style="color:#099">00</span>        <span style="color:#099">4</span>
 <span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">10</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">07</span> <span style="color:#099">00</span>:<span style="color:#099">10</span>:<span style="color:#099">00</span>        <span style="color:#099">7</span>
 <span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">10</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">07</span> <span style="color:#099">00</span>:<span style="color:#099">15</span>:<span style="color:#099">00</span>        <span style="color:#099">9</span>
Custom  <span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">10</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">07</span> <span style="color:#099">00</span>:<span style="color:#099">00</span>:<span style="color:#099">00</span>    <span style="color:#099">1.234</span>
 <span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">10</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">07</span> <span style="color:#099">00</span>:<span style="color:#099">05</span>:<span style="color:#099">00</span>      NaT
 <span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">10</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">07</span> <span style="color:#099">00</span>:<span style="color:#099">10</span>:<span style="color:#099">00</span>    <span style="color:#099">7.404</span>
 <span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">10</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">07</span> <span style="color:#099">00</span>:<span style="color:#099">15</span>:<span style="color:#099">00</span>      NaT
dtype: <span style="color:#0086b3">object</span>

In [<span style="color:#099">130</span>]: ts
Out[<span style="color:#099">130</span>]: 
<span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">10</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">07</span> <span style="color:#099">00</span>:<span style="color:#099">00</span>:<span style="color:#099">00</span>    <span style="color:#099">0</span>
<span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">10</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">07</span> <span style="color:#099">00</span>:<span style="color:#099">02</span>:<span style="color:#099">00</span>    <span style="color:#099">1</span>
<span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">10</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">07</span> <span style="color:#099">00</span>:<span style="color:#099">04</span>:<span style="color:#099">00</span>    <span style="color:#099">2</span>
<span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">10</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">07</span> <span style="color:#099">00</span>:<span style="color:#099">06</span>:<span style="color:#099">00</span>    <span style="color:#099">3</span>
<span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">10</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">07</span> <span style="color:#099">00</span>:<span style="color:#099">08</span>:<span style="color:#099">00</span>    <span style="color:#099">4</span>
<span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">10</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">07</span> <span style="color:#099">00</span>:<span style="color:#099">10</span>:<span style="color:#099">00</span>    <span style="color:#099">5</span>
<span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">10</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">07</span> <span style="color:#099">00</span>:<span style="color:#099">12</span>:<span style="color:#099">00</span>    <span style="color:#099">6</span>
<span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">10</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">07</span> <span style="color:#099">00</span>:<span style="color:#099">14</span>:<span style="color:#099">00</span>    <span style="color:#099">7</span>
<span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">10</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">07</span> <span style="color:#099">00</span>:<span style="color:#099">16</span>:<span style="color:#099">00</span>    <span style="color:#099">8</span>
<span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">10</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">07</span> <span style="color:#099">00</span>:<span style="color:#099">18</span>:<span style="color:#099">00</span>    <span style="color:#099">9</span>
Freq: <span style="color:#099">2</span>T, dtype: int64
</code></pre></div><p><a href="https://stackoverflow.com/questions/17709270/i-want-to-create-a-column-of-value-counts-in-my-pandas-dataframe">Create a value counts column and reassign back to the DataFrame</a></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">131</span>]: df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame({<span style="color:#d14">&#39;Color&#39;</span>: <span style="color:#d14">&#39;Red Red Red Blue&#39;</span><span style="color:#000;font-weight:bold">.</span>split(),
 <span style="color:#000;font-weight:bold">.....</span>:                   <span style="color:#d14">&#39;Value&#39;</span>: [<span style="color:#099">100</span>, <span style="color:#099">150</span>, <span style="color:#099">50</span>, <span style="color:#099">50</span>]})
 <span style="color:#000;font-weight:bold">.....</span>: 

In [<span style="color:#099">132</span>]: df
Out[<span style="color:#099">132</span>]: 
 Color  Value
<span style="color:#099">0</span>   Red    <span style="color:#099">100</span>
<span style="color:#099">1</span>   Red    <span style="color:#099">150</span>
<span style="color:#099">2</span>   Red     <span style="color:#099">50</span>
<span style="color:#099">3</span>  Blue     <span style="color:#099">50</span>

In [<span style="color:#099">133</span>]: df[<span style="color:#d14">&#39;Counts&#39;</span>] <span style="color:#000;font-weight:bold">=</span> df<span style="color:#000;font-weight:bold">.</span>groupby([<span style="color:#d14">&#39;Color&#39;</span>])<span style="color:#000;font-weight:bold">.</span>transform(<span style="color:#0086b3">len</span>)

In [<span style="color:#099">134</span>]: df
Out[<span style="color:#099">134</span>]: 
 Color  Value  Counts
<span style="color:#099">0</span>   Red    <span style="color:#099">100</span>       <span style="color:#099">3</span>
<span style="color:#099">1</span>   Red    <span style="color:#099">150</span>       <span style="color:#099">3</span>
<span style="color:#099">2</span>   Red     <span style="color:#099">50</span>       <span style="color:#099">3</span>
<span style="color:#099">3</span>  Blue     <span style="color:#099">50</span>       <span style="color:#099">1</span>
</code></pre></div><p><a href="https://stackoverflow.com/q/23198053/190597">Shift groups of the values in a column based on the index</a></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">135</span>]: df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame({<span style="color:#d14">&#39;line_race&#39;</span>: [<span style="color:#099">10</span>, <span style="color:#099">10</span>, <span style="color:#099">8</span>, <span style="color:#099">10</span>, <span style="color:#099">10</span>, <span style="color:#099">8</span>],
 <span style="color:#000;font-weight:bold">.....</span>:                   <span style="color:#d14">&#39;beyer&#39;</span>: [<span style="color:#099">99</span>, <span style="color:#099">102</span>, <span style="color:#099">103</span>, <span style="color:#099">103</span>, <span style="color:#099">88</span>, <span style="color:#099">100</span>]},
 <span style="color:#000;font-weight:bold">.....</span>:                  index<span style="color:#000;font-weight:bold">=</span>[<span style="color:#d14">&#39;Last Gunfighter&#39;</span>, <span style="color:#d14">&#39;Last Gunfighter&#39;</span>,
 <span style="color:#000;font-weight:bold">.....</span>:                         <span style="color:#d14">&#39;Last Gunfighter&#39;</span>, <span style="color:#d14">&#39;Paynter&#39;</span>, <span style="color:#d14">&#39;Paynter&#39;</span>,
 <span style="color:#000;font-weight:bold">.....</span>:                         <span style="color:#d14">&#39;Paynter&#39;</span>])
 <span style="color:#000;font-weight:bold">.....</span>: 

In [<span style="color:#099">136</span>]: df
Out[<span style="color:#099">136</span>]: 
 line_race  beyer
Last Gunfighter         <span style="color:#099">10</span>     <span style="color:#099">99</span>
Last Gunfighter         <span style="color:#099">10</span>    <span style="color:#099">102</span>
Last Gunfighter          <span style="color:#099">8</span>    <span style="color:#099">103</span>
Paynter                 <span style="color:#099">10</span>    <span style="color:#099">103</span>
Paynter                 <span style="color:#099">10</span>     <span style="color:#099">88</span>
Paynter                  <span style="color:#099">8</span>    <span style="color:#099">100</span>

In [<span style="color:#099">137</span>]: df[<span style="color:#d14">&#39;beyer_shifted&#39;</span>] <span style="color:#000;font-weight:bold">=</span> df<span style="color:#000;font-weight:bold">.</span>groupby(level<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0</span>)[<span style="color:#d14">&#39;beyer&#39;</span>]<span style="color:#000;font-weight:bold">.</span>shift(<span style="color:#099">1</span>)

In [<span style="color:#099">138</span>]: df
Out[<span style="color:#099">138</span>]: 
 line_race  beyer  beyer_shifted
Last Gunfighter         <span style="color:#099">10</span>     <span style="color:#099">99</span>            NaN
Last Gunfighter         <span style="color:#099">10</span>    <span style="color:#099">102</span>           <span style="color:#099">99.0</span>
Last Gunfighter          <span style="color:#099">8</span>    <span style="color:#099">103</span>          <span style="color:#099">102.0</span>
Paynter                 <span style="color:#099">10</span>    <span style="color:#099">103</span>            NaN
Paynter                 <span style="color:#099">10</span>     <span style="color:#099">88</span>          <span style="color:#099">103.0</span>
Paynter                  <span style="color:#099">8</span>    <span style="color:#099">100</span>           <span style="color:#099">88.0</span>
</code></pre></div><p><a href="https://stackoverflow.com/q/26701849/190597">Select row with maximum value from each group</a></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">139</span>]: df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame({<span style="color:#d14">&#39;host&#39;</span>: [<span style="color:#d14">&#39;other&#39;</span>, <span style="color:#d14">&#39;other&#39;</span>, <span style="color:#d14">&#39;that&#39;</span>, <span style="color:#d14">&#39;this&#39;</span>, <span style="color:#d14">&#39;this&#39;</span>],
 <span style="color:#000;font-weight:bold">.....</span>:                   <span style="color:#d14">&#39;service&#39;</span>: [<span style="color:#d14">&#39;mail&#39;</span>, <span style="color:#d14">&#39;web&#39;</span>, <span style="color:#d14">&#39;mail&#39;</span>, <span style="color:#d14">&#39;mail&#39;</span>, <span style="color:#d14">&#39;web&#39;</span>],
 <span style="color:#000;font-weight:bold">.....</span>:                   <span style="color:#d14">&#39;no&#39;</span>: [<span style="color:#099">1</span>, <span style="color:#099">2</span>, <span style="color:#099">1</span>, <span style="color:#099">2</span>, <span style="color:#099">1</span>]})<span style="color:#000;font-weight:bold">.</span>set_index([<span style="color:#d14">&#39;host&#39;</span>, <span style="color:#d14">&#39;service&#39;</span>])
 <span style="color:#000;font-weight:bold">.....</span>: 

In [<span style="color:#099">140</span>]: mask <span style="color:#000;font-weight:bold">=</span> df<span style="color:#000;font-weight:bold">.</span>groupby(level<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0</span>)<span style="color:#000;font-weight:bold">.</span>agg(<span style="color:#d14">&#39;idxmax&#39;</span>)

In [<span style="color:#099">141</span>]: df_count <span style="color:#000;font-weight:bold">=</span> df<span style="color:#000;font-weight:bold">.</span>loc[mask[<span style="color:#d14">&#39;no&#39;</span>]]<span style="color:#000;font-weight:bold">.</span>reset_index()

In [<span style="color:#099">142</span>]: df_count
Out[<span style="color:#099">142</span>]: 
 host service  no
<span style="color:#099">0</span>  other     web   <span style="color:#099">2</span>
<span style="color:#099">1</span>   that    mail   <span style="color:#099">1</span>
<span style="color:#099">2</span>   this    mail   <span style="color:#099">2</span>
</code></pre></div><p><a href="https://stackoverflow.com/q/29142487/846892">Grouping like Python’s itertools.groupby</a></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">143</span>]: df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame([<span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>], columns<span style="color:#000;font-weight:bold">=</span>[<span style="color:#d14">&#39;A&#39;</span>])

In [<span style="color:#099">144</span>]: df[<span style="color:#d14">&#39;A&#39;</span>]<span style="color:#000;font-weight:bold">.</span>groupby((df[<span style="color:#d14">&#39;A&#39;</span>] <span style="color:#000;font-weight:bold">!=</span> df[<span style="color:#d14">&#39;A&#39;</span>]<span style="color:#000;font-weight:bold">.</span>shift())<span style="color:#000;font-weight:bold">.</span>cumsum())<span style="color:#000;font-weight:bold">.</span>groups
Out[<span style="color:#099">144</span>]: {<span style="color:#099">1</span>: [<span style="color:#099">0</span>], <span style="color:#099">2</span>: [<span style="color:#099">1</span>], <span style="color:#099">3</span>: [<span style="color:#099">2</span>], <span style="color:#099">4</span>: [<span style="color:#099">3</span>, <span style="color:#099">4</span>, <span style="color:#099">5</span>], <span style="color:#099">5</span>: [<span style="color:#099">6</span>], <span style="color:#099">6</span>: [<span style="color:#099">7</span>, <span style="color:#099">8</span>]}

In [<span style="color:#099">145</span>]: df[<span style="color:#d14">&#39;A&#39;</span>]<span style="color:#000;font-weight:bold">.</span>groupby((df[<span style="color:#d14">&#39;A&#39;</span>] <span style="color:#000;font-weight:bold">!=</span> df[<span style="color:#d14">&#39;A&#39;</span>]<span style="color:#000;font-weight:bold">.</span>shift())<span style="color:#000;font-weight:bold">.</span>cumsum())<span style="color:#000;font-weight:bold">.</span>cumsum()
Out[<span style="color:#099">145</span>]: 
<span style="color:#099">0</span>    <span style="color:#099">0</span>
<span style="color:#099">1</span>    <span style="color:#099">1</span>
<span style="color:#099">2</span>    <span style="color:#099">0</span>
<span style="color:#099">3</span>    <span style="color:#099">1</span>
<span style="color:#099">4</span>    <span style="color:#099">2</span>
<span style="color:#099">5</span>    <span style="color:#099">3</span>
<span style="color:#099">6</span>    <span style="color:#099">0</span>
<span style="color:#099">7</span>    <span style="color:#099">1</span>
<span style="color:#099">8</span>    <span style="color:#099">2</span>
Name: A, dtype: int64
</code></pre></div><h3 ref="expanding-datahttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlexpanding-data-permalink-to-this-headline" >Expanding data<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#expanding-data" title="Permalink to this headline"></a></h3><a class="anchor" id="expanding-datahttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlexpanding-data-permalink-to-this-headline"></a>
<p><a href="https://stackoverflow.com/questions/15489011/python-time-series-alignment-and-to-date-functions">Alignment and to-date</a></p>
<p><a href="https://stackoverflow.com/questions/14300768/pandas-rolling-computation-with-window-based-on-values-instead-of-counts">Rolling Computation window based on values instead of counts</a></p>
<p><a href="https://stackoverflow.com/questions/15771472/pandas-rolling-mean-by-time-interval">Rolling Mean by Time Interval</a></p>
<h3 ref="splittinghttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlid2-permalink-to-this-headline" >Splitting<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#id2" title="Permalink to this headline"></a></h3><a class="anchor" id="splittinghttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlid2-permalink-to-this-headline"></a>
<p><a href="https://stackoverflow.com/questions/13353233/best-way-to-split-a-dataframe-given-an-edge/15449992#15449992">Splitting a frame</a></p>
<p>Create a list of dataframes, split using a delineation based on logic included in rows.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">146</span>]: df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame(data<span style="color:#000;font-weight:bold">=</span>{<span style="color:#d14">&#39;Case&#39;</span>: [<span style="color:#d14">&#39;A&#39;</span>, <span style="color:#d14">&#39;A&#39;</span>, <span style="color:#d14">&#39;A&#39;</span>, <span style="color:#d14">&#39;B&#39;</span>, <span style="color:#d14">&#39;A&#39;</span>, <span style="color:#d14">&#39;A&#39;</span>, <span style="color:#d14">&#39;B&#39;</span>, <span style="color:#d14">&#39;A&#39;</span>,
 <span style="color:#000;font-weight:bold">.....</span>:                                 <span style="color:#d14">&#39;A&#39;</span>],
 <span style="color:#000;font-weight:bold">.....</span>:                        <span style="color:#d14">&#39;Data&#39;</span>: np<span style="color:#000;font-weight:bold">.</span>random<span style="color:#000;font-weight:bold">.</span>randn(<span style="color:#099">9</span>)})
 <span style="color:#000;font-weight:bold">.....</span>: 

In [<span style="color:#099">147</span>]: dfs <span style="color:#000;font-weight:bold">=</span> <span style="color:#0086b3">list</span>(<span style="color:#0086b3">zip</span>(<span style="color:#000;font-weight:bold">*</span>df<span style="color:#000;font-weight:bold">.</span>groupby((<span style="color:#099">1</span> <span style="color:#000;font-weight:bold">*</span> (df[<span style="color:#d14">&#39;Case&#39;</span>] <span style="color:#000;font-weight:bold">==</span> <span style="color:#d14">&#39;B&#39;</span>))<span style="color:#000;font-weight:bold">.</span>cumsum()
 <span style="color:#000;font-weight:bold">.....</span>:               <span style="color:#000;font-weight:bold">.</span>rolling(window<span style="color:#000;font-weight:bold">=</span><span style="color:#099">3</span>, min_periods<span style="color:#000;font-weight:bold">=</span><span style="color:#099">1</span>)<span style="color:#000;font-weight:bold">.</span>median())))[<span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>]
 <span style="color:#000;font-weight:bold">.....</span>: 

In [<span style="color:#099">148</span>]: dfs[<span style="color:#099">0</span>]
Out[<span style="color:#099">148</span>]: 
 Case      Data
<span style="color:#099">0</span>    A  <span style="color:#099">0.276232</span>
<span style="color:#099">1</span>    A <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1.087401</span>
<span style="color:#099">2</span>    A <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.673690</span>
<span style="color:#099">3</span>    B  <span style="color:#099">0.113648</span>

In [<span style="color:#099">149</span>]: dfs[<span style="color:#099">1</span>]
Out[<span style="color:#099">149</span>]: 
 Case      Data
<span style="color:#099">4</span>    A <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1.478427</span>
<span style="color:#099">5</span>    A  <span style="color:#099">0.524988</span>
<span style="color:#099">6</span>    B  <span style="color:#099">0.404705</span>

In [<span style="color:#099">150</span>]: dfs[<span style="color:#099">2</span>]
Out[<span style="color:#099">150</span>]: 
 Case      Data
<span style="color:#099">7</span>    A  <span style="color:#099">0.577046</span>
<span style="color:#099">8</span>    A <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1.715002</span>
</code></pre></div><h3 ref="pivothttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlpivot-permalink-to-this-headline" >Pivot<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#pivot" title="Permalink to this headline"></a></h3><a class="anchor" id="pivothttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlpivot-permalink-to-this-headline"></a>
<p>The  <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/reshaping.html#reshaping-pivot">Pivot</a>  docs.</p>
<p><a href="https://stackoverflow.com/questions/15570099/pandas-pivot-tables-row-subtotals/15574875#15574875">Partial sums and subtotals</a></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">151</span>]: df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame(data<span style="color:#000;font-weight:bold">=</span>{<span style="color:#d14">&#39;Province&#39;</span>: [<span style="color:#d14">&#39;ON&#39;</span>, <span style="color:#d14">&#39;QC&#39;</span>, <span style="color:#d14">&#39;BC&#39;</span>, <span style="color:#d14">&#39;AL&#39;</span>, <span style="color:#d14">&#39;AL&#39;</span>, <span style="color:#d14">&#39;MN&#39;</span>, <span style="color:#d14">&#39;ON&#39;</span>],
 <span style="color:#000;font-weight:bold">.....</span>:                        <span style="color:#d14">&#39;City&#39;</span>: [<span style="color:#d14">&#39;Toronto&#39;</span>, <span style="color:#d14">&#39;Montreal&#39;</span>, <span style="color:#d14">&#39;Vancouver&#39;</span>,
 <span style="color:#000;font-weight:bold">.....</span>:                                 <span style="color:#d14">&#39;Calgary&#39;</span>, <span style="color:#d14">&#39;Edmonton&#39;</span>, <span style="color:#d14">&#39;Winnipeg&#39;</span>,
 <span style="color:#000;font-weight:bold">.....</span>:                                 <span style="color:#d14">&#39;Windsor&#39;</span>],
 <span style="color:#000;font-weight:bold">.....</span>:                        <span style="color:#d14">&#39;Sales&#39;</span>: [<span style="color:#099">13</span>, <span style="color:#099">6</span>, <span style="color:#099">16</span>, <span style="color:#099">8</span>, <span style="color:#099">4</span>, <span style="color:#099">3</span>, <span style="color:#099">1</span>]})
 <span style="color:#000;font-weight:bold">.....</span>: 

In [<span style="color:#099">152</span>]: table <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>pivot_table(df, values<span style="color:#000;font-weight:bold">=</span>[<span style="color:#d14">&#39;Sales&#39;</span>], index<span style="color:#000;font-weight:bold">=</span>[<span style="color:#d14">&#39;Province&#39;</span>],
 <span style="color:#000;font-weight:bold">.....</span>:                       columns<span style="color:#000;font-weight:bold">=</span>[<span style="color:#d14">&#39;City&#39;</span>], aggfunc<span style="color:#000;font-weight:bold">=</span>np<span style="color:#000;font-weight:bold">.</span>sum, margins<span style="color:#000;font-weight:bold">=</span><span style="color:#999">True</span>)
 <span style="color:#000;font-weight:bold">.....</span>: 

In [<span style="color:#099">153</span>]: table<span style="color:#000;font-weight:bold">.</span>stack(<span style="color:#d14">&#39;City&#39;</span>)
Out[<span style="color:#099">153</span>]: 
 Sales
Province City 
AL       All         <span style="color:#099">12.0</span>
 Calgary      <span style="color:#099">8.0</span>
 Edmonton     <span style="color:#099">4.0</span>
BC       All         <span style="color:#099">16.0</span>
 Vancouver   <span style="color:#099">16.0</span>
<span style="color:#000;font-weight:bold">...</span>                   <span style="color:#000;font-weight:bold">...</span>
All      Montreal     <span style="color:#099">6.0</span>
 Toronto     <span style="color:#099">13.0</span>
 Vancouver   <span style="color:#099">16.0</span>
 Windsor      <span style="color:#099">1.0</span>
 Winnipeg     <span style="color:#099">3.0</span>

[<span style="color:#099">20</span> rows x <span style="color:#099">1</span> columns]
</code></pre></div><p><a href="https://stackoverflow.com/questions/15589354/frequency-tables-in-pandas-like-plyr-in-r">Frequency table like plyr in R</a></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">154</span>]: grades <span style="color:#000;font-weight:bold">=</span> [<span style="color:#099">48</span>, <span style="color:#099">99</span>, <span style="color:#099">75</span>, <span style="color:#099">80</span>, <span style="color:#099">42</span>, <span style="color:#099">80</span>, <span style="color:#099">72</span>, <span style="color:#099">68</span>, <span style="color:#099">36</span>, <span style="color:#099">78</span>]

In [<span style="color:#099">155</span>]: df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame({<span style="color:#d14">&#39;ID&#39;</span>: [<span style="color:#d14">&#34;x</span><span style="color:#d14">%d</span><span style="color:#d14">&#34;</span> <span style="color:#000;font-weight:bold">%</span> r <span style="color:#000;font-weight:bold">for</span> r <span style="color:#000;font-weight:bold">in</span> <span style="color:#0086b3">range</span>(<span style="color:#099">10</span>)],
 <span style="color:#000;font-weight:bold">.....</span>:                   <span style="color:#d14">&#39;Gender&#39;</span>: [<span style="color:#d14">&#39;F&#39;</span>, <span style="color:#d14">&#39;M&#39;</span>, <span style="color:#d14">&#39;F&#39;</span>, <span style="color:#d14">&#39;M&#39;</span>, <span style="color:#d14">&#39;F&#39;</span>,
 <span style="color:#000;font-weight:bold">.....</span>:                              <span style="color:#d14">&#39;M&#39;</span>, <span style="color:#d14">&#39;F&#39;</span>, <span style="color:#d14">&#39;M&#39;</span>, <span style="color:#d14">&#39;M&#39;</span>, <span style="color:#d14">&#39;M&#39;</span>],
 <span style="color:#000;font-weight:bold">.....</span>:                   <span style="color:#d14">&#39;ExamYear&#39;</span>: [<span style="color:#d14">&#39;2007&#39;</span>, <span style="color:#d14">&#39;2007&#39;</span>, <span style="color:#d14">&#39;2007&#39;</span>, <span style="color:#d14">&#39;2008&#39;</span>, <span style="color:#d14">&#39;2008&#39;</span>,
 <span style="color:#000;font-weight:bold">.....</span>:                                <span style="color:#d14">&#39;2008&#39;</span>, <span style="color:#d14">&#39;2008&#39;</span>, <span style="color:#d14">&#39;2009&#39;</span>, <span style="color:#d14">&#39;2009&#39;</span>, <span style="color:#d14">&#39;2009&#39;</span>],
 <span style="color:#000;font-weight:bold">.....</span>:                   <span style="color:#d14">&#39;Class&#39;</span>: [<span style="color:#d14">&#39;algebra&#39;</span>, <span style="color:#d14">&#39;stats&#39;</span>, <span style="color:#d14">&#39;bio&#39;</span>, <span style="color:#d14">&#39;algebra&#39;</span>,
 <span style="color:#000;font-weight:bold">.....</span>:                             <span style="color:#d14">&#39;algebra&#39;</span>, <span style="color:#d14">&#39;stats&#39;</span>, <span style="color:#d14">&#39;stats&#39;</span>, <span style="color:#d14">&#39;algebra&#39;</span>,
 <span style="color:#000;font-weight:bold">.....</span>:                             <span style="color:#d14">&#39;bio&#39;</span>, <span style="color:#d14">&#39;bio&#39;</span>],
 <span style="color:#000;font-weight:bold">.....</span>:                   <span style="color:#d14">&#39;Participated&#39;</span>: [<span style="color:#d14">&#39;yes&#39;</span>, <span style="color:#d14">&#39;yes&#39;</span>, <span style="color:#d14">&#39;yes&#39;</span>, <span style="color:#d14">&#39;yes&#39;</span>, <span style="color:#d14">&#39;no&#39;</span>,
 <span style="color:#000;font-weight:bold">.....</span>:                                    <span style="color:#d14">&#39;yes&#39;</span>, <span style="color:#d14">&#39;yes&#39;</span>, <span style="color:#d14">&#39;yes&#39;</span>, <span style="color:#d14">&#39;yes&#39;</span>, <span style="color:#d14">&#39;yes&#39;</span>],
 <span style="color:#000;font-weight:bold">.....</span>:                   <span style="color:#d14">&#39;Passed&#39;</span>: [<span style="color:#d14">&#39;yes&#39;</span> <span style="color:#000;font-weight:bold">if</span> x <span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#099">50</span> <span style="color:#000;font-weight:bold">else</span> <span style="color:#d14">&#39;no&#39;</span> <span style="color:#000;font-weight:bold">for</span> x <span style="color:#000;font-weight:bold">in</span> grades],
 <span style="color:#000;font-weight:bold">.....</span>:                   <span style="color:#d14">&#39;Employed&#39;</span>: [<span style="color:#999">True</span>, <span style="color:#999">True</span>, <span style="color:#999">True</span>, <span style="color:#999">False</span>,
 <span style="color:#000;font-weight:bold">.....</span>:                                <span style="color:#999">False</span>, <span style="color:#999">False</span>, <span style="color:#999">False</span>, <span style="color:#999">True</span>, <span style="color:#999">True</span>, <span style="color:#999">False</span>],
 <span style="color:#000;font-weight:bold">.....</span>:                   <span style="color:#d14">&#39;Grade&#39;</span>: grades})
 <span style="color:#000;font-weight:bold">.....</span>: 

In [<span style="color:#099">156</span>]: df<span style="color:#000;font-weight:bold">.</span>groupby(<span style="color:#d14">&#39;ExamYear&#39;</span>)<span style="color:#000;font-weight:bold">.</span>agg({<span style="color:#d14">&#39;Participated&#39;</span>: <span style="color:#000;font-weight:bold">lambda</span> x: x<span style="color:#000;font-weight:bold">.</span>value_counts()[<span style="color:#d14">&#39;yes&#39;</span>],
 <span style="color:#000;font-weight:bold">.....</span>:                            <span style="color:#d14">&#39;Passed&#39;</span>: <span style="color:#000;font-weight:bold">lambda</span> x: <span style="color:#0086b3">sum</span>(x <span style="color:#000;font-weight:bold">==</span> <span style="color:#d14">&#39;yes&#39;</span>),
 <span style="color:#000;font-weight:bold">.....</span>:                            <span style="color:#d14">&#39;Employed&#39;</span>: <span style="color:#000;font-weight:bold">lambda</span> x: <span style="color:#0086b3">sum</span>(x),
 <span style="color:#000;font-weight:bold">.....</span>:                            <span style="color:#d14">&#39;Grade&#39;</span>: <span style="color:#000;font-weight:bold">lambda</span> x: <span style="color:#0086b3">sum</span>(x) <span style="color:#000;font-weight:bold">/</span> <span style="color:#0086b3">len</span>(x)})
 <span style="color:#000;font-weight:bold">.....</span>: 
Out[<span style="color:#099">156</span>]: 
 Participated  Passed  Employed      Grade
ExamYear 
<span style="color:#099">2007</span>                 <span style="color:#099">3</span>       <span style="color:#099">2</span>         <span style="color:#099">3</span>  <span style="color:#099">74.000000</span>
<span style="color:#099">2008</span>                 <span style="color:#099">3</span>       <span style="color:#099">3</span>         <span style="color:#099">0</span>  <span style="color:#099">68.500000</span>
<span style="color:#099">2009</span>                 <span style="color:#099">3</span>       <span style="color:#099">2</span>         <span style="color:#099">2</span>  <span style="color:#099">60.666667</span>
</code></pre></div><p><a href="https://stackoverflow.com/questions/30379789/plot-pandas-data-frame-with-year-over-year-data">Plot pandas DataFrame with year over year data</a></p>
<p>To create year and month cross tabulation:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">157</span>]: df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame({<span style="color:#d14">&#39;value&#39;</span>: np<span style="color:#000;font-weight:bold">.</span>random<span style="color:#000;font-weight:bold">.</span>randn(<span style="color:#099">36</span>)},
 <span style="color:#000;font-weight:bold">.....</span>:                  index<span style="color:#000;font-weight:bold">=</span>pd<span style="color:#000;font-weight:bold">.</span>date_range(<span style="color:#d14">&#39;2011-01-01&#39;</span>, freq<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;M&#39;</span>, periods<span style="color:#000;font-weight:bold">=</span><span style="color:#099">36</span>))
 <span style="color:#000;font-weight:bold">.....</span>: 

In [<span style="color:#099">158</span>]: pd<span style="color:#000;font-weight:bold">.</span>pivot_table(df, index<span style="color:#000;font-weight:bold">=</span>df<span style="color:#000;font-weight:bold">.</span>index<span style="color:#000;font-weight:bold">.</span>month, columns<span style="color:#000;font-weight:bold">=</span>df<span style="color:#000;font-weight:bold">.</span>index<span style="color:#000;font-weight:bold">.</span>year,
 <span style="color:#000;font-weight:bold">.....</span>:               values<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;value&#39;</span>, aggfunc<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;sum&#39;</span>)
 <span style="color:#000;font-weight:bold">.....</span>: 
Out[<span style="color:#099">158</span>]: 
 <span style="color:#099">2011</span>      <span style="color:#099">2012</span>      <span style="color:#099">2013</span>
<span style="color:#099">1</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1.039268</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.968914</span>  <span style="color:#099">2.565646</span>
<span style="color:#099">2</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.370647</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1.294524</span>  <span style="color:#099">1.431256</span>
<span style="color:#099">3</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1.157892</span>  <span style="color:#099">0.413738</span>  <span style="color:#099">1.340309</span>
<span style="color:#099">4</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1.344312</span>  <span style="color:#099">0.276662</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1.170299</span>
<span style="color:#099">5</span>   <span style="color:#099">0.844885</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.472035</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.226169</span>
<span style="color:#099">6</span>   <span style="color:#099">1.075770</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.013960</span>  <span style="color:#099">0.410835</span>
<span style="color:#099">7</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.109050</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.362543</span>  <span style="color:#099">0.813850</span>
<span style="color:#099">8</span>   <span style="color:#099">1.643563</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.006154</span>  <span style="color:#099">0.132003</span>
<span style="color:#099">9</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1.469388</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.923061</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.827317</span>
<span style="color:#099">10</span>  <span style="color:#099">0.357021</span>  <span style="color:#099">0.895717</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.076467</span>
<span style="color:#099">11</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.674600</span>  <span style="color:#099">0.805244</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1.187678</span>
<span style="color:#099">12</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1.776904</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1.206412</span>  <span style="color:#099">1.130127</span>
</code></pre></div><h3 ref="applyhttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlapply-permalink-to-this-headline" >Apply<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#apply" title="Permalink to this headline"></a></h3><a class="anchor" id="applyhttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlapply-permalink-to-this-headline"></a>
<p><a href="https://stackoverflow.com/questions/17349981/converting-pandas-dataframe-with-categorical-values-into-binary-values">Rolling apply to organize - Turning embedded lists into a MultiIndex frame</a></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">159</span>]: df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame(data<span style="color:#000;font-weight:bold">=</span>{<span style="color:#d14">&#39;A&#39;</span>: [[<span style="color:#099">2</span>, <span style="color:#099">4</span>, <span style="color:#099">8</span>, <span style="color:#099">16</span>], [<span style="color:#099">100</span>, <span style="color:#099">200</span>], [<span style="color:#099">10</span>, <span style="color:#099">20</span>, <span style="color:#099">30</span>]],
 <span style="color:#000;font-weight:bold">.....</span>:                        <span style="color:#d14">&#39;B&#39;</span>: [[<span style="color:#d14">&#39;a&#39;</span>, <span style="color:#d14">&#39;b&#39;</span>, <span style="color:#d14">&#39;c&#39;</span>], [<span style="color:#d14">&#39;jj&#39;</span>, <span style="color:#d14">&#39;kk&#39;</span>], [<span style="color:#d14">&#39;ccc&#39;</span>]]},
 <span style="color:#000;font-weight:bold">.....</span>:                  index<span style="color:#000;font-weight:bold">=</span>[<span style="color:#d14">&#39;I&#39;</span>, <span style="color:#d14">&#39;II&#39;</span>, <span style="color:#d14">&#39;III&#39;</span>])
 <span style="color:#000;font-weight:bold">.....</span>: 

In [<span style="color:#099">160</span>]: <span style="color:#000;font-weight:bold">def</span> <span style="color:#900;font-weight:bold">SeriesFromSubList</span>(aList):
 <span style="color:#000;font-weight:bold">.....</span>:    <span style="color:#000;font-weight:bold">return</span> pd<span style="color:#000;font-weight:bold">.</span>Series(aList)
 <span style="color:#000;font-weight:bold">.....</span>: 

In [<span style="color:#099">161</span>]: df_orgz <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>concat({ind: row<span style="color:#000;font-weight:bold">.</span>apply(SeriesFromSubList)
 <span style="color:#000;font-weight:bold">.....</span>:                     <span style="color:#000;font-weight:bold">for</span> ind, row <span style="color:#000;font-weight:bold">in</span> df<span style="color:#000;font-weight:bold">.</span>iterrows()})
 <span style="color:#000;font-weight:bold">.....</span>: 

In [<span style="color:#099">162</span>]: df_orgz
Out[<span style="color:#099">162</span>]: 
 <span style="color:#099">0</span>    <span style="color:#099">1</span>    <span style="color:#099">2</span>     <span style="color:#099">3</span>
I   A    <span style="color:#099">2</span>    <span style="color:#099">4</span>    <span style="color:#099">8</span>  <span style="color:#099">16.0</span>
 B    a    b    c   NaN
II  A  <span style="color:#099">100</span>  <span style="color:#099">200</span>  NaN   NaN
 B   jj   kk  NaN   NaN
III A   <span style="color:#099">10</span>   <span style="color:#099">20</span>   <span style="color:#099">30</span>   NaN
 B  ccc  NaN  NaN   NaN
</code></pre></div><p><a href="https://stackoverflow.com/questions/19121854/using-rolling-apply-on-a-dataframe-object">Rolling apply with a DataFrame returning a Series</a></p>
<p>Rolling Apply to multiple columns where function calculates a Series before a Scalar from the Series is returned</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">163</span>]: df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame(data<span style="color:#000;font-weight:bold">=</span>np<span style="color:#000;font-weight:bold">.</span>random<span style="color:#000;font-weight:bold">.</span>randn(<span style="color:#099">2000</span>, <span style="color:#099">2</span>) <span style="color:#000;font-weight:bold">/</span> <span style="color:#099">10000</span>,
 <span style="color:#000;font-weight:bold">.....</span>:                  index<span style="color:#000;font-weight:bold">=</span>pd<span style="color:#000;font-weight:bold">.</span>date_range(<span style="color:#d14">&#39;2001-01-01&#39;</span>, periods<span style="color:#000;font-weight:bold">=</span><span style="color:#099">2000</span>),
 <span style="color:#000;font-weight:bold">.....</span>:                  columns<span style="color:#000;font-weight:bold">=</span>[<span style="color:#d14">&#39;A&#39;</span>, <span style="color:#d14">&#39;B&#39;</span>])
 <span style="color:#000;font-weight:bold">.....</span>: 

In [<span style="color:#099">164</span>]: df
Out[<span style="color:#099">164</span>]: 
 A         B
<span style="color:#099">2001</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.000144</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.000141</span>
<span style="color:#099">2001</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">02</span>  <span style="color:#099">0.000161</span>  <span style="color:#099">0.000102</span>
<span style="color:#099">2001</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">03</span>  <span style="color:#099">0.000057</span>  <span style="color:#099">0.000088</span>
<span style="color:#099">2001</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">04</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.000221</span>  <span style="color:#099">0.000097</span>
<span style="color:#099">2001</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">05</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.000201</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.000041</span>
<span style="color:#000;font-weight:bold">...</span>              <span style="color:#000;font-weight:bold">...</span>       <span style="color:#000;font-weight:bold">...</span>
<span style="color:#099">2006</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">06</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">19</span>  <span style="color:#099">0.000040</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.000235</span>
<span style="color:#099">2006</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">06</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">20</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.000123</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.000021</span>
<span style="color:#099">2006</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">06</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">21</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.000113</span>  <span style="color:#099">0.000114</span>
<span style="color:#099">2006</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">06</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">22</span>  <span style="color:#099">0.000136</span>  <span style="color:#099">0.000109</span>
<span style="color:#099">2006</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">06</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">23</span>  <span style="color:#099">0.000027</span>  <span style="color:#099">0.000030</span>

[<span style="color:#099">2000</span> rows x <span style="color:#099">2</span> columns]
</code></pre></div><div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">165</span>]: <span style="color:#000;font-weight:bold">def</span> <span style="color:#900;font-weight:bold">gm</span>(df, const):
 <span style="color:#000;font-weight:bold">.....</span>:    v <span style="color:#000;font-weight:bold">=</span> ((((df[<span style="color:#d14">&#39;A&#39;</span>] <span style="color:#000;font-weight:bold">+</span> df[<span style="color:#d14">&#39;B&#39;</span>]) <span style="color:#000;font-weight:bold">+</span> <span style="color:#099">1</span>)<span style="color:#000;font-weight:bold">.</span>cumprod()) <span style="color:#000;font-weight:bold">-</span> <span style="color:#099">1</span>) <span style="color:#000;font-weight:bold">*</span> const
 <span style="color:#000;font-weight:bold">.....</span>:    <span style="color:#000;font-weight:bold">return</span> v<span style="color:#000;font-weight:bold">.</span>iloc[<span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>]
 <span style="color:#000;font-weight:bold">.....</span>: 

In [<span style="color:#099">166</span>]: s <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>Series({df<span style="color:#000;font-weight:bold">.</span>index[i]: gm(df<span style="color:#000;font-weight:bold">.</span>iloc[i:<span style="color:#0086b3">min</span>(i <span style="color:#000;font-weight:bold">+</span> <span style="color:#099">51</span>, <span style="color:#0086b3">len</span>(df) <span style="color:#000;font-weight:bold">-</span> <span style="color:#099">1</span>)], <span style="color:#099">5</span>)
 <span style="color:#000;font-weight:bold">.....</span>:               <span style="color:#000;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#0086b3">range</span>(<span style="color:#0086b3">len</span>(df) <span style="color:#000;font-weight:bold">-</span> <span style="color:#099">50</span>)})
 <span style="color:#000;font-weight:bold">.....</span>: 

In [<span style="color:#099">167</span>]: s
Out[<span style="color:#099">167</span>]: 
<span style="color:#099">2001</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span>    <span style="color:#099">0.000930</span>
<span style="color:#099">2001</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">02</span>    <span style="color:#099">0.002615</span>
<span style="color:#099">2001</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">03</span>    <span style="color:#099">0.001281</span>
<span style="color:#099">2001</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">04</span>    <span style="color:#099">0.001117</span>
<span style="color:#099">2001</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">05</span>    <span style="color:#099">0.002772</span>
 <span style="color:#000;font-weight:bold">...</span> 
<span style="color:#099">2006</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">04</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">30</span>    <span style="color:#099">0.003296</span>
<span style="color:#099">2006</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">05</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span>    <span style="color:#099">0.002629</span>
<span style="color:#099">2006</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">05</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">02</span>    <span style="color:#099">0.002081</span>
<span style="color:#099">2006</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">05</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">03</span>    <span style="color:#099">0.004247</span>
<span style="color:#099">2006</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">05</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">04</span>    <span style="color:#099">0.003928</span>
Length: <span style="color:#099">1950</span>, dtype: float64
</code></pre></div><p><a href="https://stackoverflow.com/questions/21040766/python-pandas-rolling-apply-two-column-input-into-function/21045831#21045831">Rolling apply with a DataFrame returning a Scalar</a></p>
<p>Rolling Apply to multiple columns where function returns a Scalar (Volume Weighted Average Price)</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">168</span>]: rng <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>date_range(start<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;2014-01-01&#39;</span>, periods<span style="color:#000;font-weight:bold">=</span><span style="color:#099">100</span>)

In [<span style="color:#099">169</span>]: df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame({<span style="color:#d14">&#39;Open&#39;</span>: np<span style="color:#000;font-weight:bold">.</span>random<span style="color:#000;font-weight:bold">.</span>randn(<span style="color:#0086b3">len</span>(rng)),
 <span style="color:#000;font-weight:bold">.....</span>:                   <span style="color:#d14">&#39;Close&#39;</span>: np<span style="color:#000;font-weight:bold">.</span>random<span style="color:#000;font-weight:bold">.</span>randn(<span style="color:#0086b3">len</span>(rng)),
 <span style="color:#000;font-weight:bold">.....</span>:                   <span style="color:#d14">&#39;Volume&#39;</span>: np<span style="color:#000;font-weight:bold">.</span>random<span style="color:#000;font-weight:bold">.</span>randint(<span style="color:#099">100</span>, <span style="color:#099">2000</span>, <span style="color:#0086b3">len</span>(rng))},
 <span style="color:#000;font-weight:bold">.....</span>:                  index<span style="color:#000;font-weight:bold">=</span>rng)
 <span style="color:#000;font-weight:bold">.....</span>: 

In [<span style="color:#099">170</span>]: df
Out[<span style="color:#099">170</span>]: 
 Open     Close  Volume
<span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1.611353</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.492885</span>    <span style="color:#099">1219</span>
<span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">02</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">3.000951</span>  <span style="color:#099">0.445794</span>    <span style="color:#099">1054</span>
<span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">03</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.138359</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.076081</span>    <span style="color:#099">1381</span>
<span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">04</span>  <span style="color:#099">0.301568</span>  <span style="color:#099">1.198259</span>    <span style="color:#099">1253</span>
<span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">05</span>  <span style="color:#099">0.276381</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.669831</span>    <span style="color:#099">1728</span>
<span style="color:#000;font-weight:bold">...</span>              <span style="color:#000;font-weight:bold">...</span>       <span style="color:#000;font-weight:bold">...</span>     <span style="color:#000;font-weight:bold">...</span>
<span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">04</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">06</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.040338</span>  <span style="color:#099">0.937843</span>    <span style="color:#099">1188</span>
<span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">04</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">07</span>  <span style="color:#099">0.359661</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.285908</span>    <span style="color:#099">1864</span>
<span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">04</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">08</span>  <span style="color:#099">0.060978</span>  <span style="color:#099">1.714814</span>     <span style="color:#099">941</span>
<span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">04</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">09</span>  <span style="color:#099">1.759055</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.455942</span>    <span style="color:#099">1065</span>
<span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">04</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">10</span>  <span style="color:#099">0.138185</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1.147008</span>    <span style="color:#099">1453</span>

[<span style="color:#099">100</span> rows x <span style="color:#099">3</span> columns]

In [<span style="color:#099">171</span>]: <span style="color:#000;font-weight:bold">def</span> <span style="color:#900;font-weight:bold">vwap</span>(bars):
 <span style="color:#000;font-weight:bold">.....</span>:    <span style="color:#000;font-weight:bold">return</span> ((bars<span style="color:#000;font-weight:bold">.</span>Close <span style="color:#000;font-weight:bold">*</span> bars<span style="color:#000;font-weight:bold">.</span>Volume)<span style="color:#000;font-weight:bold">.</span>sum() <span style="color:#000;font-weight:bold">/</span> bars<span style="color:#000;font-weight:bold">.</span>Volume<span style="color:#000;font-weight:bold">.</span>sum())
 <span style="color:#000;font-weight:bold">.....</span>: 

In [<span style="color:#099">172</span>]: window <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">5</span>

In [<span style="color:#099">173</span>]: s <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>concat([(pd<span style="color:#000;font-weight:bold">.</span>Series(vwap(df<span style="color:#000;font-weight:bold">.</span>iloc[i:i <span style="color:#000;font-weight:bold">+</span> window]),
 <span style="color:#000;font-weight:bold">.....</span>:                index<span style="color:#000;font-weight:bold">=</span>[df<span style="color:#000;font-weight:bold">.</span>index[i <span style="color:#000;font-weight:bold">+</span> window]]))
 <span style="color:#000;font-weight:bold">.....</span>:               <span style="color:#000;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#0086b3">range</span>(<span style="color:#0086b3">len</span>(df) <span style="color:#000;font-weight:bold">-</span> window)])
 <span style="color:#000;font-weight:bold">.....</span>: 

In [<span style="color:#099">174</span>]: s<span style="color:#000;font-weight:bold">.</span>round(<span style="color:#099">2</span>)
Out[<span style="color:#099">174</span>]: 
<span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">06</span>    <span style="color:#099">0.02</span>
<span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">07</span>    <span style="color:#099">0.11</span>
<span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">08</span>    <span style="color:#099">0.10</span>
<span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">09</span>    <span style="color:#099">0.07</span>
<span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">10</span>   <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.29</span>
 <span style="color:#000;font-weight:bold">...</span> 
<span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">04</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">06</span>   <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.63</span>
<span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">04</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">07</span>   <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.02</span>
<span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">04</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">08</span>   <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.03</span>
<span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">04</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">09</span>    <span style="color:#099">0.34</span>
<span style="color:#099">2014</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">04</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">10</span>    <span style="color:#099">0.29</span>
Length: <span style="color:#099">95</span>, dtype: float64
</code></pre></div><h2 ref="timeserieshttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmltimeseries-permalink-to-this-headline" >Timeseries<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#timeseries" title="Permalink to this headline"></a></h2><a class="anchor" id="timeserieshttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmltimeseries-permalink-to-this-headline"></a>
<p><a href="https://stackoverflow.com/questions/14539992/pandas-drop-rows-outside-of-time-range">Between times</a></p>
<p><a href="https://stackoverflow.com/questions/17559885/pandas-dataframe-mask-based-on-index">Using indexer between time</a></p>
<p><a href="https://stackoverflow.com/questions/24010830/pandas-generate-sequential-timestamp-with-jump/24014440#24014440?">Constructing a datetime range that excludes weekends and includes only certain times</a></p>
<p><a href="https://stackoverflow.com/questions/13893227/vectorized-look-up-of-values-in-pandas-dataframe">Vectorized Lookup</a></p>
<p><a href="http://nipunbatra.github.io/2015/06/timeseries/">Aggregation and plotting time series</a></p>
<p>Turn a matrix with hours in columns and days in rows into a continuous row sequence in the form of a time series.  <a href="https://stackoverflow.com/questions/15432659/how-to-rearrange-a-python-pandas-dataframe">How to rearrange a Python pandas DataFrame?</a></p>
<p><a href="https://stackoverflow.com/questions/22244383/pandas-df-refill-adding-two-columns-of-different-shape">Dealing with duplicates when reindexing a timeseries to a specified frequency</a></p>
<p>Calculate the first day of the month for each entry in a DatetimeIndex</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">175</span>]: dates <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>date_range(<span style="color:#d14">&#39;2000-01-01&#39;</span>, periods<span style="color:#000;font-weight:bold">=</span><span style="color:#099">5</span>)

In [<span style="color:#099">176</span>]: dates<span style="color:#000;font-weight:bold">.</span>to_period(freq<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;M&#39;</span>)<span style="color:#000;font-weight:bold">.</span>to_timestamp()
Out[<span style="color:#099">176</span>]: 
DatetimeIndex([<span style="color:#d14">&#39;2000-01-01&#39;</span>, <span style="color:#d14">&#39;2000-01-01&#39;</span>, <span style="color:#d14">&#39;2000-01-01&#39;</span>, <span style="color:#d14">&#39;2000-01-01&#39;</span>,
 <span style="color:#d14">&#39;2000-01-01&#39;</span>],
 dtype<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;datetime64[ns]&#39;</span>, freq<span style="color:#000;font-weight:bold">=</span><span style="color:#999">None</span>)
</code></pre></div><h3 ref="resamplinghttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlresampling-permalink-to-this-headline" >Resampling<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#resampling" title="Permalink to this headline"></a></h3><a class="anchor" id="resamplinghttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlresampling-permalink-to-this-headline"></a>
<p>The  <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#timeseries-resampling">Resample</a>  docs.</p>
<p><a href="https://stackoverflow.com/questions/15297053/how-can-i-divide-single-values-of-a-dataframe-by-monthly-averages">Using Grouper instead of TimeGrouper for time grouping of values</a></p>
<p><a href="https://stackoverflow.com/questions/33637312/pandas-grouper-by-frequency-with-completeness-requirement">Time grouping with some missing values</a></p>
<p>Valid frequency arguments to Grouper  <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#timeseries-offset-aliases">Timeseries</a></p>
<p><a href="https://stackoverflow.com/questions/41483763/pandas-timegrouper-on-multiindex">Grouping using a MultiIndex</a></p>
<p><a href="https://github.com/pandas-dev/pandas/issues/3791">Using TimeGrouper and another grouping to create subgroups, then apply a custom function</a></p>
<p><a href="https://stackoverflow.com/questions/15408156/resampling-with-custom-periods">Resampling with custom periods</a></p>
<p><a href="https://stackoverflow.com/questions/14898574/resample-intrday-pandas-dataframe-without-add-new-days">Resample intraday frame without adding new days</a></p>
<p><a href="https://stackoverflow.com/questions/14861023/resampling-minute-data">Resample minute data</a></p>
<p><a href="https://stackoverflow.com/q/18677271/564538">Resample with groupby</a></p>
<h2 ref="mergehttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlmerge-permalink-to-this-headline" >Merge<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#merge" title="Permalink to this headline"></a></h2><a class="anchor" id="mergehttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlmerge-permalink-to-this-headline"></a>
<p>The  <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/merging.html#merging-concatenation">Concat</a>  docs. The  <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/merging.html#merging-join">Join</a>  docs.</p>
<p><a href="https://stackoverflow.com/questions/14988480/pandas-version-of-rbind">Append two dataframes with overlapping index (emulate R rbind)</a></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">177</span>]: rng <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>date_range(<span style="color:#d14">&#39;2000-01-01&#39;</span>, periods<span style="color:#000;font-weight:bold">=</span><span style="color:#099">6</span>)

In [<span style="color:#099">178</span>]: df1 <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame(np<span style="color:#000;font-weight:bold">.</span>random<span style="color:#000;font-weight:bold">.</span>randn(<span style="color:#099">6</span>, <span style="color:#099">3</span>), index<span style="color:#000;font-weight:bold">=</span>rng, columns<span style="color:#000;font-weight:bold">=</span>[<span style="color:#d14">&#39;A&#39;</span>, <span style="color:#d14">&#39;B&#39;</span>, <span style="color:#d14">&#39;C&#39;</span>])

In [<span style="color:#099">179</span>]: df2 <span style="color:#000;font-weight:bold">=</span> df1<span style="color:#000;font-weight:bold">.</span>copy()

Depending on df construction,  <span style="color:#d14">`ignore_index`</span>  may be needed

In [<span style="color:#099">180</span>]: df <span style="color:#000;font-weight:bold">=</span> df1<span style="color:#000;font-weight:bold">.</span>append(df2, ignore_index<span style="color:#000;font-weight:bold">=</span><span style="color:#999">True</span>)

In [<span style="color:#099">181</span>]: df
Out[<span style="color:#099">181</span>]: 
 A         B         C
<span style="color:#099">0</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.870117</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.479265</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.790855</span>
<span style="color:#099">1</span>   <span style="color:#099">0.144817</span>  <span style="color:#099">1.726395</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.464535</span>
<span style="color:#099">2</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.821906</span>  <span style="color:#099">1.597605</span>  <span style="color:#099">0.187307</span>
<span style="color:#099">3</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.128342</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1.511638</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.289858</span>
<span style="color:#099">4</span>   <span style="color:#099">0.399194</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1.430030</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.639760</span>
<span style="color:#099">5</span>   <span style="color:#099">1.115116</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">2.012600</span>  <span style="color:#099">1.810662</span>
<span style="color:#099">6</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.870117</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.479265</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.790855</span>
<span style="color:#099">7</span>   <span style="color:#099">0.144817</span>  <span style="color:#099">1.726395</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.464535</span>
<span style="color:#099">8</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.821906</span>  <span style="color:#099">1.597605</span>  <span style="color:#099">0.187307</span>
<span style="color:#099">9</span>  <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.128342</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1.511638</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.289858</span>
<span style="color:#099">10</span>  <span style="color:#099">0.399194</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1.430030</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.639760</span>
<span style="color:#099">11</span>  <span style="color:#099">1.115116</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">2.012600</span>  <span style="color:#099">1.810662</span>
</code></pre></div><p><a href="https://github.com/pandas-dev/pandas/issues/2996">Self Join of a DataFrame</a></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">182</span>]: df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame(data<span style="color:#000;font-weight:bold">=</span>{<span style="color:#d14">&#39;Area&#39;</span>: [<span style="color:#d14">&#39;A&#39;</span>] <span style="color:#000;font-weight:bold">*</span> <span style="color:#099">5</span> <span style="color:#000;font-weight:bold">+</span> [<span style="color:#d14">&#39;C&#39;</span>] <span style="color:#000;font-weight:bold">*</span> <span style="color:#099">2</span>,
 <span style="color:#000;font-weight:bold">.....</span>:                        <span style="color:#d14">&#39;Bins&#39;</span>: [<span style="color:#099">110</span>] <span style="color:#000;font-weight:bold">*</span> <span style="color:#099">2</span> <span style="color:#000;font-weight:bold">+</span> [<span style="color:#099">160</span>] <span style="color:#000;font-weight:bold">*</span> <span style="color:#099">3</span> <span style="color:#000;font-weight:bold">+</span> [<span style="color:#099">40</span>] <span style="color:#000;font-weight:bold">*</span> <span style="color:#099">2</span>,
 <span style="color:#000;font-weight:bold">.....</span>:                        <span style="color:#d14">&#39;Test_0&#39;</span>: [<span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">0</span>, <span style="color:#099">1</span>, <span style="color:#099">2</span>, <span style="color:#099">0</span>, <span style="color:#099">1</span>],
 <span style="color:#000;font-weight:bold">.....</span>:                        <span style="color:#d14">&#39;Data&#39;</span>: np<span style="color:#000;font-weight:bold">.</span>random<span style="color:#000;font-weight:bold">.</span>randn(<span style="color:#099">7</span>)})
 <span style="color:#000;font-weight:bold">.....</span>: 

In [<span style="color:#099">183</span>]: df
Out[<span style="color:#099">183</span>]: 
 Area  Bins  Test_0      Data
<span style="color:#099">0</span>    A   <span style="color:#099">110</span>       <span style="color:#099">0</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.433937</span>
<span style="color:#099">1</span>    A   <span style="color:#099">110</span>       <span style="color:#099">1</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.160552</span>
<span style="color:#099">2</span>    A   <span style="color:#099">160</span>       <span style="color:#099">0</span>  <span style="color:#099">0.744434</span>
<span style="color:#099">3</span>    A   <span style="color:#099">160</span>       <span style="color:#099">1</span>  <span style="color:#099">1.754213</span>
<span style="color:#099">4</span>    A   <span style="color:#099">160</span>       <span style="color:#099">2</span>  <span style="color:#099">0.000850</span>
<span style="color:#099">5</span>    C    <span style="color:#099">40</span>       <span style="color:#099">0</span>  <span style="color:#099">0.342243</span>
<span style="color:#099">6</span>    C    <span style="color:#099">40</span>       <span style="color:#099">1</span>  <span style="color:#099">1.070599</span>

In [<span style="color:#099">184</span>]: df[<span style="color:#d14">&#39;Test_1&#39;</span>] <span style="color:#000;font-weight:bold">=</span> df[<span style="color:#d14">&#39;Test_0&#39;</span>] <span style="color:#000;font-weight:bold">-</span> <span style="color:#099">1</span>

In [<span style="color:#099">185</span>]: pd<span style="color:#000;font-weight:bold">.</span>merge(df, df, left_on<span style="color:#000;font-weight:bold">=</span>[<span style="color:#d14">&#39;Bins&#39;</span>, <span style="color:#d14">&#39;Area&#39;</span>, <span style="color:#d14">&#39;Test_0&#39;</span>],
 <span style="color:#000;font-weight:bold">.....</span>:         right_on<span style="color:#000;font-weight:bold">=</span>[<span style="color:#d14">&#39;Bins&#39;</span>, <span style="color:#d14">&#39;Area&#39;</span>, <span style="color:#d14">&#39;Test_1&#39;</span>],
 <span style="color:#000;font-weight:bold">.....</span>:         suffixes<span style="color:#000;font-weight:bold">=</span>(<span style="color:#d14">&#39;_L&#39;</span>, <span style="color:#d14">&#39;_R&#39;</span>))
 <span style="color:#000;font-weight:bold">.....</span>: 
Out[<span style="color:#099">185</span>]: 
 Area  Bins  Test_0_L    Data_L  Test_1_L  Test_0_R    Data_R  Test_1_R
<span style="color:#099">0</span>    A   <span style="color:#099">110</span>         <span style="color:#099">0</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.433937</span>        <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>         <span style="color:#099">1</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.160552</span>         <span style="color:#099">0</span>
<span style="color:#099">1</span>    A   <span style="color:#099">160</span>         <span style="color:#099">0</span>  <span style="color:#099">0.744434</span>        <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>         <span style="color:#099">1</span>  <span style="color:#099">1.754213</span>         <span style="color:#099">0</span>
<span style="color:#099">2</span>    A   <span style="color:#099">160</span>         <span style="color:#099">1</span>  <span style="color:#099">1.754213</span>         <span style="color:#099">0</span>         <span style="color:#099">2</span>  <span style="color:#099">0.000850</span>         <span style="color:#099">1</span>
<span style="color:#099">3</span>    C    <span style="color:#099">40</span>         <span style="color:#099">0</span>  <span style="color:#099">0.342243</span>        <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span>         <span style="color:#099">1</span>  <span style="color:#099">1.070599</span>         <span style="color:#099">0</span>
</code></pre></div><p><a href="https://stackoverflow.com/questions/14341805/pandas-merge-pd-merge-how-to-set-the-index-and-join">How to set the index and join</a></p>
<p><a href="https://stackoverflow.com/questions/12322289/kdb-like-asof-join-for-timeseries-data-in-pandas/12336039#12336039">KDB like asof join</a></p>
<p><a href="https://stackoverflow.com/questions/15581829/how-to-perform-an-inner-or-outer-join-of-dataframes-with-pandas-on-non-simplisti">Join with a criteria based on the values</a></p>
<p><a href="https://stackoverflow.com/questions/25125626/pandas-merge-with-logic/2512764">Using searchsorted to merge based on values inside a range</a></p>
<h2 ref="plottinghttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlplotting-permalink-to-this-headline" >Plotting<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#plotting" title="Permalink to this headline"></a></h2><a class="anchor" id="plottinghttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlplotting-permalink-to-this-headline"></a>
<p>The  <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/visualization.html#visualization">Plotting</a>  docs.</p>
<p><a href="https://stackoverflow.com/questions/14349055/making-matplotlib-graphs-look-like-r-by-default">Make Matplotlib look like R</a></p>
<p><a href="https://stackoverflow.com/questions/12945971/pandas-timeseries-plot-setting-x-axis-major-and-minor-ticks-and-labels">Setting x-axis major and minor labels</a></p>
<p><a href="https://stackoverflow.com/questions/16392921/make-more-than-one-chart-in-same-ipython-notebook-cell">Plotting multiple charts in an ipython notebook</a></p>
<p><a href="https://stackoverflow.com/questions/16568964/make-a-multiline-plot-from-csv-file-in-matplotlib">Creating a multi-line plot</a></p>
<p><a href="https://stackoverflow.com/questions/17050202/plot-timeseries-of-histograms-in-python">Plotting a heatmap</a></p>
<p><a href="https://stackoverflow.com/questions/11067368/annotate-time-series-plot-in-matplotlib">Annotate a time-series plot</a></p>
<p><a href="https://stackoverflow.com/questions/17891493/annotating-points-from-a-pandas-dataframe-in-matplotlib-plot">Annotate a time-series plot #2</a></p>
<p><a href="https://pandas-xlsxwriter-charts.readthedocs.io/">Generate Embedded plots in excel files using Pandas, Vincent and xlsxwriter</a></p>
<p><a href="https://stackoverflow.com/questions/23232989/boxplot-stratified-by-column-in-python-pandas">Boxplot for each quartile of a stratifying variable</a></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">186</span>]: df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame(
 <span style="color:#000;font-weight:bold">.....</span>:    {<span style="color:#d14">&#39;stratifying_var&#39;</span>: np<span style="color:#000;font-weight:bold">.</span>random<span style="color:#000;font-weight:bold">.</span>uniform(<span style="color:#099">0</span>, <span style="color:#099">100</span>, <span style="color:#099">20</span>),
 <span style="color:#000;font-weight:bold">.....</span>:     <span style="color:#d14">&#39;price&#39;</span>: np<span style="color:#000;font-weight:bold">.</span>random<span style="color:#000;font-weight:bold">.</span>normal(<span style="color:#099">100</span>, <span style="color:#099">5</span>, <span style="color:#099">20</span>)})
 <span style="color:#000;font-weight:bold">.....</span>: 

In [<span style="color:#099">187</span>]: df[<span style="color:#d14">&#39;quartiles&#39;</span>] <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>qcut(
 <span style="color:#000;font-weight:bold">.....</span>:    df[<span style="color:#d14">&#39;stratifying_var&#39;</span>],
 <span style="color:#000;font-weight:bold">.....</span>:    <span style="color:#099">4</span>,
 <span style="color:#000;font-weight:bold">.....</span>:    labels<span style="color:#000;font-weight:bold">=</span>[<span style="color:#d14">&#39;0-25%&#39;</span>, <span style="color:#d14">&#39;25-50%&#39;</span>, <span style="color:#d14">&#39;50-75%&#39;</span>, <span style="color:#d14">&#39;75-100%&#39;</span>])
 <span style="color:#000;font-weight:bold">.....</span>: 

In [<span style="color:#099">188</span>]: df<span style="color:#000;font-weight:bold">.</span>boxplot(column<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;price&#39;</span>, by<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;quartiles&#39;</span>)
Out[<span style="color:#099">188</span>]: <span style="color:#000;font-weight:bold">&lt;</span>matplotlib<span style="color:#000;font-weight:bold">.</span>axes<span style="color:#000;font-weight:bold">.</span>_subplots<span style="color:#000;font-weight:bold">.</span>AxesSubplot at <span style="color:#099">0x7f9f2b8e9700</span><span style="color:#000;font-weight:bold">&gt;</span>

<span style="color:#a61717;background-color:#e3d2d2">!</span>[<span style="color:#000;font-weight:bold">../</span>_images<span style="color:#000;font-weight:bold">/</span>quartile_boxplot<span style="color:#000;font-weight:bold">.</span>png](https:<span style="color:#000;font-weight:bold">//</span>pandas<span style="color:#000;font-weight:bold">.</span>pydata<span style="color:#000;font-weight:bold">.</span>org<span style="color:#000;font-weight:bold">/</span>pandas<span style="color:#000;font-weight:bold">-</span>docs<span style="color:#000;font-weight:bold">/</span>stable<span style="color:#000;font-weight:bold">/</span>_images<span style="color:#000;font-weight:bold">/</span>quartile_boxplot<span style="color:#000;font-weight:bold">.</span>png)
</code></pre></div><h2 ref="data-inouthttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmldata-in-out-permalink-to-this-headline" >Data in/out<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#data-in-out" title="Permalink to this headline"></a></h2><a class="anchor" id="data-inouthttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmldata-in-out-permalink-to-this-headline"></a>
<p><a href="https://stackoverflow.com/questions/16628329/hdf5-and-sqlite-concurrency-compression-i-o-performance">Performance comparison of SQL vs HDF5</a></p>
<h3 ref="csvhttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlcsv-permalink-to-this-headline" >CSV<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#csv" title="Permalink to this headline"></a></h3><a class="anchor" id="csvhttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlcsv-permalink-to-this-headline"></a>
<p>The  <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/io.html#io-read-csv-table">CSV</a>  docs</p>
<p><a href="https://wesmckinney.com/blog/update-on-upcoming-pandas-v0-10-new-file-parser-other-performance-wins/">read_csv in action</a></p>
<p><a href="https://stackoverflow.com/questions/17134942/pandas-dataframe-output-end-of-csv">appending to a csv</a></p>
<p><a href="https://stackoverflow.com/questions/11622652/large-persistent-dataframe-in-pandas/12193309#12193309">Reading a csv chunk-by-chunk</a></p>
<p><a href="https://stackoverflow.com/questions/19674212/pandas-data-frame-select-rows-and-clear-memory">Reading only certain rows of a csv chunk-by-chunk</a></p>
<p><a href="https://stackoverflow.com/questions/15008970/way-to-read-first-few-lines-for-pandas-dataframe">Reading the first few lines of a frame</a></p>
<p>Reading a file that is compressed but not by  <code>gzip/bz2</code>  (the native compressed formats which  <code>read_csv</code>  understands). This example shows a  <code>WinZipped</code>  file, but is a general application of opening the file within a context manager and using that handle to read.  <a href="https://stackoverflow.com/questions/17789907/pandas-convert-winzipped-csv-file-to-data-frame">See here</a></p>
<p><a href="https://stackoverflow.com/questions/15555005/get-inferred-dataframe-types-iteratively-using-chunksize">Inferring dtypes from a file</a></p>
<p><a href="https://github.com/pandas-dev/pandas/issues/2886">Dealing with bad lines</a></p>
<p><a href="http://nipunbatra.github.io/2013/06/reading-unclean-data-csv-using-pandas/">Dealing with bad lines II</a></p>
<p><a href="http://nipunbatra.github.io/2013/06/pandas-reading-csv-with-unix-timestamps-and-converting-to-local-timezone/">Reading CSV with Unix timestamps and converting to local timezone</a></p>
<p><a href="https://stackoverflow.com/questions/17349574/pandas-write-multiindex-rows-with-to-csv">Write a multi-row index CSV without writing duplicates</a></p>
<h4 ref="reading-multiple-files-to-create-a-single-dataframehttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlreading-multiple-files-to-create-a-single-dataframe-permalink-to-this-headline" >Reading multiple files to create a single DataFrame<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#reading-multiple-files-to-create-a-single-dataframe" title="Permalink to this headline"></a></h4><a class="anchor" id="reading-multiple-files-to-create-a-single-dataframehttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlreading-multiple-files-to-create-a-single-dataframe-permalink-to-this-headline"></a>
<p>The best way to combine multiple files into a single DataFrame is to read the individual frames one by one, put all of the individual frames into a list, and then combine the frames in the list using  <code>pd.concat()</code>:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">189</span>]: <span style="color:#000;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#0086b3">range</span>(<span style="color:#099">3</span>):
 <span style="color:#000;font-weight:bold">.....</span>:    data <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame(np<span style="color:#000;font-weight:bold">.</span>random<span style="color:#000;font-weight:bold">.</span>randn(<span style="color:#099">10</span>, <span style="color:#099">4</span>))
 <span style="color:#000;font-weight:bold">.....</span>:    data<span style="color:#000;font-weight:bold">.</span>to_csv(<span style="color:#d14">&#39;file_{}.csv&#39;</span><span style="color:#000;font-weight:bold">.</span>format(i))
 <span style="color:#000;font-weight:bold">.....</span>: 

In [<span style="color:#099">190</span>]: files <span style="color:#000;font-weight:bold">=</span> [<span style="color:#d14">&#39;file_0.csv&#39;</span>, <span style="color:#d14">&#39;file_1.csv&#39;</span>, <span style="color:#d14">&#39;file_2.csv&#39;</span>]

In [<span style="color:#099">191</span>]: result <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>concat([pd<span style="color:#000;font-weight:bold">.</span>read_csv(f) <span style="color:#000;font-weight:bold">for</span> f <span style="color:#000;font-weight:bold">in</span> files], ignore_index<span style="color:#000;font-weight:bold">=</span><span style="color:#999">True</span>)
</code></pre></div><p>You can use the same approach to read all files matching a pattern. Here is an example using  <code>glob</code>:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">192</span>]: <span style="color:#000;font-weight:bold">import</span> <span style="color:#555">glob</span>

In [<span style="color:#099">193</span>]: <span style="color:#000;font-weight:bold">import</span> <span style="color:#555">os</span>

In [<span style="color:#099">194</span>]: files <span style="color:#000;font-weight:bold">=</span> glob<span style="color:#000;font-weight:bold">.</span>glob(<span style="color:#d14">&#39;file_*.csv&#39;</span>)

In [<span style="color:#099">195</span>]: result <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>concat([pd<span style="color:#000;font-weight:bold">.</span>read_csv(f) <span style="color:#000;font-weight:bold">for</span> f <span style="color:#000;font-weight:bold">in</span> files], ignore_index<span style="color:#000;font-weight:bold">=</span><span style="color:#999">True</span>)
</code></pre></div><p>Finally, this strategy will work with the other  <code>pd.read_*(...)</code>  functions described in the  <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/io.html#io">io docs</a>.</p>
<h4 ref="parsing-date-components-in-multi-columnshttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlparsing-date-components-in-multi-columns-permalink-to-this-headline" >Parsing date components in multi-columns<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#parsing-date-components-in-multi-columns" title="Permalink to this headline"></a></h4><a class="anchor" id="parsing-date-components-in-multi-columnshttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlparsing-date-components-in-multi-columns-permalink-to-this-headline"></a>
<p>Parsing date components in multi-columns is faster with a format</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">196</span>]: i <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>date_range(<span style="color:#d14">&#39;20000101&#39;</span>, periods<span style="color:#000;font-weight:bold">=</span><span style="color:#099">10000</span>)

In [<span style="color:#099">197</span>]: df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame({<span style="color:#d14">&#39;year&#39;</span>: i<span style="color:#000;font-weight:bold">.</span>year, <span style="color:#d14">&#39;month&#39;</span>: i<span style="color:#000;font-weight:bold">.</span>month, <span style="color:#d14">&#39;day&#39;</span>: i<span style="color:#000;font-weight:bold">.</span>day})

In [<span style="color:#099">198</span>]: df<span style="color:#000;font-weight:bold">.</span>head()
Out[<span style="color:#099">198</span>]: 
 year  month  day
<span style="color:#099">0</span>  <span style="color:#099">2000</span>      <span style="color:#099">1</span>    <span style="color:#099">1</span>
<span style="color:#099">1</span>  <span style="color:#099">2000</span>      <span style="color:#099">1</span>    <span style="color:#099">2</span>
<span style="color:#099">2</span>  <span style="color:#099">2000</span>      <span style="color:#099">1</span>    <span style="color:#099">3</span>
<span style="color:#099">3</span>  <span style="color:#099">2000</span>      <span style="color:#099">1</span>    <span style="color:#099">4</span>
<span style="color:#099">4</span>  <span style="color:#099">2000</span>      <span style="color:#099">1</span>    <span style="color:#099">5</span>

In [<span style="color:#099">199</span>]: <span style="color:#000;font-weight:bold">%</span>timeit pd<span style="color:#000;font-weight:bold">.</span>to_datetime(df<span style="color:#000;font-weight:bold">.</span>year <span style="color:#000;font-weight:bold">*</span> <span style="color:#099">10000</span> <span style="color:#000;font-weight:bold">+</span> df<span style="color:#000;font-weight:bold">.</span>month <span style="color:#000;font-weight:bold">*</span> <span style="color:#099">100</span> <span style="color:#000;font-weight:bold">+</span> df<span style="color:#000;font-weight:bold">.</span>day, format<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;%Y%m</span><span style="color:#d14">%d</span><span style="color:#d14">&#39;</span>)
 <span style="color:#000;font-weight:bold">.....</span>: ds <span style="color:#000;font-weight:bold">=</span> df<span style="color:#000;font-weight:bold">.</span>apply(<span style="color:#000;font-weight:bold">lambda</span> x: <span style="color:#d14">&#34;</span><span style="color:#d14">%04d%02d%02d</span><span style="color:#d14">&#34;</span> <span style="color:#000;font-weight:bold">%</span> (x[<span style="color:#d14">&#39;year&#39;</span>],
 <span style="color:#000;font-weight:bold">.....</span>:                                          x[<span style="color:#d14">&#39;month&#39;</span>], x[<span style="color:#d14">&#39;day&#39;</span>]), axis<span style="color:#000;font-weight:bold">=</span><span style="color:#099">1</span>)
 <span style="color:#000;font-weight:bold">.....</span>: ds<span style="color:#000;font-weight:bold">.</span>head()
 <span style="color:#000;font-weight:bold">.....</span>: <span style="color:#000;font-weight:bold">%</span>timeit pd<span style="color:#000;font-weight:bold">.</span>to_datetime(ds)
 <span style="color:#000;font-weight:bold">.....</span>: 
<span style="color:#099">12.7</span> ms <span style="color:#000;font-weight:bold">+-</span> <span style="color:#099">111</span> us per loop (mean <span style="color:#000;font-weight:bold">+-</span> std<span style="color:#000;font-weight:bold">.</span> dev<span style="color:#000;font-weight:bold">.</span> of <span style="color:#099">7</span> runs, <span style="color:#099">100</span> loops each)
<span style="color:#099">3.44</span> ms <span style="color:#000;font-weight:bold">+-</span> <span style="color:#099">99.2</span> us per loop (mean <span style="color:#000;font-weight:bold">+-</span> std<span style="color:#000;font-weight:bold">.</span> dev<span style="color:#000;font-weight:bold">.</span> of <span style="color:#099">7</span> runs, <span style="color:#099">100</span> loops each)
</code></pre></div><h4 ref="skip-row-between-header-and-datahttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlskip-row-between-header-and-data-permalink-to-this-headline" >Skip row between header and data<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#skip-row-between-header-and-data" title="Permalink to this headline"></a></h4><a class="anchor" id="skip-row-between-header-and-datahttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlskip-row-between-header-and-data-permalink-to-this-headline"></a>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">200</span>]: data <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#34;&#34;&#34;;;;;
</span><span style="color:#d14"> .....: ;;;;
</span><span style="color:#d14"> .....: ;;;;
</span><span style="color:#d14"> .....: ;;;;
</span><span style="color:#d14"> .....: ;;;;
</span><span style="color:#d14"> .....: ;;;;
</span><span style="color:#d14"> .....: ;;;;
</span><span style="color:#d14"> .....: ;;;;
</span><span style="color:#d14"> .....: ;;;;
</span><span style="color:#d14"> .....: ;;;;
</span><span style="color:#d14"> .....: date;Param1;Param2;Param4;Param5
</span><span style="color:#d14"> .....:    ;m²;°C;m²;m
</span><span style="color:#d14"> .....: ;;;;
</span><span style="color:#d14"> .....: 01.01.1990 00:00;1;1;2;3
</span><span style="color:#d14"> .....: 01.01.1990 01:00;5;3;4;5
</span><span style="color:#d14"> .....: 01.01.1990 02:00;9;5;6;7
</span><span style="color:#d14"> .....: 01.01.1990 03:00;13;7;8;9
</span><span style="color:#d14"> .....: 01.01.1990 04:00;17;9;10;11
</span><span style="color:#d14"> .....: 01.01.1990 05:00;21;11;12;13
</span><span style="color:#d14"> .....: &#34;&#34;&#34;</span>
 <span style="color:#000;font-weight:bold">.....</span>: 
</code></pre></div><h5 ref="option-1-pass-rows-explicitly-to-skip-rowshttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmloption-1-pass-rows-explicitly-to-skip-rows-permalink-to-this-headline" >Option 1: pass rows explicitly to skip rows<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#option-1-pass-rows-explicitly-to-skip-rows" title="Permalink to this headline"></a></h5><a class="anchor" id="option-1-pass-rows-explicitly-to-skip-rowshttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmloption-1-pass-rows-explicitly-to-skip-rows-permalink-to-this-headline"></a>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">201</span>]: <span style="color:#000;font-weight:bold">from</span> <span style="color:#555">io</span> <span style="color:#000;font-weight:bold">import</span> StringIO

In [<span style="color:#099">202</span>]: pd<span style="color:#000;font-weight:bold">.</span>read_csv(StringIO(data), sep<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;;&#39;</span>, skiprows<span style="color:#000;font-weight:bold">=</span>[<span style="color:#099">11</span>, <span style="color:#099">12</span>],
 <span style="color:#000;font-weight:bold">.....</span>:            index_col<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0</span>, parse_dates<span style="color:#000;font-weight:bold">=</span><span style="color:#999">True</span>, header<span style="color:#000;font-weight:bold">=</span><span style="color:#099">10</span>)
 <span style="color:#000;font-weight:bold">.....</span>: 
Out[<span style="color:#099">202</span>]: 
 Param1  Param2  Param4  Param5
date 
<span style="color:#099">1990</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span> <span style="color:#099">00</span>:<span style="color:#099">00</span>:<span style="color:#099">00</span>       <span style="color:#099">1</span>       <span style="color:#099">1</span>       <span style="color:#099">2</span>       <span style="color:#099">3</span>
<span style="color:#099">1990</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span> <span style="color:#099">01</span>:<span style="color:#099">00</span>:<span style="color:#099">00</span>       <span style="color:#099">5</span>       <span style="color:#099">3</span>       <span style="color:#099">4</span>       <span style="color:#099">5</span>
<span style="color:#099">1990</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span> <span style="color:#099">02</span>:<span style="color:#099">00</span>:<span style="color:#099">00</span>       <span style="color:#099">9</span>       <span style="color:#099">5</span>       <span style="color:#099">6</span>       <span style="color:#099">7</span>
<span style="color:#099">1990</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span> <span style="color:#099">03</span>:<span style="color:#099">00</span>:<span style="color:#099">00</span>      <span style="color:#099">13</span>       <span style="color:#099">7</span>       <span style="color:#099">8</span>       <span style="color:#099">9</span>
<span style="color:#099">1990</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span> <span style="color:#099">04</span>:<span style="color:#099">00</span>:<span style="color:#099">00</span>      <span style="color:#099">17</span>       <span style="color:#099">9</span>      <span style="color:#099">10</span>      <span style="color:#099">11</span>
<span style="color:#099">1990</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span> <span style="color:#099">05</span>:<span style="color:#099">00</span>:<span style="color:#099">00</span>      <span style="color:#099">21</span>      <span style="color:#099">11</span>      <span style="color:#099">12</span>      <span style="color:#099">13</span>
</code></pre></div><h5 ref="option-2-read-column-names-and-then-datahttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmloption-2-read-column-names-and-then-data-permalink-to-this-headline" >Option 2: read column names and then data<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#option-2-read-column-names-and-then-data" title="Permalink to this headline"></a></h5><a class="anchor" id="option-2-read-column-names-and-then-datahttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmloption-2-read-column-names-and-then-data-permalink-to-this-headline"></a>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">203</span>]: pd<span style="color:#000;font-weight:bold">.</span>read_csv(StringIO(data), sep<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;;&#39;</span>, header<span style="color:#000;font-weight:bold">=</span><span style="color:#099">10</span>, nrows<span style="color:#000;font-weight:bold">=</span><span style="color:#099">10</span>)<span style="color:#000;font-weight:bold">.</span>columns
Out[<span style="color:#099">203</span>]: Index([<span style="color:#d14">&#39;date&#39;</span>, <span style="color:#d14">&#39;Param1&#39;</span>, <span style="color:#d14">&#39;Param2&#39;</span>, <span style="color:#d14">&#39;Param4&#39;</span>, <span style="color:#d14">&#39;Param5&#39;</span>], dtype<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;object&#39;</span>)

In [<span style="color:#099">204</span>]: columns <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>read_csv(StringIO(data), sep<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;;&#39;</span>, header<span style="color:#000;font-weight:bold">=</span><span style="color:#099">10</span>, nrows<span style="color:#000;font-weight:bold">=</span><span style="color:#099">10</span>)<span style="color:#000;font-weight:bold">.</span>columns

In [<span style="color:#099">205</span>]: pd<span style="color:#000;font-weight:bold">.</span>read_csv(StringIO(data), sep<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;;&#39;</span>, index_col<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0</span>,
 <span style="color:#000;font-weight:bold">.....</span>:            header<span style="color:#000;font-weight:bold">=</span><span style="color:#099">12</span>, parse_dates<span style="color:#000;font-weight:bold">=</span><span style="color:#999">True</span>, names<span style="color:#000;font-weight:bold">=</span>columns)
 <span style="color:#000;font-weight:bold">.....</span>: 
Out[<span style="color:#099">205</span>]: 
 Param1  Param2  Param4  Param5
date 
<span style="color:#099">1990</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span> <span style="color:#099">00</span>:<span style="color:#099">00</span>:<span style="color:#099">00</span>       <span style="color:#099">1</span>       <span style="color:#099">1</span>       <span style="color:#099">2</span>       <span style="color:#099">3</span>
<span style="color:#099">1990</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span> <span style="color:#099">01</span>:<span style="color:#099">00</span>:<span style="color:#099">00</span>       <span style="color:#099">5</span>       <span style="color:#099">3</span>       <span style="color:#099">4</span>       <span style="color:#099">5</span>
<span style="color:#099">1990</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span> <span style="color:#099">02</span>:<span style="color:#099">00</span>:<span style="color:#099">00</span>       <span style="color:#099">9</span>       <span style="color:#099">5</span>       <span style="color:#099">6</span>       <span style="color:#099">7</span>
<span style="color:#099">1990</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span> <span style="color:#099">03</span>:<span style="color:#099">00</span>:<span style="color:#099">00</span>      <span style="color:#099">13</span>       <span style="color:#099">7</span>       <span style="color:#099">8</span>       <span style="color:#099">9</span>
<span style="color:#099">1990</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span> <span style="color:#099">04</span>:<span style="color:#099">00</span>:<span style="color:#099">00</span>      <span style="color:#099">17</span>       <span style="color:#099">9</span>      <span style="color:#099">10</span>      <span style="color:#099">11</span>
<span style="color:#099">1990</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span> <span style="color:#099">05</span>:<span style="color:#099">00</span>:<span style="color:#099">00</span>      <span style="color:#099">21</span>      <span style="color:#099">11</span>      <span style="color:#099">12</span>      <span style="color:#099">13</span>
</code></pre></div><h3 ref="sqlhttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlsql-permalink-to-this-headline" >SQL<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#sql" title="Permalink to this headline"></a></h3><a class="anchor" id="sqlhttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlsql-permalink-to-this-headline"></a>
<p>The  <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/io.html#io-sql">SQL</a>  docs</p>
<p><a href="https://stackoverflow.com/questions/10065051/python-pandas-and-databases-like-mysql">Reading from databases with SQL</a></p>
<h3 ref="excelhttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlexcel-permalink-to-this-headline" >Excel<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#excel" title="Permalink to this headline"></a></h3><a class="anchor" id="excelhttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlexcel-permalink-to-this-headline"></a>
<p>The  <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/io.html#io-excel">Excel</a>  docs</p>
<p><a href="https://stackoverflow.com/questions/15588713/sheets-of-excel-workbook-from-a-url-into-a-pandas-dataframe">Reading from a filelike handle</a></p>
<p><a href="https://pbpython.com/improve-pandas-excel-output.html">Modifying formatting in XlsxWriter output</a></p>
<h3 ref="htmlhttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlhtml-permalink-to-this-headline" >HTML<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#html" title="Permalink to this headline"></a></h3><a class="anchor" id="htmlhttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlhtml-permalink-to-this-headline"></a>
<p><a href="https://stackoverflow.com/a/18939272/564538">Reading HTML tables from a server that cannot handle the default request header</a></p>
<h3 ref="hdfstorehttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlhdfstore-permalink-to-this-headline" >HDFStore<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#hdfstore" title="Permalink to this headline"></a></h3><a class="anchor" id="hdfstorehttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlhdfstore-permalink-to-this-headline"></a>
<p>The  <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/io.html#io-hdf5">HDFStores</a>  docs</p>
<p><a href="https://stackoverflow.com/questions/13926089/selecting-columns-from-pandas-hdfstore-table">Simple queries with a Timestamp Index</a></p>
<p><a href="https://github.com/pandas-dev/pandas/issues/3032">Managing heterogeneous data using a linked multiple table hierarchy</a></p>
<p><a href="https://stackoverflow.com/questions/14614512/merging-two-tables-with-millions-of-rows-in-python/14617925#14617925">Merging on-disk tables with millions of rows</a></p>
<p><a href="https://stackoverflow.com/a/29014295/2858145">Avoiding inconsistencies when writing to a store from multiple processes/threads</a></p>
<p>De-duplicating a large store by chunks, essentially a recursive reduction operation. Shows a function for taking in data from csv file and creating a store by chunks, with date parsing as well.  <a href="https://stackoverflow.com/questions/16110252/need-to-compare-very-large-files-around-1-5gb-in-python/16110391#16110391">See here</a></p>
<p><a href="https://stackoverflow.com/questions/20428355/appending-column-to-frame-of-hdf-file-in-pandas/20428786#20428786">Creating a store chunk-by-chunk from a csv file</a></p>
<p><a href="https://stackoverflow.com/questions/16997048/how-does-one-append-large-amounts-of-data-to-a-pandas-hdfstore-and-get-a-natural/16999397#16999397">Appending to a store, while creating a unique index</a></p>
<p><a href="https://stackoverflow.com/questions/14262433/large-data-work-flows-using-pandas">Large Data work flows</a></p>
<p><a href="https://stackoverflow.com/questions/16997048/how-does-one-append-large-amounts-of-data-to-a-pandas-hdfstore-and-get-a-natural">Reading in a sequence of files, then providing a global unique index to a store while appending</a></p>
<p><a href="https://stackoverflow.com/questions/15798209/pandas-group-by-query-on-large-data-in-hdfstore">Groupby on a HDFStore with low group density</a></p>
<p><a href="https://stackoverflow.com/questions/25459982/trouble-with-grouby-on-millions-of-keys-on-a-chunked-file-in-python-pandas/25471765#25471765">Groupby on a HDFStore with high group density</a></p>
<p><a href="https://stackoverflow.com/questions/22777284/improve-query-performance-from-a-large-hdfstore-table-with-pandas/22820780#22820780">Hierarchical queries on a HDFStore</a></p>
<p><a href="https://stackoverflow.com/questions/20497897/converting-dict-of-dicts-into-pandas-dataframe-memory-issues">Counting with a HDFStore</a></p>
<p><a href="https://stackoverflow.com/questions/15488809/how-to-trouble-shoot-hdfstore-exception-cannot-find-the-correct-atom-type">Troubleshoot HDFStore exceptions</a></p>
<p><a href="https://stackoverflow.com/questions/15988871/hdfstore-appendstring-dataframe-fails-when-string-column-contents-are-longer">Setting min_itemsize with strings</a></p>
<p><a href="https://stackoverflow.com/questions/17893370/ptrepack-sortby-needs-full-index">Using ptrepack to create a completely-sorted-index on a store</a></p>
<p>Storing Attributes to a group node</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">206</span>]: df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame(np<span style="color:#000;font-weight:bold">.</span>random<span style="color:#000;font-weight:bold">.</span>randn(<span style="color:#099">8</span>, <span style="color:#099">3</span>))

In [<span style="color:#099">207</span>]: store <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>HDFStore(<span style="color:#d14">&#39;test.h5&#39;</span>)

In [<span style="color:#099">208</span>]: store<span style="color:#000;font-weight:bold">.</span>put(<span style="color:#d14">&#39;df&#39;</span>, df)

<span style="color:#998;font-style:italic"># you can store an arbitrary Python object via pickle</span>
In [<span style="color:#099">209</span>]: store<span style="color:#000;font-weight:bold">.</span>get_storer(<span style="color:#d14">&#39;df&#39;</span>)<span style="color:#000;font-weight:bold">.</span>attrs<span style="color:#000;font-weight:bold">.</span>my_attribute <span style="color:#000;font-weight:bold">=</span> {<span style="color:#d14">&#39;A&#39;</span>: <span style="color:#099">10</span>}

In [<span style="color:#099">210</span>]: store<span style="color:#000;font-weight:bold">.</span>get_storer(<span style="color:#d14">&#39;df&#39;</span>)<span style="color:#000;font-weight:bold">.</span>attrs<span style="color:#000;font-weight:bold">.</span>my_attribute
Out[<span style="color:#099">210</span>]: {<span style="color:#d14">&#39;A&#39;</span>: <span style="color:#099">10</span>}
</code></pre></div><p>You can create or load a HDFStore in-memory by passing the  <code>driver</code>  parameter to PyTables. Changes are only written to disk when the HDFStore is closed.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">211</span>]: store <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>HDFStore(<span style="color:#d14">&#39;test.h5&#39;</span>, <span style="color:#d14">&#39;w&#39;</span>, diver<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;H5FD_CORE&#39;</span>)

In [<span style="color:#099">212</span>]: df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame(np<span style="color:#000;font-weight:bold">.</span>random<span style="color:#000;font-weight:bold">.</span>randn(<span style="color:#099">8</span>, <span style="color:#099">3</span>))

In [<span style="color:#099">213</span>]: store[<span style="color:#d14">&#39;test&#39;</span>] <span style="color:#000;font-weight:bold">=</span> df

<span style="color:#998;font-style:italic"># only after closing the store, data is written to disk:</span>
In [<span style="color:#099">214</span>]: store<span style="color:#000;font-weight:bold">.</span>close()
</code></pre></div><h3 ref="binary-fileshttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlbinary-files-permalink-to-this-headline" >Binary files<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#binary-files" title="Permalink to this headline"></a></h3><a class="anchor" id="binary-fileshttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlbinary-files-permalink-to-this-headline"></a>
<p>pandas readily accepts NumPy record arrays, if you need to read in a binary file consisting of an array of C structs. For example, given this C program in a file called  <code>main.c</code>  compiled with  <code>gcc  main.c  -std=gnu99</code>  on a 64-bit machine,</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py"><span style="color:#998;font-style:italic">#include &lt;stdio.h&gt;</span>
<span style="color:#998;font-style:italic">#include &lt;stdint.h&gt;</span>

typedef struct _Data
{
    int32_t count;
    double avg;
    <span style="color:#0086b3">float</span> scale;
} Data;

<span style="color:#0086b3">int</span> main(<span style="color:#0086b3">int</span> argc, const char <span style="color:#000;font-weight:bold">*</span>argv[])
{
    size_t n <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">10</span>;
    Data d[n];

    <span style="color:#000;font-weight:bold">for</span> (<span style="color:#0086b3">int</span> i <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0</span>; i <span style="color:#000;font-weight:bold">&lt;</span> n; <span style="color:#000;font-weight:bold">++</span>i)
    {
        d[i]<span style="color:#000;font-weight:bold">.</span>count <span style="color:#000;font-weight:bold">=</span> i;
        d[i]<span style="color:#000;font-weight:bold">.</span>avg <span style="color:#000;font-weight:bold">=</span> i <span style="color:#000;font-weight:bold">+</span> <span style="color:#099">1.0</span>;
        d[i]<span style="color:#000;font-weight:bold">.</span>scale <span style="color:#000;font-weight:bold">=</span> (<span style="color:#0086b3">float</span>) i <span style="color:#000;font-weight:bold">+</span> <span style="color:#099">2.0</span>f;
    }

    FILE <span style="color:#000;font-weight:bold">*</span><span style="color:#0086b3">file</span> <span style="color:#000;font-weight:bold">=</span> fopen(<span style="color:#d14">&#34;binary.dat&#34;</span>, <span style="color:#d14">&#34;wb&#34;</span>);
    fwrite(<span style="color:#000;font-weight:bold">&amp;</span>d, sizeof(Data), n, <span style="color:#0086b3">file</span>);
    fclose(<span style="color:#0086b3">file</span>);

    <span style="color:#000;font-weight:bold">return</span> <span style="color:#099">0</span>;
}
</code></pre></div><p>the following Python code will read the binary file  <code>'binary.dat'</code>  into a pandas  <code>DataFrame</code>, where each element of the struct corresponds to a column in the frame:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">names <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;count&#39;</span>, <span style="color:#d14">&#39;avg&#39;</span>, <span style="color:#d14">&#39;scale&#39;</span>

<span style="color:#998;font-style:italic"># note that the offsets are larger than the size of the type because of</span>
<span style="color:#998;font-style:italic"># struct padding</span>
offsets <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">0</span>, <span style="color:#099">8</span>, <span style="color:#099">16</span>
formats <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;i4&#39;</span>, <span style="color:#d14">&#39;f8&#39;</span>, <span style="color:#d14">&#39;f4&#39;</span>
dt <span style="color:#000;font-weight:bold">=</span> np<span style="color:#000;font-weight:bold">.</span>dtype({<span style="color:#d14">&#39;names&#39;</span>: names, <span style="color:#d14">&#39;offsets&#39;</span>: offsets, <span style="color:#d14">&#39;formats&#39;</span>: formats},
              align<span style="color:#000;font-weight:bold">=</span><span style="color:#999">True</span>)
df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame(np<span style="color:#000;font-weight:bold">.</span>fromfile(<span style="color:#d14">&#39;binary.dat&#39;</span>, dt))
</code></pre></div><p>Note</p>
<p>The offsets of the structure elements may be different depending on the architecture of the machine on which the file was created. Using a raw binary file format like this for general data storage is not recommended, as it is not cross platform. We recommended either HDF5 or parquet, both of which are supported by pandas’ IO facilities.</p>
<h2 ref="computationhttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlcomputation-permalink-to-this-headline" >Computation<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#computation" title="Permalink to this headline"></a></h2><a class="anchor" id="computationhttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlcomputation-permalink-to-this-headline"></a>
<p><a href="https://nbviewer.ipython.org/5720498">Numerical integration (sample-based) of a time series</a></p>
<h3 ref="correlationhttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlcorrelation-permalink-to-this-headline" >Correlation<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#correlation" title="Permalink to this headline"></a></h3><a class="anchor" id="correlationhttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlcorrelation-permalink-to-this-headline"></a>
<p>Often it’s useful to obtain the lower (or upper) triangular form of a correlation matrix calculated from  <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.corr.html#pandas.DataFrame.corr" title="pandas.DataFrame.corr"><code>DataFrame.corr()</code></a>. This can be achieved by passing a boolean mask to  <code>where</code>  as follows:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">215</span>]: df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame(np<span style="color:#000;font-weight:bold">.</span>random<span style="color:#000;font-weight:bold">.</span>random(size<span style="color:#000;font-weight:bold">=</span>(<span style="color:#099">100</span>, <span style="color:#099">5</span>)))

In [<span style="color:#099">216</span>]: corr_mat <span style="color:#000;font-weight:bold">=</span> df<span style="color:#000;font-weight:bold">.</span>corr()

In [<span style="color:#099">217</span>]: mask <span style="color:#000;font-weight:bold">=</span> np<span style="color:#000;font-weight:bold">.</span>tril(np<span style="color:#000;font-weight:bold">.</span>ones_like(corr_mat, dtype<span style="color:#000;font-weight:bold">=</span>np<span style="color:#000;font-weight:bold">.</span>bool), k<span style="color:#000;font-weight:bold">=-</span><span style="color:#099">1</span>)

In [<span style="color:#099">218</span>]: corr_mat<span style="color:#000;font-weight:bold">.</span>where(mask)
Out[<span style="color:#099">218</span>]: 
 <span style="color:#099">0</span>         <span style="color:#099">1</span>         <span style="color:#099">2</span>        <span style="color:#099">3</span>   <span style="color:#099">4</span>
<span style="color:#099">0</span>       NaN       NaN       NaN      NaN NaN
<span style="color:#099">1</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.079861</span>       NaN       NaN      NaN NaN
<span style="color:#099">2</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.236573</span>  <span style="color:#099">0.183801</span>       NaN      NaN NaN
<span style="color:#099">3</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.013795</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.051975</span>  <span style="color:#099">0.037235</span>      NaN NaN
<span style="color:#099">4</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.031974</span>  <span style="color:#099">0.118342</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.073499</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">0.02063</span> NaN
</code></pre></div><p>The  method  argument within  DataFrame.corr  can accept a callable in addition to the named correlation types. Here we compute the  <a href="https://en.wikipedia.org/wiki/Distance_correlation">distance correlation</a>  matrix for a  DataFrame  object.</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">219</span>]: <span style="color:#000;font-weight:bold">def</span> <span style="color:#900;font-weight:bold">distcorr</span>(x, y):
 <span style="color:#000;font-weight:bold">.....</span>:    n <span style="color:#000;font-weight:bold">=</span> <span style="color:#0086b3">len</span>(x)
 <span style="color:#000;font-weight:bold">.....</span>:    a <span style="color:#000;font-weight:bold">=</span> np<span style="color:#000;font-weight:bold">.</span>zeros(shape<span style="color:#000;font-weight:bold">=</span>(n, n))
 <span style="color:#000;font-weight:bold">.....</span>:    b <span style="color:#000;font-weight:bold">=</span> np<span style="color:#000;font-weight:bold">.</span>zeros(shape<span style="color:#000;font-weight:bold">=</span>(n, n))
 <span style="color:#000;font-weight:bold">.....</span>:    <span style="color:#000;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#0086b3">range</span>(n):
 <span style="color:#000;font-weight:bold">.....</span>:        <span style="color:#000;font-weight:bold">for</span> j <span style="color:#000;font-weight:bold">in</span> <span style="color:#0086b3">range</span>(i <span style="color:#000;font-weight:bold">+</span> <span style="color:#099">1</span>, n):
 <span style="color:#000;font-weight:bold">.....</span>:            a[i, j] <span style="color:#000;font-weight:bold">=</span> <span style="color:#0086b3">abs</span>(x[i] <span style="color:#000;font-weight:bold">-</span> x[j])
 <span style="color:#000;font-weight:bold">.....</span>:            b[i, j] <span style="color:#000;font-weight:bold">=</span> <span style="color:#0086b3">abs</span>(y[i] <span style="color:#000;font-weight:bold">-</span> y[j])
 <span style="color:#000;font-weight:bold">.....</span>:    a <span style="color:#000;font-weight:bold">+=</span> a<span style="color:#000;font-weight:bold">.</span>T
 <span style="color:#000;font-weight:bold">.....</span>:    b <span style="color:#000;font-weight:bold">+=</span> b<span style="color:#000;font-weight:bold">.</span>T
 <span style="color:#000;font-weight:bold">.....</span>:    a_bar <span style="color:#000;font-weight:bold">=</span> np<span style="color:#000;font-weight:bold">.</span>vstack([np<span style="color:#000;font-weight:bold">.</span>nanmean(a, axis<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0</span>)] <span style="color:#000;font-weight:bold">*</span> n)
 <span style="color:#000;font-weight:bold">.....</span>:    b_bar <span style="color:#000;font-weight:bold">=</span> np<span style="color:#000;font-weight:bold">.</span>vstack([np<span style="color:#000;font-weight:bold">.</span>nanmean(b, axis<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0</span>)] <span style="color:#000;font-weight:bold">*</span> n)
 <span style="color:#000;font-weight:bold">.....</span>:    A <span style="color:#000;font-weight:bold">=</span> a <span style="color:#000;font-weight:bold">-</span> a_bar <span style="color:#000;font-weight:bold">-</span> a_bar<span style="color:#000;font-weight:bold">.</span>T <span style="color:#000;font-weight:bold">+</span> np<span style="color:#000;font-weight:bold">.</span>full(shape<span style="color:#000;font-weight:bold">=</span>(n, n), fill_value<span style="color:#000;font-weight:bold">=</span>a_bar<span style="color:#000;font-weight:bold">.</span>mean())
 <span style="color:#000;font-weight:bold">.....</span>:    B <span style="color:#000;font-weight:bold">=</span> b <span style="color:#000;font-weight:bold">-</span> b_bar <span style="color:#000;font-weight:bold">-</span> b_bar<span style="color:#000;font-weight:bold">.</span>T <span style="color:#000;font-weight:bold">+</span> np<span style="color:#000;font-weight:bold">.</span>full(shape<span style="color:#000;font-weight:bold">=</span>(n, n), fill_value<span style="color:#000;font-weight:bold">=</span>b_bar<span style="color:#000;font-weight:bold">.</span>mean())
 <span style="color:#000;font-weight:bold">.....</span>:    cov_ab <span style="color:#000;font-weight:bold">=</span> np<span style="color:#000;font-weight:bold">.</span>sqrt(np<span style="color:#000;font-weight:bold">.</span>nansum(A <span style="color:#000;font-weight:bold">*</span> B)) <span style="color:#000;font-weight:bold">/</span> n
 <span style="color:#000;font-weight:bold">.....</span>:    std_a <span style="color:#000;font-weight:bold">=</span> np<span style="color:#000;font-weight:bold">.</span>sqrt(np<span style="color:#000;font-weight:bold">.</span>sqrt(np<span style="color:#000;font-weight:bold">.</span>nansum(A<span style="color:#000;font-weight:bold">**</span><span style="color:#099">2</span>)) <span style="color:#000;font-weight:bold">/</span> n)
 <span style="color:#000;font-weight:bold">.....</span>:    std_b <span style="color:#000;font-weight:bold">=</span> np<span style="color:#000;font-weight:bold">.</span>sqrt(np<span style="color:#000;font-weight:bold">.</span>sqrt(np<span style="color:#000;font-weight:bold">.</span>nansum(B<span style="color:#000;font-weight:bold">**</span><span style="color:#099">2</span>)) <span style="color:#000;font-weight:bold">/</span> n)
 <span style="color:#000;font-weight:bold">.....</span>:    <span style="color:#000;font-weight:bold">return</span> cov_ab <span style="color:#000;font-weight:bold">/</span> std_a <span style="color:#000;font-weight:bold">/</span> std_b
 <span style="color:#000;font-weight:bold">.....</span>: 

In [<span style="color:#099">220</span>]: df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame(np<span style="color:#000;font-weight:bold">.</span>random<span style="color:#000;font-weight:bold">.</span>normal(size<span style="color:#000;font-weight:bold">=</span>(<span style="color:#099">100</span>, <span style="color:#099">3</span>)))

In [<span style="color:#099">221</span>]: df<span style="color:#000;font-weight:bold">.</span>corr(method<span style="color:#000;font-weight:bold">=</span>distcorr)
Out[<span style="color:#099">221</span>]: 
 <span style="color:#099">0</span>         <span style="color:#099">1</span>         <span style="color:#099">2</span>
<span style="color:#099">0</span>  <span style="color:#099">1.000000</span>  <span style="color:#099">0.197613</span>  <span style="color:#099">0.216328</span>
<span style="color:#099">1</span>  <span style="color:#099">0.197613</span>  <span style="color:#099">1.000000</span>  <span style="color:#099">0.208749</span>
<span style="color:#099">2</span>  <span style="color:#099">0.216328</span>  <span style="color:#099">0.208749</span>  <span style="color:#099">1.000000</span>
</code></pre></div><h2 ref="timedeltashttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmltimedeltas-permalink-to-this-headline" >Timedeltas<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#timedeltas" title="Permalink to this headline"></a></h2><a class="anchor" id="timedeltashttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmltimedeltas-permalink-to-this-headline"></a>
<p>The  <a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/timedeltas.html#timedeltas-timedeltas">Timedeltas</a>  docs.</p>
<p><a href="https://github.com/pandas-dev/pandas/pull/2899">Using timedeltas</a></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">222</span>]: <span style="color:#000;font-weight:bold">import</span> <span style="color:#555">datetime</span>

In [<span style="color:#099">223</span>]: s <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>Series(pd<span style="color:#000;font-weight:bold">.</span>date_range(<span style="color:#d14">&#39;2012-1-1&#39;</span>, periods<span style="color:#000;font-weight:bold">=</span><span style="color:#099">3</span>, freq<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#39;D&#39;</span>))

In [<span style="color:#099">224</span>]: s <span style="color:#000;font-weight:bold">-</span> s<span style="color:#000;font-weight:bold">.</span>max()
Out[<span style="color:#099">224</span>]: 
<span style="color:#099">0</span>   <span style="color:#000;font-weight:bold">-</span><span style="color:#099">2</span> days
<span style="color:#099">1</span>   <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span> days
<span style="color:#099">2</span>    <span style="color:#099">0</span> days
dtype: timedelta64[ns]

In [<span style="color:#099">225</span>]: s<span style="color:#000;font-weight:bold">.</span>max() <span style="color:#000;font-weight:bold">-</span> s
Out[<span style="color:#099">225</span>]: 
<span style="color:#099">0</span>   <span style="color:#099">2</span> days
<span style="color:#099">1</span>   <span style="color:#099">1</span> days
<span style="color:#099">2</span>   <span style="color:#099">0</span> days
dtype: timedelta64[ns]

In [<span style="color:#099">226</span>]: s <span style="color:#000;font-weight:bold">-</span> datetime<span style="color:#000;font-weight:bold">.</span>datetime(<span style="color:#099">2011</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">3</span>, <span style="color:#099">5</span>)
Out[<span style="color:#099">226</span>]: 
<span style="color:#099">0</span>   <span style="color:#099">364</span> days <span style="color:#099">20</span>:<span style="color:#099">55</span>:<span style="color:#099">00</span>
<span style="color:#099">1</span>   <span style="color:#099">365</span> days <span style="color:#099">20</span>:<span style="color:#099">55</span>:<span style="color:#099">00</span>
<span style="color:#099">2</span>   <span style="color:#099">366</span> days <span style="color:#099">20</span>:<span style="color:#099">55</span>:<span style="color:#099">00</span>
dtype: timedelta64[ns]

In [<span style="color:#099">227</span>]: s <span style="color:#000;font-weight:bold">+</span> datetime<span style="color:#000;font-weight:bold">.</span>timedelta(minutes<span style="color:#000;font-weight:bold">=</span><span style="color:#099">5</span>)
Out[<span style="color:#099">227</span>]: 
<span style="color:#099">0</span>   <span style="color:#099">2012</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span> <span style="color:#099">00</span>:<span style="color:#099">05</span>:<span style="color:#099">00</span>
<span style="color:#099">1</span>   <span style="color:#099">2012</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">02</span> <span style="color:#099">00</span>:<span style="color:#099">05</span>:<span style="color:#099">00</span>
<span style="color:#099">2</span>   <span style="color:#099">2012</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">03</span> <span style="color:#099">00</span>:<span style="color:#099">05</span>:<span style="color:#099">00</span>
dtype: datetime64[ns]

In [<span style="color:#099">228</span>]: datetime<span style="color:#000;font-weight:bold">.</span>datetime(<span style="color:#099">2011</span>, <span style="color:#099">1</span>, <span style="color:#099">1</span>, <span style="color:#099">3</span>, <span style="color:#099">5</span>) <span style="color:#000;font-weight:bold">-</span> s
Out[<span style="color:#099">228</span>]: 
<span style="color:#099">0</span>   <span style="color:#000;font-weight:bold">-</span><span style="color:#099">365</span> days <span style="color:#000;font-weight:bold">+</span><span style="color:#099">03</span>:<span style="color:#099">05</span>:<span style="color:#099">00</span>
<span style="color:#099">1</span>   <span style="color:#000;font-weight:bold">-</span><span style="color:#099">366</span> days <span style="color:#000;font-weight:bold">+</span><span style="color:#099">03</span>:<span style="color:#099">05</span>:<span style="color:#099">00</span>
<span style="color:#099">2</span>   <span style="color:#000;font-weight:bold">-</span><span style="color:#099">367</span> days <span style="color:#000;font-weight:bold">+</span><span style="color:#099">03</span>:<span style="color:#099">05</span>:<span style="color:#099">00</span>
dtype: timedelta64[ns]

In [<span style="color:#099">229</span>]: datetime<span style="color:#000;font-weight:bold">.</span>timedelta(minutes<span style="color:#000;font-weight:bold">=</span><span style="color:#099">5</span>) <span style="color:#000;font-weight:bold">+</span> s
Out[<span style="color:#099">229</span>]: 
<span style="color:#099">0</span>   <span style="color:#099">2012</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span> <span style="color:#099">00</span>:<span style="color:#099">05</span>:<span style="color:#099">00</span>
<span style="color:#099">1</span>   <span style="color:#099">2012</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">02</span> <span style="color:#099">00</span>:<span style="color:#099">05</span>:<span style="color:#099">00</span>
<span style="color:#099">2</span>   <span style="color:#099">2012</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">03</span> <span style="color:#099">00</span>:<span style="color:#099">05</span>:<span style="color:#099">00</span>
dtype: datetime64[ns]
</code></pre></div><p><a href="https://stackoverflow.com/questions/16385785/add-days-to-dates-in-dataframe">Adding and subtracting deltas and dates</a></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">230</span>]: deltas <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>Series([datetime<span style="color:#000;font-weight:bold">.</span>timedelta(days<span style="color:#000;font-weight:bold">=</span>i) <span style="color:#000;font-weight:bold">for</span> i <span style="color:#000;font-weight:bold">in</span> <span style="color:#0086b3">range</span>(<span style="color:#099">3</span>)])

In [<span style="color:#099">231</span>]: df <span style="color:#000;font-weight:bold">=</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame({<span style="color:#d14">&#39;A&#39;</span>: s, <span style="color:#d14">&#39;B&#39;</span>: deltas})

In [<span style="color:#099">232</span>]: df
Out[<span style="color:#099">232</span>]: 
 A      B
<span style="color:#099">0</span> <span style="color:#099">2012</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span> <span style="color:#099">0</span> days
<span style="color:#099">1</span> <span style="color:#099">2012</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">02</span> <span style="color:#099">1</span> days
<span style="color:#099">2</span> <span style="color:#099">2012</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">03</span> <span style="color:#099">2</span> days

In [<span style="color:#099">233</span>]: df[<span style="color:#d14">&#39;New Dates&#39;</span>] <span style="color:#000;font-weight:bold">=</span> df[<span style="color:#d14">&#39;A&#39;</span>] <span style="color:#000;font-weight:bold">+</span> df[<span style="color:#d14">&#39;B&#39;</span>]

In [<span style="color:#099">234</span>]: df[<span style="color:#d14">&#39;Delta&#39;</span>] <span style="color:#000;font-weight:bold">=</span> df[<span style="color:#d14">&#39;A&#39;</span>] <span style="color:#000;font-weight:bold">-</span> df[<span style="color:#d14">&#39;New Dates&#39;</span>]

In [<span style="color:#099">235</span>]: df
Out[<span style="color:#099">235</span>]: 
 A      B  New Dates   Delta
<span style="color:#099">0</span> <span style="color:#099">2012</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span> <span style="color:#099">0</span> days <span style="color:#099">2012</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span>  <span style="color:#099">0</span> days
<span style="color:#099">1</span> <span style="color:#099">2012</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">02</span> <span style="color:#099">1</span> days <span style="color:#099">2012</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">03</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">1</span> days
<span style="color:#099">2</span> <span style="color:#099">2012</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">03</span> <span style="color:#099">2</span> days <span style="color:#099">2012</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">01</span><span style="color:#000;font-weight:bold">-</span><span style="color:#099">05</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">2</span> days

In [<span style="color:#099">236</span>]: df<span style="color:#000;font-weight:bold">.</span>dtypes
Out[<span style="color:#099">236</span>]: 
A             datetime64[ns]
B            timedelta64[ns]
New Dates     datetime64[ns]
Delta        timedelta64[ns]
dtype: <span style="color:#0086b3">object</span>
</code></pre></div><p><a href="https://stackoverflow.com/questions/15683588/iterating-through-a-pandas-dataframe">Another example</a></p>
<p>Values can be set to NaT using np.nan, similar to datetime</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">237</span>]: y <span style="color:#000;font-weight:bold">=</span> s <span style="color:#000;font-weight:bold">-</span> s<span style="color:#000;font-weight:bold">.</span>shift()

In [<span style="color:#099">238</span>]: y
Out[<span style="color:#099">238</span>]: 
<span style="color:#099">0</span>      NaT
<span style="color:#099">1</span>   <span style="color:#099">1</span> days
<span style="color:#099">2</span>   <span style="color:#099">1</span> days
dtype: timedelta64[ns]

In [<span style="color:#099">239</span>]: y[<span style="color:#099">1</span>] <span style="color:#000;font-weight:bold">=</span> np<span style="color:#000;font-weight:bold">.</span>nan

In [<span style="color:#099">240</span>]: y
Out[<span style="color:#099">240</span>]: 
<span style="color:#099">0</span>      NaT
<span style="color:#099">1</span>      NaT
<span style="color:#099">2</span>   <span style="color:#099">1</span> days
dtype: timedelta64[ns]
</code></pre></div><h2 ref="creating-example-datahttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlcreating-example-data-permalink-to-this-headline" >Creating example data<a href="https://pandas.pydata.org/pandas-docs/stable/user_guide/cookbook.html#creating-example-data" title="Permalink to this headline"></a></h2><a class="anchor" id="creating-example-datahttpspandaspydataorgpandas-docsstableuser_guidecookbookhtmlcreating-example-data-permalink-to-this-headline"></a>
<p>To create a dataframe from every combination of some given values, like R’s  <code>expand.grid()</code>  function, we can create a dict where the keys are column names and the values are lists of the data values:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:2;-o-tab-size:2;tab-size:2"><code class="language-py" data-lang="py">In [<span style="color:#099">241</span>]: <span style="color:#000;font-weight:bold">def</span> <span style="color:#900;font-weight:bold">expand_grid</span>(data_dict):
 <span style="color:#000;font-weight:bold">.....</span>:    rows <span style="color:#000;font-weight:bold">=</span> itertools<span style="color:#000;font-weight:bold">.</span>product(<span style="color:#000;font-weight:bold">*</span>data_dict<span style="color:#000;font-weight:bold">.</span>values())
 <span style="color:#000;font-weight:bold">.....</span>:    <span style="color:#000;font-weight:bold">return</span> pd<span style="color:#000;font-weight:bold">.</span>DataFrame<span style="color:#000;font-weight:bold">.</span>from_records(rows, columns<span style="color:#000;font-weight:bold">=</span>data_dict<span style="color:#000;font-weight:bold">.</span>keys())
 <span style="color:#000;font-weight:bold">.....</span>: 

In [<span style="color:#099">242</span>]: df <span style="color:#000;font-weight:bold">=</span> expand_grid({<span style="color:#d14">&#39;height&#39;</span>: [<span style="color:#099">60</span>, <span style="color:#099">70</span>],
 <span style="color:#000;font-weight:bold">.....</span>:                  <span style="color:#d14">&#39;weight&#39;</span>: [<span style="color:#099">100</span>, <span style="color:#099">140</span>, <span style="color:#099">180</span>],
 <span style="color:#000;font-weight:bold">.....</span>:                  <span style="color:#d14">&#39;sex&#39;</span>: [<span style="color:#d14">&#39;Male&#39;</span>, <span style="color:#d14">&#39;Female&#39;</span>]})
 <span style="color:#000;font-weight:bold">.....</span>: 

In [<span style="color:#099">243</span>]: df
Out[<span style="color:#099">243</span>]: 
 height  weight     sex
<span style="color:#099">0</span>       <span style="color:#099">60</span>     <span style="color:#099">100</span>    Male
<span style="color:#099">1</span>       <span style="color:#099">60</span>     <span style="color:#099">100</span>  Female
<span style="color:#099">2</span>       <span style="color:#099">60</span>     <span style="color:#099">140</span>    Male
<span style="color:#099">3</span>       <span style="color:#099">60</span>     <span style="color:#099">140</span>  Female
<span style="color:#099">4</span>       <span style="color:#099">60</span>     <span style="color:#099">180</span>    Male
<span style="color:#099">5</span>       <span style="color:#099">60</span>     <span style="color:#099">180</span>  Female
<span style="color:#099">6</span>       <span style="color:#099">70</span>     <span style="color:#099">100</span>    Male
<span style="color:#099">7</span>       <span style="color:#099">70</span>     <span style="color:#099">100</span>  Female
<span style="color:#099">8</span>       <span style="color:#099">70</span>     <span style="color:#099">140</span>    Male
<span style="color:#099">9</span>       <span style="color:#099">70</span>     <span style="color:#099">140</span>  Female
<span style="color:#099">10</span>      <span style="color:#099">70</span>     <span style="color:#099">180</span>    Male
<span style="color:#099">11</span>      <span style="color:#099">70</span>     <span style="color:#099">180</span>  Female
</code></pre></div>
		
</div>






	 
	<div class="chevrons">
		<a class="next" href="/KM/tutorials/pandas/short_introduction/" title="Short Introduction" style="margin-right: 0px;">
            <div>
                <p>Next page</p>
                <label>Short Introduction</label>
            </div>
            <i class="fas fa-arrow-right" style="font-size: 1.7em"></i></a>
	</div>
	
	 
	

      </section>

      
      
      <section class="right-menu ">
      
	

		
	
			
		
	    	
	  	
	<div class="TableOfContents">
    <label><i class="fas fa-align-right"></i>&nbsp;&nbsp;What&#39;s on this page</label>
    <nav>
        <ul >
            <li><a href="/KM/tutorials/pandas/">Pandas</a></li>
        </ul>
    </nav>
    <nav id="TableOfContents"></nav>
</div>

		
	
			
		
	    	
	  	
	<div class="Actions">
	<nav>
		<ul>
				
		    
		    
		    
		    <li>
		    	
		        <a href="https://knowledge-dragons.github.io/KM/tutorials/admin/#/collections/pages/entries/pandas/_index" target="blank">
		        <i class="fab fa-github"></i>
		        Improve this page</a>
		    </li>
		    
		    
			
		    

    	</ul>
	</nav>
    
</div>

      </section>
      
    </article>
    
    
    <footer>
      

		
	
			
		
	    	<style type="text/css">

.footer-gray {
  width: 100%;
  color: #888;
}

.footer-custom {
  font: normal normal 12px/1.4 sans-serif;
  /*max-width: 1008px;*/
  box-sizing: border-box;
  margin: 0 auto;
  padding: 24px;
}

.footer-custom:after {
  display: table;
  clear: both;
  content: "";
}

.footer-lists:after {
  display: table;
  clear: both;
  content: "";
}

.ftr-hdr {
  color: white;
  font: 22px/1.4  sans-serif;
  margin: 1em 0 0;
}

@media only screen and (min-width: 768px) {
  .ftr-hdr {
    font-size: 18px;
  }
}

.footer-list-wrap {
  width: 50%;
  float: left;
  box-sizing: border-box;
}

@media only screen and (min-width: 568px) {
  .footer-list-wrap {
    width: 33.3333%;
  }
}

@media only screen and (min-width: 768px) {
  .footer-list-wrap {
    width: 25%;
  }
}

.ftr-links-sub {
  padding: 0;
  margin: 0;
}

.ftr-links-sub:after {
  display: table;
  clear: both;
  content: "";
}

.ftr-links-sub li {
  display: block;
  list-style-type: none;
  margin: 0;
  padding: 3px 0;
  color: #888;
  font: normal normal 12px sans-serif;
  text-transform: uppercase;
  /*width: 150px;*/
}

.footer-custom a,
.footer-custom a:link,
.footer-custom a:visited,
.ftr-links-sub li .link {
  text-decoration: none;
  color: #888;
  padding: 5px 0;
  display: block;
}

.footer-custom .footer-legal a {
  display: inline;
}

.footer-custom a:hover,
.footer-custom a:active,
.ftr-links-sub li .link:hover {
  text-decoration: underline;
  color: #888;
  cursor: pointer;
}

@media only screen and (min-width: 768px) {
  .footer-custom a, .footer-custom a:link, .footer-custom a:visited, .ftr-links-sub li .link {
    padding: 0;
  }
}
/* BEGIN EMAIL CAPTURE STYLES*/

.footer-email {
  text-align: center;
}

#ftrEmailForm {
  height: 44px;
}

#ftrEmailForm .error {
  display: none;
  color: red;
  text-align: left;
}

#ftrEmailForm #ftrEmailInput {
  background: none repeat scroll 0 0 #FFF;
  border: 1px solid #D6D6D6;
  box-sizing: border-box;
  color: #888;
  float: left;
  font: normal normal 14px/1.4 sans-serif;
  padding: 5px;
  width: 70%;
  height: 100%;
}

#ftrEmailForm #ftrEmailInput:hover {
  border: 1px solid #888;
}

#ftrEmailForm #ftrEmailInput:focus {
  border: 1px solid #ef9223;
  outline: #ef9223 auto 5px;
}

#ftrEmailForm .button {
  width: 30%;
  height: 100%;
  padding: 5px;
  float: left;
  border: 1px solid #DFDFDF;
  box-sizing: border-box;
  color: #000;
  font: normal bold 18px/1 sans-serif;
  text-align: center;
  text-transform: uppercase;
  background: #FFF;
  background: url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/Pgo8c3ZnIHhtbG5zPSJod…EiIGhlaWdodD0iMSIgZmlsbD0idXJsKCNncmFkLXVjZ2ctZ2VuZXJhdGVkKSIgLz4KPC9zdmc+);
  background: -webkit-gradient(linear, left top, left bottom, color-stop(0%, white), color-stop(100%, #e1e1e1));
  background: -webkit-linear-gradient(top, white 0, #e1e1e1 100%);
  background: -moz-linear-gradient(top, white 0, #e1e1e1 100%);
  background: -ms-linear-gradient(top, white 0, #e1e1e1 100%);
  background: -o-linear-gradient(top, white 0, #e1e1e1 100%);
  background: linear-gradient(to bottom, white 0, #e1e1e1 100%);
  cursor: pointer;
  vertical-align: middle;
  outline: none;
}

#ftrEmailForm .button:hover,
#ftrEmailForm .button:active {
  background: black;
  color: #FFF;
  outline: none;
}
/* BEGIN SOCIAL STYLES*/

.footer-social {
  text-align: center;
}

.footer-social ul {
  padding: 0;
  display: inline-block;
  list-style-type: none;
}

.footer-social ul:after {
  display: table;
  clear: both;
  content: "";
}

.footer-social li {
  float: left;
  margin: 0 15px 0 0;
  padding: 0;
}

@media only screen and (min-width: 768px) {
  .footer-lists {
    width: 100%;
  }
  .footer-email {
    width: 50%;
    float: left;
    text-align: left;
  }
  .footer-social {
    width: 45%;
    margin-left: 5%;
    float: left;
    text-align: left;
  }
}

@media only screen and (min-width: 1008px) {
  .footer-lists {
    width: 66.6666%;
    float: left;
  }
  .footer-email {
    width: 33.3333%;
  }
  .footer-social {
    width: 33.3333%;
    float: right;
    margin-left: 0;
  }
}

.footer-legal {
  padding: 15px 0 0;
  clear: left;
}

.footer-payment {
  text-align: center;
}

@media only screen and (min-width: 768px) {
  .footer-legal {
    width: 66.6666%;
    float: left;
  }
  .footer-payment {
    width: 33.3333%;
    float: left;
  }
}

@media only screen and (min-width: 1008px) {
  .footer-payment {
    text-align: left;
  }
}

.footer-payment ul {
  padding: 0;
  display: inline-block;
  list-style-type: none;
}

.footer-payment ul li {
  display: inline-block;
  margin: 0 6px;
}

@media only screen and (min-width: 1008px) {
  .footer-payment ul li.ftr-stella {
    margin-left: 0;
  }
}


</style>
  <div class="footer-gray">
    <div class="footer-custom">
      <div class="footer-lists">
        <div class="footer-list-wrap">
          <h6 class="ftr-hdr">Order Something</h6>
          <ul class="ftr-links-sub">
            <li>800-123-4567</li>
          </ul>
          <h6 class="ftr-hdr">International</h6>
          <ul class="ftr-links-sub">
            <li><a href="#" rel="nofollow">France</a></li>
            <li><a href="#" rel="nofollow">Cape Verde</a></li>
          </ul>
        </div>
        <div class="footer-list-wrap">
          <h6 class="ftr-hdr">Customer Service</h6>
          <ul class="ftr-links-sub">
            <li><a href="#" rel="nofollow">Contact Us</a></li>
            <li><a href="#" rel="nofollow">Ordering</a></li>
            <li><a href="#" rel="nofollow">Shipping &amp; Delivery</a></li>
            <li><a href="#" rel="nofollow">Returns</a></li>
            <li><a href="#" rel="nofollow">Gift Cards</a></li>
            <li><a href="#" rel="nofollow">FAQs</a></li>
          </ul>
        </div>
        <div class="footer-list-wrap">
          <h6 class="ftr-hdr">About DocPort</h6>
          <ul class="ftr-links-sub">
            <li><a href="#" rel="nofollow">Our Company</a></li>
            <li><a href="#" rel="nofollow">Careers</a></li>
            <li><a href="#" rel="nofollow">Affiliate Program</a></li>
            <li><a href="#" rel="nofollow"><strong>Shop Our Catalog</strong></a></li>
            <li><a href="#" rel="nofollow">DocPort BLOG</a></li>
          </ul>
        </div>
        <div class="footer-list-wrap">
          <h6 class="ftr-hdr">My Account</h6>
          <ul class="ftr-links-sub">
            <art:content rule="!loggedin">
              <li class="ftr-Login"><span class="link login-trigger">Access My Account</span></li>
              <li><span class="link">Track My Order</span></li>
            </art:content>
            <art:content rule="loggedin">
              <li class="ftr-Login"><span class="link ftr-access-my-account">Access My Account</span></li>
              <li><span class="link">Track My Order</span></li>
            </art:content>
          </ul>
        </div>
      </div>
      <div class="footer-email">
        <h6 class="ftr-hdr">Sign up for exclusive offers and inspiration</h6>
        <div id="ftr-email" class="ftr-email-form">
          <form id="ftrEmailForm" method="post" action="#">
            <div class="error">Please enter a valid email address</div>
            <input type="text" name="email_address_" id="ftrEmailInput" class="input" placeholder="Enter email address"/>
          </form>
        </div>
        <div class="ftr-email-privacy-policy"></div>
      </div>
      <div class="footer-social">
        <h6 class="ftr-hdr">Follow Us</h6>
        <ul>
          <li>
            <a href="#" title="Facebook">
              <img width="24" height="24" alt="Like us on Facebook" src="/images/fb.png">
            </a>
          </li>
          <li>
            <a href="#" title="Google+">
              <img width="24" height="24" alt="Follow us on Google+" src="/images/gplus.png">
            </a>
          </li>
          <li>
            <a href="#" target="_blank">
              <img width="24" height="24" alt="Follow us on Pinterest" src="/images/pin-badge.png">
            </a>
          </li>
          <li>
            <a target="_blank" href="#">
              <img width="24" height="24" alt="Follow us on Instagram" src="/images/instagram-badge.png">
            </a>
          </li>
          <li>
            <a href="#" title="Twitter">
              <img width="67" alt="Follow us on Twitter" src="/images/twitter.png">
            </a>
          </li>
        </ul>
      </div>
      <div class="footer-legal">
        <p>&copy; Docport MIT Licence. | <a href="#" rel="nofollow">Privacy Policy</a> | <a href="#" rel="nofollow">Terms of Use</a> | <a href="#" rel="nofollow">Terms of Sale</a></p>
        <p>Docport is free Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
        tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim.</p>
        <p>Various aspects of this website are ...blablabla</p>
      </div>
    </div>
  </div>
  <!--/.footer-gray-->
	    
	
    </footer>
    



  </body>
</html>
